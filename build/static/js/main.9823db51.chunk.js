(this.webpackJsonpDialCrowd=this.webpackJsonpDialCrowd||[]).push([[0],{1221:function(e,t,s){"use strict";s.r(t);var n=s(0),i=s.n(n),a=s(29),r=s.n(a),o=s(15);const c=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function l(e){navigator.serviceWorker.register(e).then((e=>{e.onupdatefound=()=>{const t=e.installing;t.onstatechange=()=>{"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((e=>{console.error("Error during service worker registration:",e)}))}s(606),s.p;var d=s(1262),h=s(1265),u=s(1266),p=s(140),j=s(590);var b=Object(p.c)({messages:function(e,t){switch(t.type){case"MESSAGE_ADD":return e.concat([{text:t.text,time:t.time,received:t.received,image:t.image,candidate:t.candidate}]);case"MESSAGE_NEW":return[];default:return e||[]}},session:function(e,t){return"SESSION_UPDATE"===t.type?t.session:e||"text"},category:function(e,t){return"UPDATE_CATEGORY"===t.type?t.category:e||[]},interactive:function(e,t){return"UPDATE_INTERACTIVE"===t.type?t.interactive:e||[]},sequence:function(e,t){return"UPDATE_SEQUENCE"===t.type?t.sequence:e||[]},quality:function(e,t){return"UPDATE_QUALITY"===t.type?t.quality:e||[]},system:function(e,t){return"UPDATE_SYSTEM"===t.type?t.system:e||[]},session_category:function(e,t){return"SESSION_CATEGORY_UPDATE"===t.type?t.category:e||[]},session_interactive:function(e,t){return"SESSION_INTERACTIVE_UPDATE"===t.type?t.interactive:e||"text"},session_sequence:function(e,t){return"SESSION_SEQUENCE_UPDATE"===t.type?t.sequence:e||[]},session_quality:function(e,t){return"SESSION_QUALITY_UPDATE"===t.type?t.quality:e||"text"},result:function(e,t){return"UPDATE_RESULT"===t.type?{dialog:t.dialog,survey:t.survey}:e||[]},all:function(e,t){return"ALL"===t.type?t.all:e||[]},listening:function(e,t){switch(t.type){case"MICROPHONE_START":return!0;case"MICROPHONE_STOP":return!1;default:return e||!1}},mode:function(e,t){return"MODE_CHANGE"===t.type?t.mode:e||"both"},help:function(e,t){return"HELP_UPDATE"===t.type?t.text:e||"Help"},crowd:function(e,t){return"SET_CROWD"===t.type?t:e||[]}}),m=s(31),x=s(104),y=s.n(x);function g(e,t,s,n,i,a,r,o){return{type:"MESSAGE_SEND",task_id:t,text:e,time:s,role:n,worker_id:i,terminal:a,sessionId:r,slots:o}}function f(e,t,s,n){return{type:"MESSAGE_ADD",text:e,time:t,received:s,image:n}}function O(e){return new Promise(((t,s)=>{e.onerror=e=>{s(e)},e.onresult=e=>{t(e)},e.onnomatch=e=>{t(e)},e.start()}))}function*v(e){for(;;){yield Object(m.f)("MICROPHONE_START"),e.cancel();const n=new window.webkitSpeechRecognition;n.lang="en-US",n.interim=!0;try{const{event:e}=yield Object(m.e)({event:Object(m.b)(O,n),cancel:Object(m.f)("MICROPHONE_CANCEL")});if(e){var t=e.results[0][0].transcript;"start"===t&&(t="START"),yield Object(m.d)(g(t,Date.now()))}else n.stop()}catch(s){console.log(s)}yield Object(m.d)({type:"MICROPHONE_STOP"})}}var w=s(88),k=s.n(w);const I=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).serverUrl,S=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).clientUrl;function*C(e,t,s){try{yield Object(m.d)(f("Connecting to the dialogue system. Please wait for the system response.",Date.now(),!0));const e=yield Object(m.b)(k.a.post,I+"/api/router/chat/join",{sid:t});"status"==e.data.action&&(e.data.msg.includes("START")||(yield Object(m.d)(f(e.data.msg,Date.now(),!0))),console.log("SENT STATUS"))}catch(n){console.log(n)}yield Object(m.g)("MESSAGE_SEND",T,s,e),yield Object(m.g)("FEEDBACK_SEND",q,e)}function*_(e,t,s){const n=s.msg;console.log(s),console.log(""===s.display);let i=""===s.display?s.msg:s.display;console.log(i),void 0===i&&(i="Please type or say START to begin."),yield Object(m.d)(f(i,Date.now(),!0));new SpeechSynthesisUtterance(n.replace("<p>","..."));yield Object(m.c)(D,t,n,"Bot"),t.mode,"continuous"===t.mode&&(yield Object(m.d)({type:"MICROPHONE_START"}))}function*T(e,t,s){console.log("data: ",t),console.log("action: ",s),yield Object(m.d)(f(s.text,s.time,!1));try{const n=yield Object(m.b)(k.a.post,I+"/api/router/chat/usr_input",{msg:s.text,sid:t.sid,userId:t.userId,taskID:t.taskID});console.log("sendMessageSaga response",n),yield Object(m.b)(_,e,t,n.data)}catch(n){console.log(n)}yield Object(m.c)(D,t,s.text,"You")}function*D(e,t,s){try{const n=yield Object(m.b)(k.a.post,I+"/api/dialog_save",{subId:e.subId,userID:e.userId,name_of_dialog:e.nameOfDialog,role:s,utter:t,taskID:e.taskID});console.log("logMessage",n),console.log("logMessage data",e)}catch(n){console.log(n)}}function*q(e,t){try{yield Object(m.b)(k.a.post,I+"/api/feedback",{subId:e.subId,userID:e.userId,name_of_dialog:e.nameOfDialog,utter:t.text,feedback:t.feedback})}catch(s){}}function*A(){yield M(),yield R("interactive"),yield R("category"),yield R("sequence"),yield R("quality"),yield Object(m.g)("NEW_SESSION",F),yield Object(m.g)("NEW_SYSTEM",M),yield Object(m.g)("DELETE_PROJECT",N),yield Object(m.g)("GET_RESULT",H),yield Object(m.g)("DELETE_RESULT",B),yield Object(m.g)("NEW_PROJECT_DATA",R),yield Object(m.g)("COM_ALL",E),yield Object(m.g)("SET_INTERACTIVE",P);const e=y.a.parse(window.location.search);if(e.option){const t="continuous"===e.option?"speech":e.option;yield Object(m.d)({type:"MODE_CHANGE",mode:t})}e.help&&(yield Object(m.d)({type:"HELP_UPDATE",text:e.help}));const t=Date.now()+"\t"+(e.ip||"");console.log("rootSaga",e);const s={sid:t,userId:e.userID||"notProvided",subId:e.subId||"notProvided",nameOfDialog:e.name_of_dialog||"notProvided",taskID:e.taskID||"notProvided",mode:e.option},n=window.speechSynthesis;yield Object(m.a)([Object(m.b)(C,s,t,n),Object(m.b)(v,n)])}function*P(e){yield Object(m.d)({type:"SESSION_INTERACTIVE_UPDATE",interactive:e.data})}function*E(e){yield Object(m.d)({type:"ALL",all:e.List})}function*F(e){try{const t=yield Object(m.b)(k.a.post,I+"/api/"+e.url+"/"+e.createdAt,{password:e.password});yield Object(m.d)({type:"SESSION_"+e.url.toString().toUpperCase()+"_UPDATE",[e.url]:t.data})}catch(t){console.log(t)}}function*M(){try{const e=yield Object(m.b)(k.a.get,I+"/api/get/systems");yield Object(m.d)({type:"UPDATE_SYSTEM",system:e.data})}catch(e){console.log(e)}}function*R(e){"object"===typeof e&&(e=e.task_type);try{const t=yield Object(m.b)(k.a.get,I+"/api/"+e);yield Object(m.d)({type:"UPDATE_"+e.toUpperCase(),[e]:t.data.response})}catch(t){console.log(t)}}function*N(e){console.log("deleteProject");try{yield Object(m.b)(k.a.post,I+"/api/delete/"+e.task_type+"/"+e.task_id,{password:e.password}),yield R(e.task_type)}catch(t){console.log(t)}}function*B(e){console.log("deleteResult");try{yield Object(m.b)(k.a.get,I+"/api/delete/result/"+e.task_type+"/"+e.submit_id),yield H(e)}catch(t){console.log(t)}}function*H(e){console.log("task_type");try{const t=yield Object(m.b)(k.a.get,I+"/api/get/result/"+e.task_type+"/"+e.task_id);yield Object(m.d)({type:"UPDATE_RESULT",dialog:t.data.dialog,survey:t.data.survey})}catch(t){console.log(t)}}const L=(()=>{try{const e=localStorage.getItem("state");if(null===e)return;return JSON.parse(e)}catch(e){return void console.log(e)}})();var K=s(1248),U=s(1247),z=s(571),W=s(570),Q=s(562),G=s(569),V=s(1);class Y extends i.a.Component{constructor(e){super(e),this.state={dialogs:[]}}render(){return Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{children:" What is DialCrowd? "}),Object(V.jsxs)("p",{children:["In order to make testing easier and more automated, a framework for connecting to a crowdsourcing entity such as (but not only) ",Object(V.jsx)("a",{href:"https://www.mturk.com/",children:"Amazon Mechanical Turk (AMT)"})," and for rapidly creating and deploying tasks. "]}),Object(V.jsx)("p",{children:"In our experience, there are often a small set of standardized test scenarios (templates) that cover a large portion of the dialog tasks that are run on AMT. When we make those scenarios easy to create, testing is faster, and less burdensome. For some who are new to the area, the use of these scenarios guides them to accepted testing structures that they may not have been aware of."}),Object(V.jsx)("p",{children:"At the outset, the Task Creation Toolkit will use standard templates that are easy to flesh out. Later, when the toolkit is finished, the community will be invited to add more."}),Object(V.jsx)("p",{children:"The Toolkit will aid in other aspects of running tasks such as, in relevant cases, reminding the requester to post a consent form for explicit permission to use the data. We will ensure that the results are collected ethically and can be made available to the community with as few restrictions as possible that do not compromise a worker\u2019s privacy."}),Object(V.jsx)("h1",{children:" People "}),Object(V.jsxs)("p",{children:[Object(V.jsx)("a",{href:"https://www.cs.hhu.de/en/research-groups/dialog-systems-and-machine-learning/our-team/team.html",target:"_blank",rel:"noopener noreferrer",children:"Songbo Hu"}),", Intern@Heinrich Heine University D\xfcsseldorf"]}),Object(V.jsxs)("p",{children:[Object(V.jsx)("a",{href:"https://www.cs.hhu.de/en/research-groups/dialog-systems-and-machine-learning/our-team/team/cv-gasic.html",target:"_blank",rel:"noopener noreferrer",children:"Prof. Milica Ga\u0161i\u0107"}),", Heinrich Heine University D\xfcsseldorf"]}),Object(V.jsxs)("p",{children:[Object(V.jsx)("a",{href:"http://heckmichael.de/",target:"_blank",rel:"noopener noreferrer",children:"Dr. Michael Heck"}),", Heinrich Heine University D\xfcsseldorf"]}),Object(V.jsxs)("p",{children:[Object(V.jsx)("a",{href:"http://www.nflubis.com/",target:"_blank",rel:"noopener noreferrer",children:"Dr. Nurul Fithria Lubis"}),", Heinrich Heine University D\xfcsseldorf"]}),Object(V.jsxs)("p",{children:[Object(V.jsx)("a",{href:"https://carelvniekerk.github.io/",target:"_blank",rel:"noopener noreferrer",children:"Carel van Niekerk"}),", Heinrich Heine University D\xfcsseldorf"]}),Object(V.jsxs)("p",{children:[Object(V.jsx)("a",{href:"https://www.cs.hhu.de/en/research-groups/dialog-systems-and-machine-learning/our-team/team.html",target:"_blank",rel:"noopener noreferrer",children:"Shutong Feng"}),", Heinrich Heine University D\xfcsseldorf"]}),Object(V.jsxs)("p",{children:[Object(V.jsx)("a",{href:"https://chrisgeishauser.github.io/",target:"_blank",rel:"noopener noreferrer",children:"Christian Geishauser"}),", Heinrich Heine University D\xfcsseldorf"]}),Object(V.jsxs)("p",{children:[Object(V.jsx)("a",{href:"https://hsien1993.github.io/",target:"_blank",rel:"noopener noreferrer",children:"Hsien-Chin Lin"}),", Heinrich Heine University D\xfcsseldorf"]}),Object(V.jsx)("h1",{children:" Contact "}),Object(V.jsx)("p",{children:" Contact at dialog@hhu.de"})]})}}var J=Y,$=s(161),X=s(535),Z=s(536),ee=s(537),te=s(538),se=s(539),ne=s(540),ie=s(541),ae=s(542),re=s(543);const{SubMenu:oe}=$.a;class ce extends i.a.Component{constructor(e){super(e),this.navItems1=[{to:"/",title:"Home",icon:Object(V.jsx)(X.a,{})},{to:"/system",title:"Add System",icon:Object(V.jsx)(Z.a,{})}],this.navItems2=[{to:"/interactive_project",title:"Interaction",icon:Object(V.jsx)(ee.a,{})},{to:"/category_project",title:"Intent Classification",icon:Object(V.jsx)(te.a,{})},{to:"/sequence_project",title:"Entity Classification",icon:Object(V.jsx)(se.a,{})},{to:"/quality_project",title:"Quality Annotation",icon:Object(V.jsx)(ne.a,{})}],this.navItems3=[{to:"/resources",title:"Resources",icon:Object(V.jsx)(ie.a,{})},{to:"/walkthrough",title:"Walkthrough",icon:Object(V.jsx)(ae.a,{})}]}render(){return Object(V.jsxs)(U.a.Sider,{trigger:null,collapsible:!0,collapsed:this.props.collapsed,width:"225px",children:[Object(V.jsx)("div",{className:"logo",children:Object(V.jsx)("p",{style:{color:"#afb6bc",margin:"10px",textAlign:"center"}})}),Object(V.jsxs)($.a,{mode:"inline",theme:"dark",style:{lineHeight:"64px"},defaultSelectedKeys:[this.props.selectedKey],children:[this.navItems1.map((e=>{let{to:t,title:s,icon:n}=e;return Object(V.jsx)($.a.Item,{style:{fontSize:16},children:Object(V.jsx)(K.a,{to:t,style:{display:"flex",flexDirection:"row",alignItems:"center"},children:Object(V.jsxs)("span",{children:[" ",n," ",s]})})},t)})),Object(V.jsx)(oe,{title:Object(V.jsxs)("div",{children:[Object(V.jsx)(re.a,{style:{fontSize:20}}),Object(V.jsx)("span",{children:"Task Templates"})]}),children:this.navItems2.map((e=>{let{to:t,title:s,icon:n}=e;return Object(V.jsx)($.a.Item,{style:{fontSize:16},children:Object(V.jsx)(K.a,{to:t,style:{display:"flex",flexDirection:"row",alignItems:"center"},children:Object(V.jsxs)("span",{children:[n," ",s]})})},t)}))},"template"),this.navItems3.map((e=>{let{to:t,title:s,icon:n}=e;return Object(V.jsx)($.a.Item,{style:{fontSize:16},children:Object(V.jsx)(K.a,{to:t,style:{display:"flex",flexDirection:"row",alignItems:"center"},children:Object(V.jsxs)("span",{children:[n," ",s]})})},t)}))]})]})}}var le=ce,de=s(393),he=s(560),ue=s(561),pe=s(572),je=s(1260),be=s(1254),me=s(578),xe=s(109),ye=s(60),ge=s(1257),fe=s(556);function Oe(e,t,s){return{type:"NEW_SESSION",createdAt:e,password:t,url:s}}function ve(e,t){return{type:"GET_RESULT",task_type:e,task_id:t}}function we(e,t,s){return{type:"DELETE_RESULT",task_type:e,task_id:t,submit_id:s}}function ke(e){return{type:"NEW_PROJECT_DATA",task_type:e}}var Ie=s(1249),Se=s(196),Ce=s(1258),_e=s(544);const Te=de.a.TabPane,De=je.a.Item;class qe extends i.a.Component{constructor(e){super(e),this.showDrawer=()=>{this.setState({visible:!0})},this.onClose=()=>{this.setState({visible:!1})},this.generate=e=>{e.preventDefault(),this.props.form.validateFields(((e,t)=>{e||this.setState({username:t.username,showlink:!0})}))},this.state={visible:!1,username:"",showlink:!1}}componentDidMount(){}render(){console.log("InteractiveTemplate.js"),console.log(this.props.thisstate);const{getFieldDecorator:e}=this.props.form;return Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{type:"primary",style:{float:"left",width:"90%"},onClick:this.showDrawer,children:[Object(V.jsx)(_e.a,{}),"Amazon Mechanical Turk Template"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsxs)(Ie.a,{title:"Template",width:720,placement:"right",onClose:this.onClose,maskClosable:!0,visible:this.state.visible,style:{height:"calc(100% - 55px)",overflow:"auto",paddingBottom:53},children:[Object(V.jsx)(Se.a,{gutter:16,children:Object(V.jsx)("div",{children:Object(V.jsxs)(de.a,{defaultActiveKey:"preview",children:[Object(V.jsx)(Te,{tab:Object(V.jsx)("span",{children:"Preview"}),children:Object(V.jsxs)("div",{children:[Object(V.jsxs)("div",{style:{"border-style":"solid"},children:[Object(V.jsx)("div",{style:{"text-align":"center"},children:Object(V.jsx)("p",{children:"Preview"})}),Object(V.jsxs)("p",{style:{"padding-left":"2%"},children:["Background: ",this.props.thisstate.generic_introduction," "]}),Object(V.jsxs)("p",{style:{"padding-left":"2%"},children:["Instructions: ",this.props.thisstate.generic_instructions," "]})]}),Object(V.jsx)("br",{}),Object(V.jsx)("p",{children:"Input a username and generate the HIT link"}),Object(V.jsx)(je.a,{onSubmit:this.generate,children:Object(V.jsxs)(De,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}},children:[e("username")(Object(V.jsx)(Ce.a.TextArea,{placeholder:"Username",style:{width:"60%",marginRight:8,float:"left"},autoSize:{minRows:1,maxRows:1}})),Object(V.jsx)(ye.a,{type:"primary",htmlType:"submit",style:{float:"left"},children:"Generate Link"})]})}),this.state.showlink?Object(V.jsxs)("p",{children:["Please go to ",S,"/worker_interactive?MID=",this.state.username,"&ID=",this.props.thisstate._id," in a separate window to complete the HIT"]}):null,Object(V.jsx)("br",{}),Object(V.jsxs)("p",{children:["When you are done, input the confirmation code here: ",Object(V.jsx)("input",{type:"text",style:{border:"1px solid gray","padding-left":"5px"}})]})]})},"preview"),Object(V.jsxs)(Te,{tab:Object(V.jsx)("span",{children:"Code"}),children:[Object(V.jsx)("pre",{children:Object(V.jsxs)("code",{children:["<style>",Object(V.jsx)("br",{}),Object(V.jsxs)("p",{style:{"margin-left":"20px"},children:["table, th, td ","{"]}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"border: 1px solid black;"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"}"}),Object(V.jsxs)("p",{style:{"margin-left":"20px"},children:["th, td ","{"]}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"padding: 15px;"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"}"}),"</style>",Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"\x3c!-- Unique turker script --\x3e ",Object(V.jsx)("br",{}),'<script src="//uniqueturker.myleott.com/lib.js" type="text/javascript"><\/script>',Object(V.jsx)("br",{}),"<script>",Object(V.jsx)("br",{}),"(function() ","{",Object(V.jsxs)("p",{style:{"margin-left":"20px"},children:['var ut_id = "e776c2408d15bc01e2f380e30759f24b";',Object(V.jsx)("br",{}),"if (UTWorkerLimitReached(ut_id)) ","{"]}),Object(V.jsxs)("p",{style:{"margin-left":"40px"},children:["document.getElementById('mturk_form').style.display = 'none';",Object(V.jsx)("br",{}),"document.getElementsByTagName('body')[0].innerHTML = \"You have already completed the maximum number of HITs allowed by this requester. Please click 'Return HIT' to avoid any impact on your approval rating.\";"]}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"}"}),"}",");",Object(V.jsx)("br",{}),"<\/script>",Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"\x3c!-- You must include this Javascript file --\x3e ",Object(V.jsx)("br",{}),'<script src="https://assets.crowd.aws/crowd-html-elements.js"><\/script> ',Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"\x3c!-- For the full list of available Crowd HTML Elements and their input/output documentation, please refer to https://docs.aws.amazon.com/sagemaker/latest/dg/sms-ui-template-reference.html --\x3e ",Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"\x3c!-- You must include crowd-form so that your task submits answers to MTurk --\x3e ",Object(V.jsx)("br",{}),'<crowd-form answer-format="flatten-objects"> ',Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"<div> ",Object(V.jsx)("br",{}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:'<div style="border-style: solid">'}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:'<div style="text-align: center">'}),Object(V.jsx)("p",{style:{"margin-left":"60px"},children:"<p>Preview</p>"}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"</div>"}),Object(V.jsxs)("p",{style:{"margin-left":"40px"},children:['<p style="padding-left: 2%">Background: ',this.props.thisstate.generic_introduction," </p>"]}),Object(V.jsxs)("p",{style:{"margin-left":"40px"},children:['<p style="padding-left: 2%">Instructions: ',this.props.thisstate.generic_instructions," </p>"]}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"</div>"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"<div>"}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"<p>Input a username and generate the HIT link</p>"}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:'<input id="workerid" type="text" name="username" placeholder="Username">'}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:'<button id="submit">Generate Link</button>'}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"</div>"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"<br>"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:'<div><span id="dialcrowd_link"> - </span></div>'}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:'<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"><\/script>'}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"<script>"}),Object(V.jsxs)("p",{style:{"margin-left":"40px"},children:["document.getElementById('submit').onclick = function(event) ","{"]}),Object(V.jsx)("p",{style:{"margin-left":"60px"},children:"event.preventDefault();"}),Object(V.jsxs)("p",{style:{"margin-left":"60px"},children:['document.getElementById("dialcrowd_link").textContent = "Please go to ',S,"/worker_interactive/?ID=",this.props.thisstate._id,'&MID=" + document.getElementById("workerid").value + " in a separate window to complete the HIT"']}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"}"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"<\/script>"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:'<p>When you are done, input the confirmation code here: <input type="text" name="confirmation_code"></p>'}),"</div> ",Object(V.jsx)("br",{}),"</crowd-form> ",Object(V.jsx)("br",{})]})}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{})]},"code")]})})}),Object(V.jsx)("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"},children:Object(V.jsx)(ye.a,{style:{marginRight:8},onClick:this.onClose,children:"Close"})})]})]})}}var Ae=je.a.create()(qe),Pe=s(97),Ee=s.n(Pe),Fe=s(1255),Me=s(286),Re=s(1253),Ne=s(1252),Be=s(545),He=s(546),Le=s(549),Ke=s(1259),Ue=s(228),ze=s(1250),We=s(46),Qe=s.n(We);class Ge extends i.a.Component{constructor(e){super(e)}render(){const{questions:e,title:t,borderStyle:s}=this.props;switch(s||"box"){case"box":return Object(V.jsx)("div",{title:t,style:{border:"2px solid black",margin:"10px",padding:5},children:e.map(((e,t)=>this._renderQuestion(e,t)))});case"none":return e.map(((e,t)=>this._renderQuestion(e,t)))}}_renderQuestion(e,t){const{getFieldDecorator:s,systemNames:n,title:i}=this.props,a=this.props.fieldPrefix||"",r=e.likertScale||5,o=["1 Strongly Disagree"].concat(Array(r>2?r-2:0).fill(""),["".concat(r," Strongly Agree")]),c={labelCol:{span:5},wrapperCol:{span:11},colon:!1},l={labelCol:{span:10},wrapperCol:{span:7},colon:!1},d={display:"block",height:"30px",lineHeight:"30px"},h="none"===this.props.borderStyle?{}:{"padding-left":"5%"};switch(e.type){case"Likert Scale":return Object(V.jsxs)("div",{style:h,children:[Object(V.jsxs)("span",{children:[t+1,". ",e.title.replace(".",""),Object(V.jsx)("br",{}),"(0 star for strongly disagree, ".concat(e.likertScale||5," for strongly agree.)")]}),Object(V.jsx)(je.a.Item,{style:{"margin-bottom":0},...l,children:"Feedback"!==i?Object(V.jsx)("div",{children:s(a+"Likert|||"+e.title.replace(".","")+"|||"+t,{initialValue:0,rules:[{required:!0,message:"Please input your answer"}]})(Object(V.jsx)(ze.a,{count:e.likertScale||5,tooltips:o,value:0,defaultValue:0}))}):Object(V.jsx)("div",{children:s(a+"Likert|||"+e.title.replace(".","")+"|||"+t)(Object(V.jsx)(ze.a,{tooltips:o,value:0,defaultValue:0}))})})]});case"Open ended":return Object(V.jsxs)("div",{style:h,children:[Object(V.jsxs)("span",{children:[t+1,". ",e.title.replace(".","")]}),Object(V.jsx)(je.a.Item,{...l,style:{"margin-bottom":0},children:"Feedback"!==i?Object(V.jsxs)("div",{children:[s(a+"Open|||"+e.title.replace(".","")+"|||"+t,{rules:[{required:!0,message:"Please input your answer"}]})(Object(V.jsx)(Ce.a,{placeholder:"Please input your answer"}))," "]}):Object(V.jsxs)("div",{children:[s(a+"Open|||"+e.title.replace(".","")+"|||"+t)(Object(V.jsx)(Ce.a,{placeholder:"Please input your answer"}))," "]})})]});case"Radio":return Object(V.jsxs)("div",{style:h,children:[Object(V.jsxs)("span",{children:[t+1,". ",e.title.replace(".","")]}),Object(V.jsx)(je.a.Item,{...c,style:{"margin-bottom":0},children:"Feedback"!==i?Object(V.jsxs)("div",{children:[s(a+"Radio|||"+e.title.replace(".","")+"|||"+t,{rules:[{required:!0,message:"Please input your answer"}]})(Object(V.jsx)(Me.default.Group,{children:e.options.map((e=>Object(V.jsx)(Me.default,{style:d,value:e.content,children:Object(V.jsxs)("span",{children:[e.content,"\xa0"]})})))}))," "]}):Object(V.jsxs)("div",{children:[s(a+"Radio|||"+e.title.replace(".","")+"|||"+t)(Object(V.jsx)(Me.default.Group,{children:e.options.map((e=>Object(V.jsx)(Me.default,{style:d,value:e.content,children:Object(V.jsxs)("span",{children:[e.content,"\xa0"]})})))}))," "]})})]});case"Voting":return Object(V.jsxs)("div",{style:{"padding-left":"40%"},children:[Object(V.jsxs)("span",{children:[t+1,". ",e.title.replace(".","")]}),Object(V.jsx)(je.a.Item,{style:{"margin-bottom":0},...l,children:s(a+"AB|||"+e.title.replace(".","")+"|||"+t,{rules:[{required:!0,message:"Please input your answer"}]})(Object(V.jsxs)(Me.default.Group,{children:[n.map((e=>Object(V.jsx)(Me.default,{value:e.replace(".",""),children:e.replace(".","")}))),Object(V.jsx)(Me.default,{value:"Draw",children:"Draw"})]}))})]})}}}function Ve(e,t){return e?Object(V.jsxs)("div",{title:"Feedback",style:{width:"500px",margin:"0 auto","text-align":"center"},children:[Object(V.jsxs)("p",{style:{fontSize:15,color:"black","margin-bottom":"-10px"},children:[Object(V.jsx)("b",{children:"(Optional)"})," Please let us know if you have any further feedback:"]}),t("FeedbackOpen|||1")(Object(V.jsx)(Ce.a,{placeholder:"",style:{width:"80%",height:"80px",marginRight:8}}))]}):null}class Ye extends i.a.Component{render(){return this.props.enableMarkdown?Object(V.jsx)(Qe.a,{children:this.props.children}):Object(V.jsxs)(V.Fragment,{children:[" ",this.props.children," "]})}}var Je=Ge,$e=s(227);class Xe extends i.a.Component{constructor(e){super(e),this.close=()=>{this.setState({visible:!1})},this.handleReject=()=>{Ke.a.warning({title:"Thank you for your time.",content:"Please return to Amazon Mechanical Turk",zIndex:2e3})},this.handleAccept=()=>{this.props.form.validateFields(((e,t)=>{e||(this.close(),void 0!==this.props.onAccept&&this.props.onAccept())}))},this.nextPage=()=>{this.setState({page:this.state.page+1})},this.prevPage=()=>{this.setState({page:this.state.page-1})},this._showPageButton=()=>{const e=this.props.handleReject||this.handleReject;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)("a",{href:this.props.consent,download:"consent.pdf",children:[" ","You can also download our Consent Form Here"," "]}),Object(V.jsx)(ye.a,{onClick:e,danger:!0,children:"Reject"},"reject"),Object(V.jsx)(ye.a,{type:"primary",onClick:this.nextPage,children:"Agree & Next"})]})},this._showAcceptRejectButton=()=>{this.props.handleReject||this.handleReject;const e=this.handleAccept;return Object(V.jsx)(V.Fragment,{children:Object(V.jsx)(ye.a,{type:"primary",closable:"false",onClick:e,children:"Agree"},"accept")})},this._makePages=()=>{let e=[];return void 0!==this.props.consent&&""!==this.props.consent&&e.push({width:"90%",height:"calc(100% - 20px)",title:Object(V.jsx)("h2",{children:" Please read and agree to the consent form. "}),content:Object(V.jsx)("iframe",{src:this.props.consent,height:"100%",width:"100%"})}),void 0!==this.props.checkboxes&&this.props.checkboxes.length>0&&e.push({title:Object(V.jsx)("h2",{children:"Please check all that apply."}),content:this.props.checkboxes.map((e=>Object(V.jsx)(je.a.Item,{children:this.props.form.getFieldDecorator("checkbox[".concat(e.key,"]"),{valuePropName:"checked",initialValue:!1,validateTrigger:["onChange","onBlur"],rules:[{required:!0,transform:e=>e||void 0,type:"boolean",message:"You must fulfill this requirement in order to do this task!"}]})(Object(V.jsx)($e.a,{children:e.content},e.key))})))}),e},this.state={visible:this.props.initState||!0,page:0}}render(){const e=this.state.visible||this.state.forceShow,t=(this.props.handleAccept||this.close,this._makePages());if(0==t.length)return null;{const s=t[this.state.page],n=this.state.page===t.length-1?this._showAcceptRejectButton():this._showPageButton();return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("style",{children:"\n        .ant-modal-content {height: 100%; display: flex; flex-direction: column;}\n            "}),Object(V.jsx)(Ke.a,{visible:e,title:s.title,width:s.width,height:s.height,closable:!1,maskClosable:!1,bodyStyle:{flexGrow:1},centered:!0,zIndex:1e3,footer:n,children:s.content})]})}}}const Ze=je.a.create()(Xe);var et=s(1261),tt=s(1263),st=s(101),nt=s(1264),it=s(547),at=s(548),rt=s(287);i.a.Component;function ot(e){let t={global:{spacing:0},background:{marginTop:"-3px",marginBottom:"-3px",fontSize:15},instruction:{fontSize:18},example:{fontSize:14,textAlign:"left",fontFamily:"Arial"},context:{fontSize:14,lineHeight:1.5},response:{fontSize:14},question:{fontSize:14},tabTitle:{},...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}};for(const[s,n]of Object.entries(e||{}))for(const[e,i]of Object.entries(n))t[s]=t[s]||{},-1!==["fontSize","spacing"].indexOf(e)&&void 0!==i?t[s][e]=parseInt(i):t[s][e]=i;return t.instruction.marginTop="".concat(t.global.spacing,"px"),t.background.marginTop="".concat(t.global.spacing,"px"),t.background.marginBottom="".concat(t.global.spacing,"px"),t.context.marginBottom="".concat(Math.max(.33*t.context.lineHeight,0),"em"),t}var ct=s(1251);function lt(e,t){if(t.length>0)return Object(V.jsx)("p",{children:Object(V.jsx)("b",{children:e})})}function dt(e){if(e.length>0)return e.split(",").map((e=>Object(V.jsx)("p",{children:e})))}function ht(e){return Object(V.jsxs)("div",{style:{"text-align":"center"},children:[lt("Condition",e.Cons),dt(e.Cons),Object(V.jsx)("p",{}),lt("Please Book",e.Book),dt(e.Book),Object(V.jsx)("p",{}),lt("Please Ask",e.Reqs),dt(e.Reqs)]})}function ut(e){return Object(V.jsxs)("div",{style:{background:"#ECECEC",padding:"10px"},children:[Object(V.jsx)("p",{children:"You can click the domain to see the detail of the dialogue task."}),Object(V.jsx)(st.a,{children:e.map((e=>function(e){return Object(V.jsx)(ct.a,{content:ht(e),title:e.Dom,trigger:"click",placement:"bottomLeft",children:Object(V.jsx)(ye.a,{children:e.Dom})})}(e)))})]})}const pt=et.a.Panel,jt=je.a.Item,bt=(Me.default.Group,Ke.a.confirm);function mt(e){for(var t,s,n=e.length;0!==n;)s=Math.floor(Math.random()*n),t=e[n-=1],e[n]=e[s],e[s]=t;return e}function xt(e,t){fetch(I+"/api/worker/interactive/"+t).then((function(e){return e.json()})).then((function(t){if(void 0!==t.err)return void Ke.a.error({content:t.err});let s,n,i,a=function(e){let t={};for(t.intro=e.generic_introduction,t.instructions=e.generic_instructions,t.speech=e.speech,t.MNor1N=e.MNor1N;e.exampleTable[0]&&!e.exampleTable[0].question;)e.exampleTable.shift();t.exampleTable=e.exampleTable;let s=[];e.name_of_dialog.forEach((function(t,n){let i={};i.name_of_dialog=t,i.specific_instructions=e.specific_instructions[n],i.subpoll=e.subpoll[n],i.subtypeofpoll=e.subtypeofpoll[n],i.url_dialog_system=e.url_dialog_system[n],s.push(i)}));let n=[];e.pollquestion.forEach((function(t,s){let i={};t&&(i.exitpoll=t,i.polltype=e.typeofpoll[s],n.push(i))}));let i=[],a=[];return e.keys3&&e.keys3.forEach((function(t,s){i.push(e.feedback[t]),a.push(e.feedbackType[t])})),t.feedback=i,t.feedbackType=a,mt(s),mt(n),t.body=s,t.end=n,t.time=e.time,t.payment=e.payment,t.consent=e.consent,t}(t);s=void 0===t.questionSurveys?_t(t.pollquestion,t.typeofpoll,t.radio,t.example,t.counterexample):Tt(t.questionSurveys),n=void 0===t.questionFeedbacks?_t(t.feedback||[],t.feedbackType||[],t.feedbackradio||[]):Tt(t.questionFeedbacks),i=void 0===t.questionSystems?function(e,t,s,n,i,a){const r=e=>e.filter((e=>null!==e)).map(((e,t)=>({key:t,content:e})));let o=[];for(let c=0;c<e.length;c+=1){let l=Array.isArray(i[c])?i[c]:[i[c]],d=Array.isArray(i[c])?a[c]:[a[c]];o.push({key:c,name:e[c],instruction:t[c],questions:[{key:0,title:s[c],type:n[c],examples:r(l),counterexamples:r(d)}]})}return o}(t.name_of_dialog,t.generic_instructions,t.subpoll,t.subtypeofpoll,t.dialog_examples,t.dialog_counterexamples):Tt(t.questionSystems),sessionStorage.setItem("systemArr",JSON.stringify(i.sort((()=>Math.random()-.5)))),e.setState({speech:a.speech,interface:t.interface,intro:a.intro,instructions:a.instructions,feedback:a.feedback,feedbackType:a.feedbackType,timepay:a.time,payment:a.payment,consent:a.consent[1],feedbackradio:a.feedbackradio,questionSurveys:s,questionFeedbacks:n,questionSystems:i,systemArr:JSON.parse(sessionStorage.getItem("systemArr")),requirements:Tt(t.requirements||[]),hasFeedbackQuestion:t.hasFeedbackQuestion,style:t.style,enableMarkdown:t.enableMarkdown})}))}function yt(e,t){let s=window.location.search,n=new URLSearchParams(s),i=n.get("assignmentId"),a=(n.get("mturkProduction"),n.get("turkSubmitTo"));null!=i&&"ASSIGNMENT_ID_NOT_AVAILABLE"!==i&&function(e,t){t=t||"post";var s=document.createElement("form");s.setAttribute("method",t),s.setAttribute("action",e),s._submit_function_=s.submit,document.body.appendChild(s),s._submit_function_()}(a+"/mturk/externalSubmit"+"?assignmentId="+i+"&survey_code="+e.state.userID+"&hasproblem="+t,"POST")}class gt extends i.a.Component{componentDidMount(){var e=Date.now();this.setState({userID:e});const t=y.a.parse(window.location.search);if(t.ID){var s=t.ID;this.setState({subId:s})}else s="5aa2ea0f2972991520138bdb",this.setState({subId:s});var n;xt(this,s),n=this,fetch(I+"/api/get_interactive_task/"+s).then((function(e){return e.json()})).then((function(e){let t=JSON.parse(e.task);n.setState({current_task:t,taskList:t.tasks,taskID:t.taskID})}))}constructor(e){super(e),this.talk_to_system=(e,t,s)=>{let n=e.agent,i="";this.props.system.forEach((e=>{n===e._id&&(i=e.url)})),this.setState({chaturl:"".concat(S,"/chat?")+"option=".concat(this.state.interface,"&ip=").concat(i,"&userID=").concat(this.state.userID)+"&subId=".concat(this.state.subId,"&name_of_dialog=").concat(e.name)+"&taskID=".concat(this.state.taskID)+"&help=".concat(e.instruction),current_system:e.name,visible:!0,time:Date.now(),isSubmit:!0})},this.onClose=()=>{let e=this.state.system_time;e.push({system:this.state.current_system,time:Date.now()-this.state.time}),this.setState({visible:!1,system_time:e})},this.handleSubmit=e=>{e.preventDefault(),this.props.form.validateFields(((e,t)=>{var s,n,i;e||(this.state.isSubmit?(s=this,n=t,i=this.state.system_time,fetch(I+"/api/save/worker/interactive/"+s.state.userID,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({times:i,data:n,submissiontime:Date.now(),subId:s.state.subId})}).then((function(e){return e.json()})).then((function(e){if(e.success){let e=s.state.questionSystems,t=[];e.forEach((e=>{console.log("\ud83d\ude80 ~ file: WorkerInteractive.js ~ line 314 ~ dialogueSystems.forEach ~ system",e);const n=new Promise(((t,n)=>{fetch(I+"/api/validate/dialogue/"+s.state.subId+"/"+s.state.userID+"/"+e.name).then((function(e){return e.json()})).then((function(s){t({system:e.name,isPassed:s.isPassed,problems:s.problems})}))}));t.push(n)})),Promise.all(t).then((e=>{let t=[];if(e.forEach((e=>{e.isPassed||t.push(e)})),0===t.length)bt({title:"Thank you for submission",content:"Now you can submit to Mturk.",onOk(){yt(s,!0)},onCancel(){yt(s,!0)}});else{let e=[];t.forEach((t=>{e.push(t.system+" has problems "+t.problems)})),bt({title:"Sorry, there are issues with your submission",content:e.join("\n")+"\nWould you like to redo the assignment?",onOk(){window.location.reload()},onCancel(){bt({title:"Sorry, there are issues with your submission",content:"Your assignment is unlikely to be accepted, would you like to continue?",onOk(){yt(s,!0)},onCancel(){window.location.reload()}})}})}})).catch((e=>{}))}else bt({title:"Error",content:"You haven't talked to agents",onOk(){},onCancel(){}})}))):bt({content:"Please talk to the system before submission",onOk(){},onCancel(){}}))}))},this.openInstructions=()=>{if(!this.state.activeKey.includes("2")){let e=this.state.activeKey;e.push("2"),this.setState({activeKey:e})}},this.changeTab=e=>{this.setState({activeKey:e})},this.showSystemExamples=e=>{let t,s=[];for(const i of this.state.questionSystems)for(const e of i.questions)if((e.examples||[]).length>0||(e.counterexamples||[]).length>0){const n=i.name===t?"":i.name;s.push({system:n,question:e.title,examples:e.examples||[],counterexamples:e.counterexamples||[]})}if(0===s.length)return null;const n=[{title:"System",dataIndex:"system"},{title:"Question",dataIndex:"question"},{title:"Answer Examples",dataIndex:"examples",render:vt},{title:"Answer Counterexamples",dataIndex:"counterexamples",render:vt}];return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("div",{style:{...e.example,fontSize:e.example.fontSize+4},children:Object(V.jsx)("p",{children:"Example Answers for System Specific Questions:"})}),Object(V.jsx)(ge.a,{dataSource:s,columns:n,pagination:!1,size:"small",style:{...e.example,marginTop:"".concat(e.global.spacing,"px")}})]})},this.state={instructions:"",speech:!1,subId:"",isSubmit:!1,question:"",answer:"",isdone:!1,userID:"",visible:!1,current:1,path:"",meaning:"",examples:[],intro:"",systems:[],exitpoll:[],interface:"both",chaturl:"",feedback:[],feedbackType:[],time:"",system_time:[],current_system:"",timepay:"",payment:"",consent:"",radios:[],feedbackradio:[],activeKey:["1","2","3","4"],questionSurveys:[],questionFeedbacks:[],questionSystems:[],requirements:[],current_task:[],taskID:"",taskList:[],systemArr:[]}}render(){const{getFieldDecorator:e}=this.props.form,t=ot(this.state.style,{dialogInstruction:{color:"#282828",fontSize:18}});JSON.stringify(this.state.current_task);return Object(V.jsxs)("div",{style:t.global,children:[Object(V.jsxs)(Ie.a,{placement:"right",width:720,closable:!1,onClose:this.onClose,visible:this.state.visible,children:[ut(this.state.taskList),Object(V.jsx)(rt.a,{style:{"margin-right":"10px"},url:this.state.chaturl,width:"100%",height:"600",display:"initial",position:"relative",allowFullScreen:!0}),Object(V.jsx)(ye.a,{type:"primary",shape:"round",block:!0,onClick:this.onClose,children:"Finish"}),Object(V.jsx)(tt.a,{message:"Say Bye",description:"Remember to say 'bye' to Dialogue System!",type:"info",icon:Object(V.jsx)(it.a,{}),showIcon:!0,closable:!0}),Object(V.jsx)(tt.a,{message:"Do not click Return",description:"Clicking the return button on your browser will terminate the task. To exit the dialogue, click the form again or the Blue Finish Button above.",type:"warning",icon:Object(V.jsx)(at.a,{}),showIcon:!0,closable:!0})]}),Object(V.jsx)(je.a,{onSubmit:this.handleSubmit,style:{"margin-bottom":.1},children:Object(V.jsxs)(et.a,{defaultActiveKey:["1","2","3"],activeKey:this.state.activeKey,onChange:this.changeTab,children:[Object(V.jsxs)(pt,{header:"Background ",style:t.tabTitle,children:[Object(V.jsx)("p",{style:t.background,children:Object(V.jsx)(Ye,{enableMarkdown:this.state.enableMarkdown,children:this.state.intro})}),Object(V.jsx)(Ze,{consent:this.state.consent,checkboxes:this.state.requirements})]},"1"),Object(V.jsx)(pt,{header:"Instructions ",style:t.tabTitle,children:Object(V.jsx)("div",{style:t.instruction,children:this.state.enableMarkdown?Object(V.jsx)(Ye,{enableMarkdown:this.state.enableMarkdown,children:this.state.instructions}):Object(V.jsx)("b",{children:this.state.instructions})})},"2"),Object(V.jsx)(pt,{header:"Dialogue Task ",style:t.tabTitle,children:(s=this.state.taskList,Object(V.jsx)("div",{style:{background:"#ECECEC",padding:"30px"},children:Object(V.jsx)(Se.a,{gutter:16,children:s.map((e=>Object(V.jsx)(st.a,{span:6,children:Object(V.jsxs)(nt.a,{title:e.Dom,bordered:!1,headStyle:{size:20,"text-align":"center"},bodyStyle:{size:10,"text-align":"center"},children:[ft("Condition",e.Cons),Ot(e.Cons),Object(V.jsx)("p",{}),ft("Please Book",e.Book),Ot(e.Book),Object(V.jsx)("p",{}),ft("Please Ask",e.Reqs),Ot(e.Reqs)]})})))})}))},"3"),Object(V.jsxs)(pt,{header:"Start Your Task Here ",style:t.tabTitle,children:[this.state.activeKey.includes("2")?null:Object(V.jsx)("div",{style:{textAlign:"center"},children:Object(V.jsx)(ye.a,{type:"default",onClick:this.openInstructions,children:"Example Responses"})}),this.state.systemArr.map(((s,n)=>Object(V.jsxs)("div",{title:s.name,style:{border:"1px solid black",padding:18+t.global.spacing,marginTop:"".concat(12.5+t.global.spacing,"px")},children:[Object(V.jsxs)("div",{style:{display:"inline-block",width:"50%","padding-left":"40px","padding-right":"10px","vertical-align":"top",color:t.dialogInstruction.color},children:[Object(V.jsx)("span",{children:"Click to talk ".concat(s.name,":")}),e("username")(Object(V.jsx)(ye.a,{shape:"circle",icon:"message",size:"large",style:{margin:"10px"},onClick:()=>this.talk_to_system(s,this.state.questionSystems,n)}))]}),Object(V.jsx)("div",{style:{...t.question,display:"inline-block",width:"50%","padding-right":"40px","padding-left":"10px","vertical-align":"top"},children:Object(V.jsx)(Je,{getFieldDecorator:e,questions:s.questions,title:"",borderStyle:"none",fieldPrefix:"Sub|||".concat(s.name,"|||")})})]},s.key))),Object(V.jsx)("div",{style:t.question,children:Object(V.jsx)(Je,{getFieldDecorator:e,questions:this.state.questionSurveys,title:"Survey",systemNames:this.state.questionSystems.map((e=>e.name)),fieldPrefix:"Exit"})}),Object(V.jsx)("div",{style:{backgroundColor:"#C1E7F8"},children:Object(V.jsx)(jt,{style:{textAlign:"center"},wrapperCol:{span:12,offset:6},children:Ve(this.state.hasFeedbackQuestion,e)})}),Object(V.jsx)("div",{style:{"text-align":"center"},children:Object(V.jsx)(ye.a,{type:"primary",htmlType:"submit",children:"Submit"})})]},"4")]})})]});var s}}function ft(e,t){if(t.length>0)return Object(V.jsx)("p",{children:Object(V.jsx)("b",{children:e})})}function Ot(e){if(e.length>0)return e.split(",").map((e=>Object(V.jsx)("p",{children:e})))}function vt(e,t){return Object(V.jsx)("ul",{children:(e||[]).map(((e,t)=>Object(V.jsxs)("li",{children:[e.content,void 0!==e.explain?Object(V.jsxs)(xe.a,{title:e.explain,children:["\xa0"," ",Object(V.jsx)("sub",{children:Object(V.jsx)("a",{children:"because..."})})]}):null]},t)))})}var wt=Object(o.b)((function(e,t){return{system:e.system}}),{})(je.a.create()(gt));class kt extends n.Component{constructor(e){super(e),this.state={visible:!1}}render(){return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(je.a.Item,{wrapperCol:{xs:{span:24,offset:0},sm:{span:20,offset:4}},children:Object(V.jsx)(ye.a,{onClick:()=>{this.showPreview()},style:{width:"90%"},disabled:0===this.props.requirements.length&&""===this.props.consent,children:"Preview the Above Consent Questions in Worker View"})}),this.state.visible?Object(V.jsx)(Ze,{consent:this.props.consent,checkboxes:this.props.requirements,forceShow:this.state.visible,onAccept:()=>this.close()}):null]})}showPreview(){this.setState({visible:!0})}close(){this.setState({visible:!1})}}class It extends n.Component{constructor(e){super(e),this.state={visible:!1}}render(){const e=[{title:"Question",dataIndex:"title"},{title:"Examples",dataIndex:"examples",key:"examples",render:vt},{title:"Counterexamples",dataIndex:"counterexamples",key:"counterexamples",render:vt}];return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ye.a,{onClick:()=>{this.showPreview()},style:{width:"90%"},children:"Preview the Examples and Counterexamples in Worker View"}),Object(V.jsx)(Ke.a,{visible:this.state.visible,centered:!0,zIndex:1e3,onCancel:()=>{this.close()},footer:Object(V.jsx)(ye.a,{onClick:()=>{this.close()},children:" Close "}),width:"75%",children:Object(V.jsx)(ge.a,{rowKey:"sentid",dataSource:this.props.questions,columns:e,pagination:!1,size:"small"})})]})}showPreview(){this.setState({visible:!0})}close(){this.setState({visible:!1})}}class St extends n.Component{constructor(e){super(e),this.state={visible:!1}}render(){return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ye.a,{onClick:()=>{this.showPreview()},style:{width:"90%"},children:"Preview this Question in Worker View"}),Object(V.jsx)(Ke.a,{visible:this.state.visible,centered:!0,zIndex:1e3,onCancel:()=>{this.close()},footer:Object(V.jsx)(ye.a,{onClick:()=>{this.close()},children:" Close "}),width:"60%",children:Object(V.jsx)(Je,{getFieldDecorator:this.props.form.getFieldDecorator,questions:[this.props.question],title:"",fieldPrefix:"",systemNames:this.props.systemNames,borderStyle:"none"})})]})}showPreview(){this.setState({visible:!0})}close(){this.setState({visible:!1})}}n.Component;var Ct=je.a.create()(St);function _t(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;const a=e=>e.filter((e=>null!==e)).map(((e,t)=>({key:t,content:e})));let r=[];for(let o=0;o<e.length;o+=1)if(void 0!==n){if(null===e[o])continue;let c=Array.isArray(n[o])?n[o]:[n[o]],l=Array.isArray(n[o])?i[o]:[i[o]];r.push({key:o,title:e[o],type:t[o],options:null===s[o]?[{key:0,content:""}]:a(s[o]),examples:a(c),counterexamples:a(l)})}else r.push({key:o,title:e[o],type:t[o],options:null===s[o]?[{key:0,content:""}]:a(s[o])});return r}function Tt(e){if(Array.isArray(e))return"string"===typeof(e=e.filter((e=>null!==e)))[0]?e.map(((e,t)=>({key:t,content:e}))):e.map(((e,t)=>({key:t,...Tt(e)})));if("object"===typeof e){let t={};for(let[s,n]of Object.entries(e))t[s]=Tt(n);return t}return e}class Dt extends i.a.Component{constructor(e){super(e),this._addQuestion=()=>{this.props.addByKey(this.props.rootKey,this.constructor.newQuestion())},this.formItemLayout=e.formItemLayout,this.formItemLayoutWithOutLabel={wrapperCol:{xs:{span:24,offset:0},sm:{span:20,offset:4}}},this.styleWarning={width:"90%",color:"darkorange","text-align":"center","font-weight":"bold"}}render(){return Object(V.jsxs)(V.Fragment,{children:[this.props.questions.map((e=>this._renderQuestionSection(e))),Object(V.jsx)(je.a.Item,{...this.formItemLayoutWithOutLabel,children:Object(V.jsxs)(ye.a,{type:"dashed",onClick:this._addQuestion,style:{width:"90%"},children:[Object(V.jsx)(Be.a,{})," ",this.props.textAddQuestion]})}),Object(V.jsx)(je.a.Item,{...this.formItemLayoutWithOutLabel,children:Object(V.jsx)(It,{questions:this.props.questions})})]})}_renderQuestionSection(e){switch(this.props.listStyle||"box"){case"box":return Object(V.jsx)("div",{style:{border:"2px solid black",margin:"10px",padding:24},children:this._renderQuestionBody(e)},e.key);case"divider":return Object(V.jsxs)("div",{children:[this._renderQuestionBody(e),Object(V.jsx)(Ne.a,{})]},e.key);default:throw"Unsupported listStyle ".concat(this.props.listStyle)}}_renderQuestionBody(e){const{getFieldDecorator:t}=this.props.form,s=String(this.props.rootKey[0])+this.props.rootKey.slice(1).map((e=>"[".concat(e,"]"))).join(""),n=t=>s=>{const n=void 0!==s.target?s.target.value:s;this.props.updateByKey(this.props.rootKey.concat([e.key]),{[t]:n})};return Object(V.jsxs)(V.Fragment,{children:["Add a System Specific Question"!==this.props.textAddQuestion?Object(V.jsx)("span",{style:{float:"left","margin-bottom":"-30px"},class:"instruction-tooltip",children:Object(V.jsxs)(xe.a,{title:this.props.textInstruction,children:[Object(V.jsx)(ae.a,{})," \xa0 Tips"]})}):null,Object(V.jsx)(je.a.Item,{children:Object(V.jsx)("span",{style:{float:"right","margin-bottom":"-30px","margin-top":"-20px","margin-right":"-10px"},children:this.props.questions.length>1?Object(V.jsx)(He.a,{className:"dynamic-delete-button",disabled:1===this.props.questions.length,onClick:()=>this.props.removeByKey(this.props.rootKey.concat([e.key]))}):null})}),this._showQuestionType(e),Object(V.jsx)(je.a.Item,{...this.formItemLayout,label:Object(V.jsxs)("span",{children:[this.props.questionFieldLabel||"Question"," \xa0",Object(V.jsx)(xe.a,{title:this.props.questionHelpText,children:Object(V.jsx)(ae.a,{})})]}),required:!0,children:t("".concat(s,"[").concat(e.key,']["title"]'),{initialValue:e.title,validateTrigger:["onChange","onBlur"],onChange:n("title"),rules:[{required:!0,whitespace:!0,message:"Please ask a question to the workers."}]})(Object(V.jsx)(Ce.a,{placeholder:this.props.placeholderQuestion,style:{width:"90%",marginRight:8}}))}),"Radio"===e.type?Object(V.jsx)(At,{form:this.props.form,formItemLayout:this.props.formItemLayout,removeByKey:this.props.removeByKey,addByKey:this.props.addByKey,updateByKey:this.props.updateByKey,rootKeys:this.props.rootKey.concat([e.key,"options"]),items:e.options,title:"Option",textHelp:"Give the worker an answer option.",textAdd:"Add an option",placeholder:this.props.placeholderOption}):null,"Likert Scale"===e.type?Object(V.jsx)(je.a.Item,{...this.formItemLayout,label:Object(V.jsxs)("span",{children:["Likert Scale Range\xa0",Object(V.jsx)(xe.a,{title:"Maximum range of the scale",children:Object(V.jsx)(ae.a,{})})]}),children:t("".concat(s,"[").concat(e.key,']["likertScale"]'),{initialValue:e.likertScale,validateTrigger:["onChange","onBlur"],onChange:n("likertScale"),rules:[{required:!0,message:"Please specify a number: 3, 5, or 7."}]})(Object(V.jsx)(Re.a,{defaultValue:5,min:3,max:7,step:2}))}):null,this.props.noPreview?null:Object(V.jsx)(je.a.Item,{...this.formItemLayoutWithOutLabel,children:Object(V.jsx)(Ct,{question:e,systemNames:this.props.systemNames})}),Object(V.jsx)("br",{}),Object(V.jsx)("hr",{}),Object(V.jsx)("br",{}),Object(V.jsx)(At,{form:this.props.form,formItemLayout:this.props.formItemLayout,removeByKey:this.props.removeByKey,addByKey:this.props.addByKey,updateByKey:this.props.updateByKey,rootKeys:this.props.rootKey.concat([e.key,"examples"]),items:e.examples||[],title:"Example and Explanation",textHelp:"Please provide an example of an answer to your question above. It helps the worker understand what is an acceptable answer, and thus ensures better quality of your collected data.",textAdd:"Add an example",placeholder:this.props.placeholderExample,placeholderExplain:"Why is this example well done?",recommendedNumber:3,recommendedMinNumber:1,required:"Open ended"===e.type,minimumNumber:"Open ended"===e.type?1:0}),Object(V.jsx)("br",{}),Object(V.jsx)("hr",{}),Object(V.jsx)("br",{}),Object(V.jsx)(At,{form:this.props.form,formItemLayout:this.props.formItemLayout,removeByKey:this.props.removeByKey,addByKey:this.props.addByKey,updateByKey:this.props.updateByKey,rootKeys:this.props.rootKey.concat([e.key,"counterexamples"]),items:e.counterexamples||[],title:"Counterexample and Explanation",textHelp:"Please provide an counterexample of an answer to your question above. It helps the worker understand what answers are unacceptable, and thus reduces low quality responses in your collected data.",textAdd:"Add a counterexample",placeholder:this.props.placeholderCounterexample,placeholderExplain:"Why is this example badly done?",recommendedNumber:3,recommendedMinNumber:1,required:"Open ended"===e.type,minimumNumber:"Open ended"===e.type?1:0})]})}_showQuestionType(e){const{getFieldDecorator:t}=this.props.form,s=String(this.props.rootKey[0])+this.props.rootKey.slice(1).map((e=>"[".concat(e,"]"))).join("");return 0===this.constructor.questionTypes.length?null:Object(V.jsx)(je.a.Item,{...this.formItemLayout,label:"Type of Question",children:t("".concat(s,"[").concat(e.key,']["type"]'),{initialValue:e.type,rules:[{required:!0,message:"Select one of them"}]})(Object(V.jsx)(Me.default.Group,{onChange:t=>{this.props.updateByKey(this.props.rootKey.concat([e.key]),{type:t.target.value})},name:e.key.toString(),children:this.constructor.questionTypes.map((e=>{let[t,s,n]=e;return Object(V.jsx)(Me.default,{value:t,children:Object(V.jsxs)("span",{children:[s," \xa0",Object(V.jsx)(xe.a,{title:n,children:Object(V.jsx)(ae.a,{})})]})})}))}))})}}Dt.questionTypes=[["Likert Scale","Likert Scale","Give the system a score from 1 to 5, 1 as strongly disagree and 5 as strongly agree."],["Open ended","Open ended","Require more thought and more than a simple one-word answer."],["Radio","Multiple Choice","Multiple choices are given."]],Dt.newQuestion=()=>({title:"",type:"Open ended",options:[{key:0,content:""}],examples:[{key:0,content:""}],counterexamples:[{key:0,content:""}],likertScale:5});class qt extends Dt{}qt.questionTypes=[["Voting","A/B tests","Select the system that performed better on a specific task you specify."],["Likert Scale","Likert Scale","Give the system a score from 1 to 5, 1 as strongly disagree and 5 as strongly agree."],["Open ended","Open ended","Require more thought and more than a simple one-word answer."],["Radio","Multiple Choice","Multiple choices are given."]];class At extends i.a.Component{constructor(e){super(e),this.styleWarning={width:"90%",color:"darkorange","text-align":"center","font-weight":"bold"}}render(){const{fields:e,rootKeys:t,placeholder:s,placeholderExplain:n,textHelp:i,recommendedNumber:a,recommendedMinNumber:r,textAdd:o,items:c,title:l}=this.props;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)(je.a.Item,{...this.props.formItemLayout,label:Object(V.jsxs)("span",{children:[l," \xa0",Object(V.jsx)(xe.a,{title:i,children:Object(V.jsx)(ae.a,{})})]}),required:void 0===this.props.required||this.props.required,children:[void 0!==r&&c.length<r?Object(V.jsxs)("span",{style:this.styleWarning,children:[Object(V.jsx)(Le.a,{}),"\xa0 Having at least ",r," example is recommended."]}):null,this._showDynamicInputs(c,t,s,n)]}),Object(V.jsxs)(je.a.Item,{wrapperCol:{xs:{span:24,offset:0},sm:{span:20,offset:4}},children:[Object(V.jsxs)(ye.a,{type:"dashed",onClick:()=>{this.props.addByKey(t)},style:{width:"90%"},children:[Object(V.jsx)(Be.a,{})," ",o]}),void 0!==a&&c.length>a?Object(V.jsxs)("div",{style:this.styleWarning,children:[Object(V.jsx)(Le.a,{}),"Adding more than ",a," examples is not recommended."]}):null]})]})}_showDynamicInputs(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;const{getFieldDecorator:i}=this.props.form,{removeExample:a}=this.props;void 0===e&&(e=[]);let r=t[0].toString();for(let c of t.slice(1))r+="[".concat(c,"]");const o=[];for(const c of e){const a=void 0===n?"":'["content"]',l=void 0===n?"90%":"45%",d=e=>{this.props.updateByKey(t.concat([c.key]),{content:e.target.value})},h=e=>{this.props.updateByKey(t.concat([c.key]),{explain:e.target.value})};o.push(i("".concat(r,"[").concat(c.key,"]").concat(a),{initialValue:c.content,validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please input some text."}],onChange:d})(Object(V.jsx)(Ce.a.TextArea,{placeholder:s,style:{width:l,marginRight:8},autoSize:!0}))),void 0!==n&&o.push(i("".concat(r,"[").concat(c.key,']["explain"]'),{initialValue:c.explain,validateTrigger:["onChange","onBlur"],rules:[{whitespace:!0,message:"Please input exaplaination."}],onChange:h})(Object(V.jsx)(Ce.a.TextArea,{placeholder:n,style:{width:l,marginRight:8},autoSize:!0}))),e.length>(void 0===this.props.minimumNumber?1:this.props.minimumNumber)&&o.push(Object(V.jsx)(xe.a,{children:Object(V.jsx)("a",{onClick:(e=>()=>this.props.removeByKey(t.concat([e])))(c.key),children:Object(V.jsx)(He.a,{})})}))}return o}}var Pt=Dt;class Et extends i.a.Component{constructor(e){super(e),this.open=()=>{this.setState({visible:!0})},this.close=()=>{this.setState({visible:!1})},this.state={visible:this.props.initState||!1}}render(){const{visible:e}=this.state;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ye.a,{wrapperCol:{xs:{span:24,offset:0},sm:{span:20,offset:4}},disabled:void 0===this.props.consent||""===this.props.consent,onClick:this.open,style:{width:"90%"},children:"Preview Consent Form"}),Object(V.jsx)("style",{children:"\n        .ant-modal-content {height: 100%; display: flex; flex-direction: column;}\n          "}),Object(V.jsx)(Ke.a,{visible:e,title:"Preview of Consent Form",width:"80%",height:"90%",closable:!0,maskClosable:!0,bodyStyle:{flexGrow:1},onCancel:this.close,centered:!0,footer:Object(V.jsx)(ye.a,{type:"primary",onClick:this.close,children:"Close"},"Close"),children:Object(V.jsx)("iframe",{src:this.props.consent,width:"100%",height:"100%"})})]})}}var Ft=Et,Mt=s(55),Rt=s(291);class Nt extends i.a.Component{constructor(e){super(e),this.handleClick=()=>{this.setState({visiblePicker:!this.state.visiblePicker})},this.state={visiblePicker:!1,color:this.props.initialValue},this.color=this.props.initialValue}componentDidUpdate(e){e.initialValue!==this.props.initialValue&&this.setState({color:this.props.initialValue})}close(){this.setState({visiblePicker:!1}),void 0!==this.color&&(this.setState({color:this.color.hex}),this.props.form.setFieldsValue({[this.props.name]:this.color.hex.toUpperCase()}))}handleChange(e){e.preventDefault(),this.setState({color:e.target.value})}render(){const{getFieldDecorator:e}=this.props.form;let t;return t=void 0===this.props.previewText?{background:this.state.color,color:this.state.color,"border-style":"solid","border-width":"1px","margin-left":"5px","border-color":"#BBBBBB"}:{color:this.state.color},Object(V.jsxs)(V.Fragment,{children:[this.showPicker(),Object(V.jsxs)("div",{children:[e(this.props.name,{initialValue:this.state.color,validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please specify a color."}],onChange:e=>this.handleChange(e)})(Object(V.jsx)(Ce.a,{placeholder:"#000000",style:{width:"20%"},onClick:this.handleClick})),Object(V.jsx)("span",{style:t,children:this.props.previewText||"\u2b24"})]})]})}handleColorChange(e,t){this.color=e}showPicker(){const e={position:"absolute",zIndex:"2"},t={left:0,bottom:0,position:"absolute"};return this.state.visiblePicker?Object(V.jsx)(V.Fragment,{children:Object(V.jsx)("div",{style:e,children:Object(V.jsxs)("div",{style:t,children:[Object(V.jsx)(Rt.a,{color:this.state.color,onChangeComplete:e=>this.handleColorChange(e)}),Object(V.jsx)(ye.a,{onClick:()=>this.close(),style:{width:"100%"},children:"Done"})]})})}):null}}var Bt=Nt,Ht=s(550),Lt=s(551),Kt=s(552),Ut=s(553),zt=s(554),Wt=s(555);class Qt extends i.a.Component{constructor(e){super(e),this.handleClick=()=>{this.setState({visiblePicker:!this.state.visiblePicker})},this.state={visiblePicker:!1},this.color=this.props.color}close(){if(this.setState({visiblePicker:!1}),void 0!==this.color){this.props.updateByKey(this.props.keys,{color:this.color.hex.toUpperCase()});const e=Gt(this.props.keys.concat(["color"]));this.props.form.setFieldsValue({[e]:this.color.hex.toUpperCase()})}}handleColorInputChange(e){e.preventDefault();const t=Gt(this.props.path.concat(["color"]));this.props.form.setFieldsValue({[t]:this.color.hex.toUpperCase()})}render(){const{getFieldDecorator:e}=this.props.form,t={color:this.props.color,fontFamily:this.props.fontFamily,fontSize:"".concat(this.props.fontSize,"pt"),"padding-left":"0.5em","vertical-align":"middle",display:"inline-block",width:"40%"},s=Gt(this.props.keys);return Object(V.jsxs)(V.Fragment,{children:[this.showPicker(),Object(V.jsxs)("div",{children:[Object(V.jsx)(xe.a,{title:"Text color.",children:Object(V.jsx)(Ht.a,{style:{marginLeft:"0.5em",marginRight:"0.5em",color:this.props.color}})}),e(s+"['color']",{initialValue:this.props.color||"#000000",validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please specify a color."}],onChange:e=>this.handleColorInputChange(e)})(Object(V.jsx)(Ce.a,{placeholder:"#000000",style:{width:"1em",height:"1em",color:"transparent",background:this.props.color},onClick:this.handleClick})),Object(V.jsx)(xe.a,{title:"Font size.",children:Object(V.jsx)(Lt.a,{style:{marginLeft:"1em",marginRight:"0.5em"}})}),e(s+"['fontSize']",{initialValue:"".concat(this.props.fontSize||12),validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please specify the size."}],onChange:e=>this.props.updateByKey(this.props.keys,{fontSize:e})})(Object(V.jsx)(Re.a,{style:{width:"4em"}})),Object(V.jsx)(xe.a,{title:"Line height.",children:Object(V.jsx)(Kt.a,{style:{marginLeft:"1em",marginRight:"0.5em"}})}),e(s+"['lineHeight']",{initialValue:"".concat(this.props.lineHeight||1.5),validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please specify the line hight."}]})(Object(V.jsx)(Re.a,{step:.25,style:{width:"4em"}})),Object(V.jsx)("span",{style:{marginRight:"0.5em"}}),e(s+"['fontFamily']",{initialValue:this.props.fontFamily||"Helvetica",validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please specify the font."}],onChange:e=>this.props.updateByKey(this.props.keys,{fontFamily:e})})(Object(V.jsx)(Ue.a,{defaultValue:this.state.family,style:{width:"15%",fontFamily:this.props.fontFamily},children:["Helvetica","Arial","Times New Roman","Impact","Times","Arial Black"].map(((e,t)=>Object(V.jsx)(Ue.a.Option,{value:e,style:{"font-family":e},children:e},t)))})),Object(V.jsx)("span",{style:{marginRight:"0.5em"}}),e(s+"['text-align']",{initialValue:this.props.textAlign||"left"})(Object(V.jsxs)(Me.default.Group,{children:[Object(V.jsx)(Me.default.Button,{value:"left",style:{paddingLeft:"0.5em",paddingRight:"0.5em"},children:Object(V.jsx)(Ut.a,{})}),Object(V.jsx)(Me.default.Button,{value:"center",style:{paddingLeft:"0.5em",paddingRight:"0.5em"},children:Object(V.jsx)(zt.a,{})}),Object(V.jsx)(Me.default.Button,{value:"right",style:{paddingLeft:"0.5em",paddingRight:"0.5em"},children:Object(V.jsx)(Wt.a,{})})]})),Object(V.jsx)("span",{style:t,children:this.props.previewText||"preview"})]})]})}handleColorPickerChange(e,t){this.color=e}showPicker(){const e={position:"absolute",zIndex:"2"},t={left:0,bottom:0,position:"absolute"};return this.state.visiblePicker?Object(V.jsx)(V.Fragment,{children:Object(V.jsx)("div",{style:e,children:Object(V.jsxs)("div",{style:t,children:[Object(V.jsx)(Rt.a,{color:this.state.color,onChangeComplete:e=>this.handleColorPickerChange(e)}),Object(V.jsx)(ye.a,{onClick:()=>this.close(),style:{width:"100%"},children:"Done"})]})})}):null}}function Gt(e){let t="";for(const s of e)t+="['".concat(s,"']");return t}var Vt=Qt;const Yt=je.a.Item;let Jt=0;class $t extends n.Component{constructor(e){var t;super(e),t=this,this.traverseAndCopyByKey=e=>{const t=e=>Array.isArray(e||[])?(e||[]).slice():Object.assign({},e);let s=[t(this.state)],n=this.state;for(const i of e){if(Array.isArray(n)&&void 0!==n[0].key){for(const[e,a]of n.entries())if(a.key===i){n=t(a),s[s.length-1][e]=n;break}}else n=void 0!==n[i]?t(n[i]):[],s[s.length-1][i]=n;s.push(n)}return s},this.addByKey=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;const n=t.traverseAndCopyByKey(e);let i=n[n.length-1];const a=0==i.length?0:i[i.length-1].key+1;s=void 0===s?{content:""}:s,i.push({key:a,...s}),t.setState({[e[0]]:n[1]})},this.removeByKey=e=>{const t=this.traverseAndCopyByKey(e.slice(0,-1));let s=t[t.length-1],n=-1;const i=e[e.length-1];for(let[a,r]of s.entries())r.key==i&&(n=a);n>=0&&s.splice(n,1),this.setState({[e[0]]:t[1]})},this.updateByKey=(e,t)=>{const s=this.traverseAndCopyByKey(e);let n=s[s.length-1];Object.assign(n,t),this.setState({[e[0]]:s[1]})},this._onChangeTime=e=>{e.preventDefault();const t=e.target.value;this.setState({recommendedPayment:Xt(t)})},this._onChangeTaskNo=e=>{e.preventDefault();const t=e.target.value;this.setState({noHits:Zt(t,this.state.nAssignment,Jt),nUnit:t})},this._onChangeAssignmentNo=e=>{e.preventDefault();const t=e.target.value;this.setState({noHits:Zt(this.state.nUnit,t,Jt),nAssignment:t})},this.state={url_dialog_system:[],generic_introduction:"",generic_instructions:"",name_of_dialog:[],speech:!1,interface:"both",deploy:!1,sys_index:0,survey_index:0,payment:"",time:"",consent:[],requirements:[],questionSurveys:[],questionFeedbacks:[],questionSystems:[],loading:!0},this.formItemLayout={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}},this.formItemLayoutWithOutLabel={wrapperCol:{xs:{span:24,offset:0},sm:{span:20,offset:4}}}}componentDidMount(){this.makeProps()}componentDidUpdate(e,t){this.props.session._id===e.session._id&&this.props.session.lastModifiedDate===e.session.lastModifiedDate||this.makeProps(),t.configRevision!==this.state.configRevision&&this.props.form.resetFields()}makeProps(){for(const e of["generic_instructions","payment","interface","time","consent","url_dialog_system","nUnit","nAssignment","generic_introduction","requirements","deploy","hasFeedbackQuestion","numofsent","enableMarkdown"])this.setState({[e]:this.props.session[e]});if(this.setState({style:this.props.session.style||{global:{spacing:0,background:"#FFFFFF"},tabTitle:{fontSize:14,color:"#000000"},background:{fontSize:18,color:"#000000"},instruction:{fontSize:18,color:"#282828"},example:{fontSize:14,color:"#282828"},context:{fontSize:14,color:"#282828"},response:{fontSize:14,color:"#282828"},question:{fontSize:14,color:"#282828"},answer:{fontSize:14,color:"#282828"},utterance:{fontSize:20,color:"#282828",textAlign:"center"},dialogInstruction:{fontSize:14,color:"#282828"}}}),void 0===this.props.session.questionSurveys){let e=_t(this.props.session.pollquestion||[],this.props.session.typeofpoll,this.props.session.radio,this.props.session.example,this.props.session.counterexample);this.setState({questionSurveys:e})}else this.setState({questionSurveys:Tt(this.props.session.questionSurveys)});if(void 0===this.props.session.questionFeedbacks){const e=this.props.session.feedback||[];let t=_t(e,this.props.session.feedbackType||e.map((e=>"Open ended")),this.props.session.feedbackradio||e.map((e=>[])));this.setState({questionFeedbacks:t})}else this.setState({questionFeedbacks:Tt(this.props.session.questionFeedbacks)});this.setState({requirements:Tt(this.props.session.requirements||[])}),this.setState({loading:!1,payment:this.props.session.payment,recommendedPayment:Xt(this.props.session.time)}),this.setState({noHits:Zt(this.props.session.nUnit,this.props.session.nAssignment,1)})}handlePdfInputChange(e,t){const[s,n]=t[0];let i=s.target.result;this.setState({consent:[n.name,i]})}handleSubmit(e){e.preventDefault(),this.props.form.validateFields(((e,t)=>{e?console.log(e):(t.consent=this.state.consent,this.submit(t,this.props.session._id))}))}handleDeploy(e){this.props.form.validateFields(((t,s)=>{t?e&&this.setState({deploy:!1}):(s.consent=this.state.consent,this.submit(s,this.props.session._id),this.setState({deploy:!0}))}))}handleUploadConfig(e,t){const[s,n]=t[0];try{let e=JSON.parse(s.target.result);this.setState({...e,configRevision:(this.state.configRevision||0)+1}),be.a.success("Success")}catch(i){be.a.error("Fail to load from file."),console.log(i)}}submit(e,t){let s=this;return fetch(I+this.saveURL+t,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){"success"===e.message?(be.a.success("Success"),s.props.new_project_data(s.taskName),s.props.loadData(s.props.session.createdAt,s.props.session.password,s.taskName)):be.a.success("Fail")}))}render(){throw"Not implemented!"}_showGeneralConfig(){const{getFieldDecorator:e}=this.props.form,{formItemLayout:t,formItemLayoutWithOutLabel:s}=this;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("h3",{style:{"padding-left":"1%"},children:"General Configuration"}),Object(V.jsx)("p",{}),Object(V.jsx)(Yt,{...t,label:Object(V.jsxs)("span",{children:["Load configuration from file \xa0",Object(V.jsx)(xe.a,{title:"Upload the configuration JSON file of a HIT. A JSON configuration file can be downloaded with the button at the end of this page.",children:Object(V.jsx)(ae.a,{})})]}),children:Object(V.jsx)(Ee.a,{as:"text",onChange:(e,t)=>this.handleUploadConfig(e,t),children:Object(V.jsxs)(ye.a,{children:[Object(V.jsx)(fe.a,{})," Click to Upload"]})})}),Object(V.jsx)(Yt,{...t,label:Object(V.jsxs)("span",{children:["Background\xa0",Object(V.jsx)(xe.a,{title:"General introductions, the objective of this study, etc.",children:Object(V.jsx)(ae.a,{})})]}),required:!0,children:e("generic_introduction",{initialValue:this.state.generic_introduction,validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please write background"}]})(Object(V.jsx)(Ce.a.TextArea,{placeholder:"The objective of this study is ...",style:{width:"90%",marginRight:8}}))}),Object(V.jsxs)("p",{style:{"padding-left":"25%"},children:["This ",Object(V.jsx)("a",{href:"https://mturkpublic.s3.amazonaws.com/docs/MTURK_BP.pdf",children:"guide "}),"provides helpful tips in creating clear, concise instructions for the workers."]}),Object(V.jsx)(Yt,{...t,label:Object(V.jsxs)("span",{children:["General Instructions\xa0",Object(V.jsx)(xe.a,{title:Object(V.jsxs)("div",{children:[Object(V.jsx)("div",{children:"Overall steps, what to label, etc."}),Object(V.jsx)("div",{children:"Instructions should be specific, easy to read, and address any specific actions workers should do when completing your HIT."}),Object(V.jsx)("div",{children:"Stating any evaluation criteria that you are looking for in each HIT may also prevent the need for HIT rejections and attract workers who will complete the HIT accordingly."})]}),children:Object(V.jsx)(ae.a,{})})]}),required:!0,children:e("generic_instructions",{initialValue:this.state.generic_instructions,validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please write instructions"}]})(Object(V.jsx)(Ce.a.TextArea,{placeholder:"Please talk to the systems.",style:{width:"90%",marginRight:8}}))}),Object(V.jsx)(Yt,{...t,label:Object(V.jsxs)("span",{children:["Enable Markdown (",Object(V.jsx)("a",{href:"https://commonmark.org/help/",children:"reference"}),") \xa0",Object(V.jsx)(xe.a,{title:"If Markdown is enabled, the background description  and the instruction will be rendered as Markdown.Markdown is a lightweight text formating language. You can format a span of text in italic face or bold face and add hyperlinks as well as images with simple syntax. Bullet points are also supported. Please check the reference for more information.",children:Object(V.jsx)(ae.a,{})})]}),children:e("enableMarkdown",{initialValue:this.state.enableMarkdown||!1,valuePropName:"checked",onChange:e=>{this.setState({enableMarkdown:e})}})(Object(V.jsx)(Fe.a,{}))}),Object(V.jsx)(Yt,{...t,label:Object(V.jsxs)("span",{children:["Time (minutes/HIT) \xa0",Object(V.jsx)(xe.a,{title:"Fill out the amount of time you expect the HIT to take in minutes",children:Object(V.jsx)(ae.a,{})})]}),required:!0,children:e("time",{initialValue:this.state.time,validateTrigger:["onChange","onBlur"],onChange:this._onChangeTime,rules:[{required:!0,whitespace:!0,message:"Please fill out time in minutes"}]})(Object(V.jsx)(Ce.a.TextArea,{placeholder:"20 (in minutes)",style:{width:"90%",marginRight:8}}))}),Object(V.jsx)("p",{style:{"padding-left":"25%","padding-right":"8%"},children:"To estimate the time required for a HIT, you can ask your colleagues to do some HITs, then average the time they spend."}),Object(V.jsx)(Yt,{...t,label:Object(V.jsxs)("span",{children:["Payment (USD/HIT) \xa0",Object(V.jsx)(xe.a,{title:"Fill out the amount you will pay for the HIT",children:Object(V.jsx)(ae.a,{})})]}),required:!0,children:e("payment",{initialValue:this.state.payment,onChange:e=>{e.preventDefault(),this.setState({payment:parseFloat(e.target.value)})},validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please fill out payment"}]})(Object(V.jsx)(Ce.a.TextArea,{placeholder:"$8.00",style:{width:"90%",marginRight:8}}))}),void 0===this.state.recommendedPayment||!isNaN(this.state.payment)&&""!==this.state.payment?null:Object(V.jsxs)("p",{style:{"margin-left":"25%",color:"black","font-weight":"bolder"},children:["The recommended minimum payment is ",Object(V.jsxs)("b",{children:[this.state.recommendedPayment,"."]})]}),void 0!==this.state.recommendedPayment&&parseFloat(this.state.payment)<parseFloat(this.state.recommendedPayment)?Object(V.jsxs)("p",{style:{"margin-left":"25%",color:"darkorange","font-weight":"bolder"},children:[Object(V.jsxs)("b",{children:["The recommended minimum payment is ",Object(V.jsx)("u",{children:this.state.recommendedPayment}),". "]})," ",Object(V.jsx)("br",{}),"The workers need a living wage $15/hr to meet their basic needs."]}):null,"interactive"===this.taskName?Object(V.jsx)(Yt,{label:"Interface",...t,children:e("interface",{initialValue:this.state.interface})(Object(V.jsxs)(Me.default.Group,{children:[Object(V.jsx)(Me.default.Button,{value:"text",children:"Text"}),Object(V.jsx)(Me.default.Button,{value:"speech",children:"Speech"}),Object(V.jsx)(Me.default.Button,{value:"both",children:"Both text and speech"}),Object(V.jsx)(Me.default.Button,{value:"continuous",children:"Continuous speech"})]}))}):null]})}_showAnnotationConfig(e,t){const{getFieldDecorator:s}=this.props.form,{formItemLayout:n,formItemLayoutWithOutLabel:i}=this,{helpTextNAnnotation:a}=this.constructor;return Jt=t,Object(V.jsx)(V.Fragment,{children:Object(V.jsxs)("div",{style:{"padding-left":"1%"},children:[Object(V.jsx)(Yt,{...n,label:Object(V.jsxs)("span",{children:["# of ",e,"/HIT \xa0",Object(V.jsx)(xe.a,{title:"Specify the number of ".concat(e,"(s) the ")+"worker needs to annotate in each HIT. For example, if 5 is specified, then the worker "+"will need to annotation 5 ".concat(e,"s before they ")+"can submit the annotations.",children:Object(V.jsx)(ae.a,{})})]}),required:!0,children:s("nUnit",{initialValue:this.state.nUnit,onChange:this._onChangeTaskNo,validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please specify the number of ".concat(e,"(s) in each HIT.")}]})(Object(V.jsx)(Ce.a.TextArea,{placeholder:"5",style:{width:"90%",marginRight:8}}))}),Object(V.jsx)(Yt,{...n,label:Object(V.jsxs)("span",{children:["# of annotations/",e," \xa0",Object(V.jsx)(xe.a,{title:"Please specify the number of workers you want a ".concat(e," to be annotated by. ")+"For example, if 5 is specified, each ".concat(e," will be shown to 5 different workers, ")+"and so each ".concat(e," will be annotated 5 times."),children:Object(V.jsx)(ae.a,{})})]}),required:!0,children:s("nAssignment",{initialValue:this.state.nAssignment,onChange:this._onChangeAssignmentNo,validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please specify the number of annotations per ${textTask}."}]})(Object(V.jsx)(Ce.a.TextArea,{placeholder:"5",style:{width:"90%",marginRight:8}}))}),void 0!==this.state.noHits?Object(V.jsx)("div",{style:{"margin-left":"25%",color:"darkorange"},children:Object(V.jsxs)("span",{children:["You should deploy a total of ",this.state.noHits," HITs on Amazon Mechanical Turk."]})}):null]})})}_showQualityControlConfig(e){const{getFieldDecorator:t}=this.props.form,{formItemLayout:s,formItemLayoutWithOutLabel:n}=this;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("h3",{style:{"padding-left":"1%"},children:"Task Units for Quality Control"}),Object(V.jsxs)("p",{style:{"padding-left":"1%"},children:["In this section, you can configure whether or not you want to include some task units in each HIT for quality control. Theses task units can help you dectect bots or low-quality workers. Two types of task units are available for quality control:",Object(V.jsxs)("ul",{children:[Object(V.jsx)("li",{children:"Duplicated task units: These are used to compare the worker to themself. If you decide to use duplicated task units, the specified number of randomly selected task units in the HIT will be duplicated. That is to say, the worker will have to annotate some of the task units twice. A responsible worker should provide the same annotation for the duplicated question as before. By checking the consistency of their answers, bots and low-quality workers can be detected."}),Object(V.jsx)("li",{children:'Golden task units: These are used to compare the worker to an "expert" whose answers are confirmed as correct. If you decide to use golden task units and upload some data with golden answers, the specified number of randomly selected task units in the golden data will be given to the workers in each HIT. With these golden task units, DialCrowd can compare the annotations of a worker and the golden answers. Workers of low-quality, who usually answer incorrectly, can be detected accordingly.'})]}),Object(V.jsx)("b",{children:"The number of task units for quality control is recommended to be 10% of the number of task units in a HIT."})]}),Object(V.jsxs)("div",{style:{border:"2px solid black",margin:"10px",padding:24},children:[Object(V.jsx)(Yt,{...s,label:Object(V.jsxs)("span",{children:["# of duplicated task units \xa0",Object(V.jsx)(xe.a,{title:"Specify the number of duplicated ".concat(e,"(s) the ")+"to be included in each HIT. These duplicated task units can be used to detect annotators of low quality. When the number of duplicated tasks is greater than 0, in each HIT, randomly selected task units will be duplicated. With those duplicated task units, the DialCrowd system can automatically check whether a worker answered them consistently. A bad worker may be detected if the worker simply answered the questions randomly and annotated the duplicated questions with different answers.",children:Object(V.jsx)(ae.a,{})})]}),required:!0,children:t("nUnitDuplicated",{initialValue:"".concat(this.state.nUnitDuplicated||0),validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please specify the number of duplicated ".concat(e,"(s) in each HIT.")}]})(Object(V.jsx)(Re.a,{style:{width:"90%",marginRight:8}}))}),Object(V.jsx)(Yt,{...s,label:Object(V.jsxs)("span",{children:["# of golden task units \xa0",Object(V.jsx)(xe.a,{title:"Specify the number of golden task units to be included in each HIT. A golden task unit is a unit with golden answer that you know is correct. These golden task units can be used to detect annotators of low quality. Specifically, with those golden task units, DialCrowd can automatically check whether a worker answered them correctly by comparing their annotation with the golden answer. A bad worker may be detected if the worker simply answered the questions randomly and annotated golden task units incorrectly.",children:Object(V.jsx)(ae.a,{})})]}),required:!0,children:t("nUnitGolden",{initialValue:"".concat(this.state.nUnitGolden||0),validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please specify the number of ".concat(e,"(s) in each HIT.")}]})(Object(V.jsx)(Re.a,{placeholder:"0",style:{width:"90%",marginRight:8},defaultValue:this.state.nUnitGolden||0}))}),this._showDataUpload(!0)]})]})}_showConsentConfig(){const{getFieldDecorator:e}=this.props.form,{formItemLayout:t,formItemLayoutWithOutLabel:s}=this;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("h3",{style:{"padding-left":"1%"},children:"Consent Form"}),Object(V.jsx)("p",{style:{"padding-left":"1%"},children:"You can have a consent form and some checkboxes that the workers must agree with before they can start working. For example, you may want to inform the workers of their rights, or possible risks when doing the task. When a worker opens the web page of the task, this consent form will be shown in a pop-up window. The workers must agree with it to proceed."}),Object(V.jsxs)("div",{style:{border:"2px solid black",margin:"10px",padding:24},children:[Object(V.jsxs)(Yt,{...t,label:Object(V.jsxs)("span",{children:["Consent form \xa0",Object(V.jsx)(xe.a,{title:"Upload the consent form you want to show to the workers.",children:Object(V.jsx)(ae.a,{})})]}),children:[Object(V.jsx)(Ee.a,{as:"url",onChange:(e,t)=>this.handlePdfInputChange(e,t),children:Object(V.jsxs)(ye.a,{style:{width:"90%"},children:[Object(V.jsx)(fe.a,{})," Click to Upload"]})}),this.state.consent&&this.state.consent.length>0?Object(V.jsx)("span",{children:this.state.consent[0]}):null]}),Object(V.jsx)(Yt,{...s,children:this.state.consent&&this.state.consent.length>0?Object(V.jsx)(Ft,{consent:this.state.consent[1]}):Object(V.jsx)(Ft,{consent:"hi"})}),Object(V.jsx)(At,{form:this.props.form,formItemLayout:t,removeByKey:this.removeByKey,addByKey:this.addByKey,updateByKey:this.updateByKey,rootKeys:["requirements"],items:this.state.requirements,title:"Consent Checkboxes",textHelp:'A checkbox a workers must agree with before working on the task, e.g. "I am over 18 years old." It can also be a statement, e.g. "I understand my answer will be published."',textAdd:"Add consent checkbox",placeholder:"I am over 18 years old."}),Object(V.jsx)(kt,{consent:this.state.consent&&this.state.consent[1]||"",requirements:this.state.requirements})]})]})}_showSurveyConfig(){const{getFieldDecorator:e}=this.props.form,{formItemLayout:t,formItemLayoutWithOutLabel:s}=this,{instructionSurvey:n,helpTextSurveyQuestion:i}=this.constructor;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("h3",{style:{"padding-left":"1%"},children:"General Questions"}),Object(V.jsx)("p",{style:{"padding-left":"1%"},children:n}),Object(V.jsx)(Pt,{form:this.props.form,formItemLayout:t,removeByKey:this.removeByKey,addByKey:this.addByKey,updateByKey:this.updateByKey,questions:this.state.questionSurveys,rootKey:["questionSurveys"],questionFieldLabel:"Question",questionHelpText:i,textAddQuestion:"Add ",textInstruction:n,placeholderQuestion:"Can you identify the difference between the systems?",placeholderExample:"Yes, system A reacts like a real human most.",placeholderCounterexample:"I want the system to be more sociable.",placeholderOption:"Yes, somewhat."})]})}_showFeedbackConfig(){const{getFieldDecorator:e}=this.props.form,{formItemLayout:t,formItemLayoutWithOutLabel:s}=this;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("h3",{style:{"padding-left":"1%"},children:"Feedback"}),Object(V.jsxs)("p",{style:{"padding-left":"1%"},children:["You can decide whether or not you want the optional feedback question of",Object(V.jsx)("span",{style:{"font-weight":"800"},children:' "Please let us know if you have any feedback." '}),"This question will be shown after the worker finishes the task. Feedback can be very important in improving the quality of your task. Although not all workers will give you feedback, usually you can get some useful feedback that will help you improve your task, so you can collect data of higher quality."]}),Object(V.jsx)("div",{style:{border:"2px solid black",margin:"10px",padding:24},children:Object(V.jsx)(Yt,{...t,label:Object(V.jsxs)("span",{children:["Have a Feedback Question \xa0",Object(V.jsx)(xe.a,{title:"Set whether you want to have an optional feedback question.",children:Object(V.jsx)(ae.a,{})})]}),children:e("hasFeedbackQuestion",{initialValue:this.state.hasFeedbackQuestion,valuePropName:"checked"})(Object(V.jsx)(Fe.a,{}))})})]})}_showAppearanceConfig(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const{getFieldDecorator:t}=this.props.form,{formItemLayout:s,formItemLayoutWithOutLabel:n}=this,i=this.state.style||{global:{}},a=[{name:"Title",fieldName:"tabTitle",explain:"Set the titles styles of the tabs in the worker's view"},{name:"Background",fieldName:"background",explain:"Set the text style for the background description part."},{name:"Instruction",fieldName:"instruction",explain:"Set the text style for the instruction part."},{name:"Examples",fieldName:"example",explain:"Set the style of the text in the example/counterexample table in the worker's view."}].concat(e);return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("h3",{style:{"padding-left":"1%"},children:"Appearance"}),Object(V.jsx)("p",{style:{"padding-left":"1%"}}),Object(V.jsxs)("div",{style:{border:"2px solid black",margin:"10px",padding:24},children:[Object(V.jsx)(Yt,{...s,label:Object(V.jsxs)("span",{children:["Background Color \xa0",Object(V.jsx)(xe.a,{title:"Set the background color that workers see.",children:Object(V.jsx)(ae.a,{})})]}),children:Object(V.jsx)(Bt,{form:this.props.form,name:"['style']['global']['backgroundColor']",initialValue:i.global.backgroundColor||"#FFFFFF"})}),a.map((e=>Object(V.jsx)(Yt,{...s,label:Object(V.jsxs)("span",{children:["Text Style - ",e.name," \xa0",Object(V.jsx)(xe.a,{title:e.explain,children:Object(V.jsx)(ae.a,{})})]}),children:Object(V.jsx)(Vt,{form:this.props.form,keys:["style",e.fieldName],previewText:"Preview Text",updateByKey:this.updateByKey,...i[e.fieldName]||{}})}))),Object(V.jsx)(Yt,{...s,label:Object(V.jsxs)("span",{children:["Spacing Adjustment \xa0",Object(V.jsx)(xe.a,{title:"Adjust the space between elements in the worker's view. If you want a denser view, you can give a minus value. Be aware that lines may overlap with each other when the spacing is too small.",children:Object(V.jsx)(ae.a,{})})]}),children:t("['style']['global']['spacing']",{initialValue:"".concat(i.global.spacing||0),validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please specify adjustment."}]})(Object(V.jsx)(Re.a,{placeholder:"0",style:{width:"10%",marginRight:8},defaultValue:i.global.spacing||0}))})]})]})}_showButtons(){const{getFieldDecorator:e}=this.props.form,{formItemLayout:t,formItemLayoutWithOutLabel:s}=this;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("br",{}),Object(V.jsx)("div",{style:{"text-align":"center","padding-left":"60px"},children:Object(V.jsx)("span",{children:"Please save before you preview/download"})}),Object(V.jsxs)(Yt,{...s,children:[Object(V.jsx)(ye.a,{type:"primary",style:{width:"90%"},htmlType:"submit",children:"Save"}),Object(V.jsx)(ye.a,{onClick:()=>window.open(S+"/worker_interactive?MID=dialcrowd&ID="+this.props.session._id),type:"primary",style:{width:"90%"},icon:"EyeOutlined",children:"Preview"}),Object(V.jsx)("br",{}),Object(V.jsx)(ye.a,{type:"primary",style:{width:"90%"},onClick:()=>this._saveAsJSON(),children:"Download the Configuration as JSON"}),Object(V.jsx)("div",{style:{"padding-top":"5px"},children:this._showTemplate()})]})]})}_showTemplate(){throw"Not implemented!"}_saveAsJSON(){let e={};const t=["consent","generic_instructions","generic_introduction","hasFeedbackQuestion","interface","payment","requirements","time","questionSurveys","questionSystems","category_data","sequence_data","quality_data","dataGolden","nAssignment","numofsent","nUnit","nUnitDuplicated","nUnitGolden","payment","questionCategories","questionEntities","questionQualities","style"];for(const n of t)void 0!==this.state[n]&&(e[n]=this.state[n]);var s=new Blob([JSON.stringify(e,null,2)],{type:"text/plain;charset=utf-8"});Object(Mt.saveAs)(s,"".concat(this.props.session.name,".json"))}_showVisibility(){const{getFieldDecorator:e}=this.props.form,{formItemLayout:t}=this;return Object(V.jsx)(V.Fragment,{children:Object(V.jsx)("div",{style:{"padding-left":"35%"},children:Object(V.jsx)(Yt,{...t,label:Object(V.jsxs)("span",{children:["Visible to Workers \xa0",Object(V.jsx)(xe.a,{title:'Set the visibility of this task in the list of public DialCrowd HITs ("Worker" in the navigation menu).',children:Object(V.jsx)(ae.a,{})})]}),children:e("deploy",{initialValue:this.state.deploy,valuePropName:"checked",onChange:e=>{this.handleDeploy(e)}})(Object(V.jsx)(Fe.a,{}))})})})}}function Xt(e){return e=parseFloat(e),isNaN(e)?void 0:(15*e/60).toFixed(2)}function Zt(e,t,s){return isNaN(e)||isNaN(t)||isNaN(s)?void 0:s*t/e}$t.instructionSurvey="",$t.helpTextSurveyQuestion="";var es=$t;class ts extends i.a.Component{constructor(e){super(e),this.addSystem=()=>{this.props.addByKey([this.props.fieldNameSystem],this.constructor.newSystem())}}render(){return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("div",{children:this.props.systems.map((e=>this._showSystem(e)))}),Object(V.jsx)(je.a.Item,{wrapperCol:{xs:{span:24,offset:0},sm:{span:20,offset:4}},children:Object(V.jsxs)(ye.a,{type:"dashed",onClick:this.addSystem,style:{width:"90%"},children:[Object(V.jsx)(Be.a,{})," Add System"]})})]})}static newSystem(){return{name:"",agent:"",instruction:"",questions:[{key:0,...Pt.newQuestion()}]}}_showSystem(e){const{formItemLayout:t,fieldNameSystem:s}=this.props,{getFieldDecorator:n}=this.props.form;return Object(V.jsxs)("div",{style:{border:"2px solid black",margin:"10px",padding:24,display:"block"},children:[Object(V.jsx)("span",{style:{float:"left","margin-bottom":"-30px"},class:"instruction-tooltip",children:Object(V.jsxs)(xe.a,{title:this.props.textInstruction,children:[Object(V.jsx)(ae.a,{})," \xa0 Tips"]})}),Object(V.jsx)(je.a.Item,{children:Object(V.jsx)("span",{style:{float:"right","margin-bottom":"-30px","margin-top":"-20px","margin-right":"-10px"},children:this.props.systems.length>1?Object(V.jsx)(He.a,{className:"dynamic-delete-button",disabled:1===this.props.systems.length,onClick:()=>this.props.removeByKey([s,e.key])}):null})}),Object(V.jsx)(je.a.Item,{...t,label:Object(V.jsxs)("span",{children:["System Display Name \xa0",Object(V.jsx)(xe.a,{title:"Please write the name of your dialog system. DO NOT write 'Baseline' or 'Proposed System'.  This name will be shown to workers (e.g., System A)",children:Object(V.jsx)(ae.a,{})})]}),required:!0,children:n("".concat(s,"[").concat(e.key,"][name]"),{initialValue:e.name,validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please input the name of the dialog system to show to workers."}],onChange:t=>{this.props.updateByKey([s,e.key],{name:t.target.value})}})(Object(V.jsx)(Ce.a,{placeholder:"System A",style:{width:"90%",marginRight:8}}))}),Object(V.jsx)(je.a.Item,{...t,label:"System",hasFeedback:!0,children:n("".concat(s,"[").concat(e.key,"][agent]"),{initialValue:e.agent,rules:[{required:!0,message:"Please select an agent!"}]})(Object(V.jsx)(Ue.a,{placeholder:"Please choose your system",children:this.props.agents.map(((e,t)=>Object(V.jsxs)(Ue.a.Option,{value:e._id,children:[" ",e.name," "]},t)))}))}),Object(V.jsx)(je.a.Item,{...t,label:Object(V.jsxs)("span",{children:["Specific Instructions\xa0",Object(V.jsx)(xe.a,{title:"Please note any instructions for interacting with the system (e.g., 'please interact with the system for more than 10 turns', 'please ask about the weather tomorrow in Pittsburgh', etc)",children:Object(V.jsx)(ae.a,{})})]}),required:!1,children:n("".concat(s,"[").concat(e.key,"][instruction]"),{initialValue:e.instruction,validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please write instructions for interacting with the system"}]})(Object(V.jsx)(Ce.a,{placeholder:"Please talk about weather and more than 10 turns! ",style:{width:"90%",marginRight:8}}))}),Object(V.jsx)(Ne.a,{}),Object(V.jsx)(Pt,{form:this.props.form,formItemLayout:t,removeByKey:this.props.removeByKey,addByKey:this.props.addByKey,updateByKey:this.props.updateByKey,questions:e.questions,rootKey:[s,e.key,"questions"],questionFieldLabel:"Question",questionHelpText:"Ask questions about this system. For example, you can ask the worker to assess the quality of this system.",textAddQuestion:"Add a System Specific Question",textInstruction:this.props.helpText,placeholderQuestion:"Do you think it is a good system?",placeholderExample:"Yes, it was always on topic.",placeholderCounterexample:"I want to get paid more.",placeholderOption:"Input your option here.",listStyle:"divider"})]},e.key)}}var ss=ts;const ns=je.a.Item;class is extends es{handleFileInputChange(e,t,s){const[n,i]=t[0];for(var a=[],r=n.target.result.split("\n"),o=0;o<r.length;o++)if(""!=r[o]){var c={};c.sentence=r[o],c.sentid=o+1,c.entity=[],a.push(c)}a.length>0&&be.a.success(a.length+" tasks are loaded!"),this.setState({[s]:a})}constructor(e){super(e),this.handleSubmit=e=>{e.preventDefault(),this.props.form.validateFields(((e,t)=>{e?console.log(e):(t.interactive_task_data=this.state.interactive_task_data,t.consent=this.state.consent,this.submit(t,this.props.session._id))}))},this.state={...this.state,interactive_task_data:[]},this.saveURL="/api/save/task/interactive/",this.taskName="interactive"}componentDidMount(){this.makeProps()}makeProps(){if(void 0===this.props.session.questionSystems){let e=function(e,t,s,n,i,a){const r=e=>e.filter((e=>null!==e)).map(((e,t)=>({key:t,content:e})));let o=[];for(let c=0;c<e.length;c+=1){let l=Array.isArray(i[c])?i[c]:[i[c]],d=Array.isArray(i[c])?a[c]:[a[c]];o.push({key:c,name:e[c],instruction:t[c],questions:[{key:0,title:s[c],type:n[c],examples:r(l),counterexamples:r(d)}]})}return o}(this.props.session.name_of_dialog||[],this.props.session.generic_instructions,this.props.session.subpoll,this.props.session.subtypeofpoll,this.props.session.dialog_examples,this.props.session.dialog_counterexamples);this.setState({questionSystems:e})}else this.setState({questionSystems:Tt(this.props.session.questionSystems)});this.setState({interactive_task_data:this.props.session.interactive_task_data}),super.makeProps()}render(){return Object(V.jsxs)("div",{children:[Object(V.jsx)("h2",{style:{"padding-left":"1%"},children:"Template for an Interactive Task"}),Object(V.jsx)("p",{style:{"padding-left":"1%"},children:"This template is used for the creation of tasks that require the workers to interact with an agent. You can have one or more agents for the workers to interact, and ask questions about those agents."}),this.loading?Object(V.jsx)(me.a,{}):Object(V.jsxs)(je.a,{onSubmit:e=>{this.handleSubmit(e)},children:[this._showGeneralConfig(),this._showDataConfig(),this._showConsentConfig(),this._showSystemConfig(),this._showSurveyConfig(),this._showFeedbackConfig(),this._showAppearanceConfig([{name:"Specific Instructions",fieldName:"dialogInstruction",explain:"Set the text style of specific instructions for each dialogue system."},{name:"Questions",fieldName:"question",explain:"Set the style of the text in each question."}]),this._showButtons()]})]})}_showDataConfig(){const{formItemLayout:e}=this;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("h3",{style:{"padding-left":"1%"},children:"Task"}),Object(V.jsx)("p",{style:{"padding-left":"1%"},children:"The Tasks you want the workers to follow."}),Object(V.jsx)("div",{style:{border:"2px solid black",margin:"10px",padding:24},children:this._showDataUpload(!1)})]})}_showDataUpload(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{formItemLayout:t,formItemLayoutWithOutLabel:s}=this;let n=[{title:"ID",dataIndex:"sentid",key:"sendid",width:100},{title:"Text",dataIndex:"sentence",key:"sentence"}];e&&n.push({title:"Answer",dataIndex:"answer",key:"answer"});const i=e?Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("div",{children:"Please format your data as below, separated with new lines:"}),Object(V.jsx)("div",{children:'"taskID":1, "tasks":["Cons": "area=south"]'}),Object(V.jsx)("div",{children:"..."})]}):"Please split the tasks by new line.",a=e?"dataGolden":"interactive_task_data";return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ns,{...t,label:Object(V.jsxs)("span",{children:["Upload your data\xa0",Object(V.jsx)(xe.a,{title:i,children:Object(V.jsx)(ae.a,{})})]}),children:Object(V.jsx)(Ee.a,{as:"text",onChange:(e,t)=>this.handleFileInputChange(e,t,a),children:Object(V.jsxs)(ye.a,{style:{width:"90%"},children:[Object(V.jsx)(fe.a,{})," Click to Upload"]})})}),(this.state[a]||[]).length>0?Object(V.jsx)("div",{height:500,children:Object(V.jsx)(ge.a,{rowKey:"sentence",dataSource:this.state[a],columns:n,pagination:{hideOnSinglePage:!0},size:"small"})}):null]})}_showSurveyConfig(){const{getFieldDecorator:e}=this.props.form,{formItemLayout:t,formItemLayoutWithOutLabel:s}=this,{instructionSurvey:n,helpTextSurveyQuestion:i}=this.constructor;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("h3",{style:{"padding-left":"1%"},children:"General Questions"}),Object(V.jsx)("p",{style:{"padding-left":"1%"},children:n}),Object(V.jsx)(qt,{form:this.props.form,formItemLayout:t,removeByKey:this.removeByKey,addByKey:this.addByKey,updateByKey:this.updateByKey,questions:this.state.questionSurveys,rootKey:["questionSurveys"],systemNames:this.state.questionSystems.map((e=>e.name)),questionFieldLabel:"Question",questionHelpText:i,textAddQuestion:"Add ",textInstruction:n,placeholderQuestion:"Can you identify the difference between the systems?",placeholderExample:"Yes, system A reacts like a real human most.",placeholderCounterexample:"I want the system to be more sociable.",placeholderOption:"Yes, somewhat."})]})}_showSystemConfig(){const{getFieldDecorator:e}=this.props.form,{formItemLayout:t,formItemLayoutWithOutLabel:s}=this,n="In this section, you can add, remove and edit the interactive agents you want the workers interact with. For each system, you can set up one or more questions specific to the system. For example, you can ask the worker to assess the quality of a system. To make your task as clear as possible, remember to provide some example answers and counter example answers to the questions. These examples and counterexamples are important to let workers understand what responses are acceptable and what the limitations are.";return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("h3",{style:{"padding-left":"1%"},children:"Interactive Agents"}),Object(V.jsxs)("p",{style:{"padding-left":"1%"},children:[" ",n," "]}),Object(V.jsx)(ss,{form:this.props.form,formItemLayout:t,removeByKey:this.removeByKey,addByKey:this.addByKey,updateByKey:this.updateByKey,fieldNameSystem:"questionSystems",systems:this.state.questionSystems,agents:this.props.agents,helpText:n})]})}_showTemplate(){return Object(V.jsx)(Ae,{thisstate:this.props.session})}}is.instructionSurvey="In this section, you can add, remove and edit questions regarding the above systems. Different from the questions in the previous section, questions here are not specific to a certain system. For example, you can ask the worker to compare the above systems they have interacted with.",is.helpTextSurveyQuestion="Add a question that is to be answered after the worker talks to all of your interactive agents. You can, for example, ask the worker to comparethe agents they have interacted with.";const as={loadData:Oe,new_project_data:ke};var rs=Object(o.b)((function(e){return{session:e.session_interactive,agents:e.system}}),as)(je.a.create()(is)),os=s(557),cs=s(299);class ls extends i.a.Component{constructor(e){super(e),this.viewdialog=e=>{this.setState({messages:e}),this.setState({visible:!0})},this.handleOk=e=>{console.log(e),this.setState({visible:!1})},this.handleCancel=e=>{console.log(e),this.setState({visible:!1})},this.state={visible:!1,system_survey:[],overall_survey:[],dialog:[]}}componentDidMount(){var e;this.props.getResult("interactive",this.props.session._id),e=this,fetch(I+"/api/get/result/interactive/"+e.props.session._id+"/flyingbroom").then((function(e){return e.json()})).then((function(t){let s={},n={},i=[],a=[];t.survey.forEach((function(e,t){e.survey.forEach((function(t,r){"EXIT"===t.Name?(t.Q in n?n[t.Q].push({userId:e.userID,answer:t.A}):n[t.Q]=[{userId:e.userID,answer:t.A}],t.Type.indexOf("Likert")>=0&&a.push(t.Q)):"FEEDBACK"!==t.Name&&(t.Q in s?s[t.Q].push({userId:e.userID,answer:t.A,system:t.Name}):s[t.Q]=[{userId:e.userID,answer:t.A,system:t.Name}],t.Type.indexOf("Likert")>=0&&i.push(t.Q))}))}));let r=[],o=[];Object.keys(n).forEach((function(e){let t="";a.includes(e)&&(t=0,n[e].forEach((function(e,s){t+=e.answer})),t/=n[e].length),o.push({survey_question:e,detail:n[e],num:n[e].length,rating:t})})),Object.keys(s).forEach((function(e){let t="";i.includes(e)&&(t=0,s[e].forEach((function(e,s){t+=e.answer})),t/=s[e].length),r.push({survey_question:e,detail:s[e],num:s[e].length,rating:t})}));let c=[],l={};t.dialog.forEach((function(e,t){let s=[];e.dialog.forEach((function(e,t){"START"!==e.utter&&("Bot"===e.role&&s.push(new cs.Message({id:1,message:e.utter})),"You"===e.role&&s.push(new cs.Message({id:0,message:e.utter})))})),e.name_of_dialog in l?l[e.name_of_dialog].push({userID:e.userID,dialog:s}):l[e.name_of_dialog]=[{userID:e.userID,dialog:s}]})),Object.keys(l).forEach((function(e){c.push({name_of_dialog:e,num:l[e].length,detail:l[e]})})),e.setState({system_survey:r,overall_survey:o,dialog:c})}))}render(){const e=[{title:"user id",dataIndex:"userId",key:"userId"},{title:"answer",dataIndex:"answer",key:"answer"},{title:"system",dataIndex:"system",key:"system"}],t=[{title:"user id",dataIndex:"userId",key:"userId"},{title:"answer",dataIndex:"answer",key:"answer"}],s=[{title:"submissionID",dataIndex:"userID",key:"userID"},{title:"View",dataIndex:"operation",key:"operation",render:(e,t)=>Object(V.jsx)("span",{className:"table-operation",children:Object(V.jsxs)("span",{children:[Object(V.jsxs)("a",{onClick:()=>this.viewdialog(t.dialog),children:[Object(V.jsx)(re.a,{}),"\xa0 View Dialogs"]}),Object(V.jsx)("span",{className:"ant-divider"})]})})}];let n={system_survey:this.state.system_survey,overall_survey:this.state.overall_survey};return Object(V.jsxs)("div",{children:[Object(V.jsx)(Ke.a,{title:"Dialog View",visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel,children:Object(V.jsx)(cs.ChatFeed,{messages:this.state.messages,hasInputField:!1,showSenderName:!0,bubblesCentered:!1,bubbleStyles:{text:{fontSize:20},chatbubble:{borderRadius:35,padding:20}}})}),Object(V.jsxs)(ye.a,{onClick:()=>{var e=new Blob([JSON.stringify(this.props.dialog,null,2)],{type:"text/plain;charset=utf-8"});Object(Mt.saveAs)(e,"dialog.json")},children:[Object(V.jsx)(os.a,{})," Download dialog"]}),Object(V.jsxs)(ye.a,{onClick:()=>{var e=new Blob([JSON.stringify(n,null,2)],{type:"text/plain;charset=utf-8"});Object(Mt.saveAs)(e,"interactive_survey.json")},children:[Object(V.jsx)(os.a,{})," Download Survey"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Results"}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Dialog"}),Object(V.jsx)(ge.a,{rowKey:"userId",dataSource:this.state.dialog,columns:[{title:"Name of Bot",dataIndex:"name_of_dialog",key:"name_of_dialog"},{title:"submissions",dataIndex:"num",key:"num"}],size:"small",expandedRowRender:e=>Object(V.jsx)(ge.a,{dataSource:e.detail,columns:s})}),Object(V.jsx)("h1",{children:"System Survey "}),Object(V.jsx)(ge.a,{rowKey:"userId",dataSource:this.state.system_survey,columns:[{title:"survey question",dataIndex:"survey_question",key:"survey_question"},{title:"submissions",dataIndex:"num",key:"num"},{title:"average rating",dataIndex:"rating",key:"rating"}],size:"small",expandedRowRender:t=>Object(V.jsx)(ge.a,{dataSource:t.detail,columns:e})}),Object(V.jsx)("h1",{children:"Overall Survey "}),Object(V.jsx)(ge.a,{rowKey:"userId",dataSource:this.state.overall_survey,columns:[{title:"survey question",dataIndex:"survey_question",key:"survey_question"},{title:"submissions",dataIndex:"num",key:"num"},{title:"average rating",dataIndex:"rating",key:"rating"}],size:"small",expandedRowRender:e=>Object(V.jsx)(ge.a,{dataSource:e.detail,columns:t})})]})}}const ds={getResult:ve,deleteResult:we};var hs=Object(o.b)((function(e){return{dialog:e.result.dialog,survey:e.result.survey,session:e.session_interactive}}),ds)(ls);var us=s(36),ps=s(1256),js=s(69),bs=s(558),ms=s(559);class xs extends n.Component{constructor(e){super(e),this.state={questions:[],agreements:[]}}componentDidMount(){this.getResults(),this.getStatistics(),setInterval((()=>this.getStatistics()),5e3),setInterval((()=>this.getResults()),5e3)}getStatistics(){fetch(this.props.url).then((e=>e.json())).then((e=>{this.setState({questions:this.props.questions||e[this.props.propertyNameQuestions].map((e=>e.title)),agreements:e.dataAgreements||[],task:e})}))}getResults(){fetch(this.props.urlResult).then((e=>e.json())).then((e=>{this.setState({result:e})}))}makeDataSource(){if(void 0===this.state.task)return;let e={},t=[];if(this.state.agreements){for(const t in this.state.agreements[0])e[t]=(this.state.agreements.map((e=>e[t])).reduce(((e,t)=>e+t),0)/this.state.agreements.length).toFixed(3);t=this.state.agreements.map(((e,t)=>{let s={};for(const[n,i]of Object.entries(e))s[n]=null===i?"-":i.toFixed(3);return{question:this.state.questions[t],units:this.makeSubDataSource(t),...s}})),t.length>1&&t.push({...e,question:Object(V.jsx)("b",{children:"Average"})})}return t}makeSubDataSource(e){if(void 0===this.state.task||void 0===this.state.result)return;let t={};for(const n of this.state.task.units)t[n.id]=n;let s=[];for(const[n,i]of Object.entries(this.state.result.unit)){if(void 0===t[n])continue;let a={...i.agreements[e]};for(const e in a)null===a[e]?a[e]="-":a[e]=a[e].toFixed(2);let r={...a,...t[n]};s.push(r)}return s}render(){const{columns:e,subColumns:t}=this.constructor,s=this.makeDataSource(),n=void 0===t?void 0:e=>Object(V.jsx)(ge.a,{dataSource:e.units,columns:t,pagination:{hideOnSinglePage:!0}}),i=-1!=e.map((e=>e.title)).indexOf("Cohen's Kappa");return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ge.a,{dataSource:s,columns:e,expandedRowRender:n,expandIcon:e=>{let{expanded:t,onExpand:s,record:n}=e;return void 0!==n.units?t?Object(V.jsx)(bs.a,{onClick:e=>s(n,e)}):Object(V.jsx)(ms.a,{onClick:e=>s(n,e)}):void 0},pagination:{hideOnSinglePage:!0}}),Object(V.jsx)("br",{}),i?this.showCohensColorCode():null]})}showCohensColorCode(){return Object(V.jsx)(V.Fragment,{children:Object(V.jsxs)("div",{children:[" Cohen's Kappa indicates worker agreement of different levels:",Object(V.jsxs)("ul",{children:[Object(V.jsxs)("li",{children:[" ",Object(V.jsxs)("span",{style:{color:"#595959","font-weight":"bold"},children:[" ","< 0.00"," "]})," : Poor "]}),Object(V.jsxs)("li",{children:[" ",Object(V.jsx)("span",{style:{color:"#940004","font-weight":"bold"},children:" 0.00 - 0.20 "})," : Slight "]}),Object(V.jsxs)("li",{children:[" ",Object(V.jsx)("span",{style:{color:"#d15700","font-weight":"bold"},children:" 0.20 - 0.40 "})," : Fair "]}),Object(V.jsxs)("li",{children:[" ",Object(V.jsx)("span",{style:{color:"#e6b314","font-weight":"bold"},children:" 0.40 - 0.60 "})," : Moderate "]}),Object(V.jsxs)("li",{children:[" ",Object(V.jsx)("span",{style:{color:"#90ad00","font-weight":"bold"},children:" 0.60 - 0.80 "})," : Substantial "]}),Object(V.jsxs)("li",{children:[" ",Object(V.jsx)("span",{style:{color:"#00b31a","font-weight":"bold"},children:" 0.80 - 1.00 "})," : Almost Perfect "]})]})]})})}}function ys(e){let t;return t=(e=parseFloat(e))<0||isNaN(e)?"#595959":e<.2?"#940004":e<.4?"#d15700":e<.6?"#e6b314":e<.8?"#90ad00":"#00b31a",{props:{},children:Object(V.jsxs)("span",{style:{color:t,"font-weight":"bold"},children:[" ",e," "]})}}xs.columns=[{title:"Question",dataIndex:"question",key:"question"},{title:"Cohen's Kappa",dataIndex:"Cohen's Kappa",key:"Cohen's Kappa",render:ys}],xs.subColumns=[{title:"Response",dataIndex:"response",key:"response"},{title:"Cohen's Kappa",dataIndex:"Cohen's Kappa",key:"Cohen's Kappa"}];var gs=xs;class fs extends gs{constructor(e){super(e)}getResults(){}getStatistics(){fetch(this.props.url).then((e=>e.json())).then((e=>{this.setState({questions:e[this.props.propertyNameQuestions].map((e=>e.systemName?e.title+" (".concat(e.systemName,")"):e.title)),agreements:e.dataAgreements||[],task:e})}))}}fs.columns=[{title:"Question",dataIndex:"question",key:"question"},{title:"Cohen's Kappa",dataIndex:"Cohen's Kappa",key:"Cohen's Kappa",render:ys}],fs.subColumns=void 0;var Os=fs;s(252);let vs={};function ws(e){return fetch(e).then((e=>e.json())).then((e=>{let t={};for(const[n,i]of Object.entries(e.unit))for(const e of i.annotations){const s=e.submissionID;t[s]=t[s]||[],t[s].push(e)}let s={};for(const[n,i]of Object.entries(t)){let e={},t=i.map((e=>e.patternPeriod>0)).reduce(((e,t)=>e||t),!1);e.abnormal=t?"Yes":"No";for(const s of["agreeSelf","agreeGold"]){let t=i.map((e=>null!==e[s]?1:0)).reduce(((e,t)=>e+t),0),n=i.map((e=>!0===e[s]?1:0)).reduce(((e,t)=>e+t),0);e[s]=0===t?"-/-":"".concat(n," / ").concat(t)}for(const s of["agreeMajor"]){let t=i.map((e=>void 0!==e[s]?1:0)).reduce(((e,t)=>e+t),0),n=i.map((e=>e[s]||0)).reduce(((e,t)=>e+t),0);e[s]=0===t?"-/-":(n/t).toFixed(2)}s[n]=e}return s}))}function ks(e){let t=[];e.map(((e,s)=>{e.average_duration;let n=e.total_duration,i=e.userId;vs[n]=i,t.push(n)}));let s=function(e){return e.reduce((function(e,t){return Number(e)+Number(t)}))/e.length};if(t.length>0){let e=s(t),n=function(e){let t=s(e);return Math.sqrt(e.reduce((function(e,s){return e+Math.pow(s-t,2)}),0)/(e.length-1))}(t),i=(Math.sqrt(2*Math.PI),-.5),a=[];return isNaN(n)&&(n=1),t.sort((function(e,t){return e-t})),t.map(((t,s)=>{let r=(t-e)/n;r*=r,i*=r;let o=1/(Math.sqrt(2*Math.PI)*n)*Math.E**(-.5*((t-e)/n)**2);a.push({x:t,y:o})})),a}return[{x:1,y:11}]}function Is(e){fetch(I+"/api/get/detail_result/category/"+e.props.session._id).then((function(e){return e.json()})).then((function(t){let s=[];t.response.forEach((e=>{s.push(e.total_duration)}));ws(I+"/api/result/category/"+e.props.session._id).then((n=>{let i=t.response;var a;i=i.map((e=>({...e,...n[e.userId]}))),e.setState({results_detail:i,cost:15*(a=s,a.reduce(((e,t)=>e+t),0)/a.length)/3600})}))}))}function Ss(e){const{v:t,userId:s}=e;return{x:t.x,y:t.y,userId:s}}class Cs extends n.Component{constructor(e){super(e),this.handleDelete=e=>{const t=[...this.state.results_detail],s=[...this.state.results],n=[...this.state.feedback];n.forEach((function(t,s){let i=[];t.detail.forEach((function(t,s){t.userId!==parseInt(e)&&i.push(t)})),n[s].detail=i})),this.setState({results_detail:t.filter((t=>t.userId!==e))}),this.setState({results:s.filter((t=>t.userId!==e))}),this.setState({feedback:n.filter((t=>t.userId!==e))}),fetch(I+"/api/delete/result/category/"+e).then((function(e){return e.json()}))},this.state={results_detail:[],survey:[],results:[],grid:[],cost:0,visible_kappa:!1,feedback:[]}}updateWorkerQuality(){ws(I+"/api/result/category/"+this.props.session._id).then((e=>{let t=this.state.results_detail.slice();t=t.map((t=>({...t,...e[t.userId]}))),this.setState({results_detail:t})}))}componentDidMount(){Is(this),this.updateWorkerQuality(),setInterval((()=>{Is(this),this.updateWorkerQuality()}),2e3)}render(){const e=[{title:"Sentence",dataIndex:"sentence",key:"sentence"},{title:"label",dataIndex:"label",key:"label"},{title:"duration",dataIndex:"duration",key:"duration"},{title:"timestamp",dataIndex:"timestamp",key:"timestamp"}],t=[{title:"user id",dataIndex:"userId",key:"userId"},{title:"total",dataIndex:"total_duration",key:"total_duration"},{title:"average",dataIndex:"average_duration",key:"average_duration"},{title:"std",dataIndex:"std_duration",key:"std_duration"},{title:Object(V.jsxs)(V.Fragment,{children:["outlier",Object(V.jsx)(xe.a,{title:"Whether the time spent on the task is 2 standard deviations above or below the average time taken.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"outlier",key:"outlier"},{title:Object(V.jsxs)(V.Fragment,{children:["abnormal",Object(V.jsx)(xe.a,{title:"Whether some repeating pattern, like answering A, B, A, B ..., or A, A, A is detected.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"abnormal",key:"abnormal"},{title:Object(V.jsxs)(V.Fragment,{children:["intra-user",Object(V.jsx)(xe.a,{title:"The number of times the worker responded consistently/ the number of duplicated task units given in each HIT.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"agreeSelf",key:"agreeSelf"},{title:Object(V.jsxs)(V.Fragment,{children:["agree-gold",Object(V.jsx)(xe.a,{title:"The number of correctly answered golden task units / the number of golden task units given in each HIT.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"agreeGold",key:"agreeGold"},{title:Object(V.jsxs)(V.Fragment,{children:["inter-user",Object(V.jsx)(xe.a,{title:"The ratio of annotations that agree with the majority.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"agreeMajor",key:"agreeMajor"},{title:"submissions",dataIndex:"num",key:"num"},{title:"operation",dataIndex:"operation",render:(e,t)=>this.state.results_detail.length>1?Object(V.jsx)(ps.a,{title:"Sure to delete?",onConfirm:()=>this.handleDelete(t.userId),children:Object(V.jsx)("a",{href:"javascript:;",children:"Delete"})}):null}];return Object(V.jsxs)("div",{children:[Object(V.jsxs)("p",{children:["We calculate the worker's time according to how long they take in selecting the intent for each question. Abnormality is described as any worker who selects the same intent for every sentence and outlier is calculated by any worker who takes more than 2 standard deviations longer or shorter than the mean time taken for the task. These two metrics can be used to help determine if a worker may be a bot; however, we suggest that you pay the bot, block them from completing future HITs for you, and ",Object(V.jsx)("a",{href:"https://support.aws.amazon.com/#/contacts/aws-mechanical-turk",children:"report"}),' it to Amazon, which can also be done through "Report this HIT" on the MTurk interface. This is because rejecting the bot may hurt your requester reputation. Be sure to accept and reject your HITs in a timely manner and communicate with the workers if they have any questions. You can monitor your requester reputation on sites such as ',Object(V.jsx)("a",{href:"https://turkopticon.ucsd.edu/",children:"Turkopticon"}),"."]}),Object(V.jsx)("h1",{children:"Workers' Timestamps Logs"}),Object(V.jsx)(ge.a,{rowKey:"userId",dataSource:this.state.results_detail,columns:t,size:"small",expandedRowRender:t=>Object(V.jsx)(ge.a,{dataSource:t.detail,columns:e})}),Object(V.jsx)("h1",{children:"Agreement between Workers"}),Object(V.jsx)(gs,{url:I+"/api/task/category/"+this.props.session._id,questions:["Intent"]}),Object(V.jsx)("h1",{children:"Gaussian of Timestamps"}),Object(V.jsxs)(us.g,{width:300,height:300,children:[Object(V.jsx)(us.e,{}),Object(V.jsx)(us.c,{}),Object(V.jsx)(us.f,{}),Object(V.jsx)(us.h,{}),Object(V.jsx)(us.a,{text:"total time to select intents",className:"alt-x-label",includeMargin:!1,xPercent:.25,yPercent:1.01}),Object(V.jsx)(us.a,{text:"probability density",className:"alt-y-label",includeMargin:!1,xPercent:.06,yPercent:.06,style:{transform:"rotate(-90)",textAnchor:"end"}}),Object(V.jsx)(us.d,{className:"linemark-series-example-2",curve:"curveMonotoneX",data:ks(this.state.results_detail),onValueMouseOver:e=>this.setState({hoveredCell:!(!e.x||!e.y)&&{v:e,userId:vs[e.x]}})}),this.state.hoveredCell?Object(V.jsx)(us.b,{value:Ss(this.state.hoveredCell),children:Object(V.jsx)("div",{style:{color:"black"},children:Object(V.jsx)("b",{children:Object(V.jsxs)("strong",{children:[" ","userId: "+this.state.hoveredCell.userId]})})})}):null]})]})}}const _s={loadData:Oe,new_project_data:ke};var Ts=Object(o.b)((function(e){return{session:e.session_category}}),_s)(Cs);let Ds={},qs=function(e){return e.reduce((function(e,t){return Number(e)+Number(t)}))/e.length},As=function(e){let t=qs(e);return Math.sqrt(e.reduce((function(e,s){return e+Math.pow(s-t,2)}),0)/(e.length-1))};function Ps(e){fetch(I+"/api/get/result/interactive/"+e.props.session._id).then((function(e){return e.json()})).then((function(t){let s=[],n=[],i=[],a=0,r=[],o=[];if(t.survey.length>0){let e=[];t.survey.forEach((function(t,n){t.times.length>0&&(s.push({userId:t.userID,times:t.times}),r=[],o=[],t.survey.forEach((function(e,t){e.Type.includes("Likert")?r.push(e.A):e.Type.includes("Radio")&&o.push(e.A)})),r.length>1&&r.every(((e,t,s)=>e===s[0]))||o.length>1&&o.every(((e,t,s)=>e===s[0]))?e.push(!0):e.push(!1))})),s.forEach((function(e,t){let s=[],a=[];e.times.forEach((function(t,n){s.push({system:t.system,duration:t.time/1e3,userId:e.userId}),a.push(t.time/1e3)}));let r=a.reduce(((e,t)=>e+t),0);i.push(r),n.push({allsame:"no",userId:e.userId,total_duration:r,average_duration:qs(a),outlier:"no",std_duration:As(a),detail:s})}));let c=As(i),l=qs(i);n.forEach((function(t,s){(t.total_duration>l+2*c||t.total_duration<l-2*c)&&(n[s].outlier="yes"),e[s]&&(n[s].allsame="yes")})),a=15*qs(i)/3600}return ws(I+"/api/result/interactive/"+e.props.session._id+"/flyingbroom").then((i=>{t.response;n=n.map((e=>({...e,...i[e.userId]}))),e.setState({times:s,results_detail:n,cost:a})}))}))}function Es(e){let t=[];if(e.map(((e,s)=>{e.average_duration;let n=e.total_duration,i=e.userId;Ds[n]=i,t.push(n)})),t.length>0){let e=qs(t),s=As(t),n=(Math.sqrt(2*Math.PI),-.5),i=[];return isNaN(s)&&(s=1),t.sort((function(e,t){return e-t})),t.map(((t,a)=>{let r=(t-e)/s;r*=r,n*=r;let o=1/(Math.sqrt(2*Math.PI)*s)*Math.E**(-.5*((t-e)/s)**2);i.push({x:t,y:o})})),i}return[{x:1,y:11}]}function Fs(e){const{v:t,userId:s}=e;return{x:t.x,y:t.y,userId:s}}class Ms extends i.a.Component{constructor(e){super(e),this.handleDelete=e=>{const t=[...this.state.results_detail],s=[...this.state.system_survey],n=[...this.state.overall_survey],i=[...this.state.times],a=[...this.state.feedback];s.forEach((function(t,n){let i=[];t.detail.forEach((function(t,s){t.userId!==e&&i.push(t)})),s[n].detail=i})),n.forEach((function(t,s){let i=[];t.detail.forEach((function(t,s){t.userId!==e&&i.push(t)})),n[s].detail=i})),a.forEach((function(t,s){let n=[];t.detail.forEach((function(t,s){t.userId!==e&&n.push(t)})),a[s].detail=n})),this.setState({results_detail:t.filter((t=>t.userId!==e))}),this.setState({system_survey:s.filter((t=>t.userId!==e))}),this.setState({overall_survey:n.filter((t=>t.userId!==e))}),this.setState({times:i.filter((t=>t.userId!==e))}),this.setState({feedback:a.filter((t=>t.userId!==e))}),fetch(I+"/api/delete/result/interactive/"+e).then((function(e){return e.json()}))},this.handleOkSurvey=e=>{console.log(e),this.setState({visible_survey:!1})},this.handleCancelSurvey=e=>{console.log(e),this.setState({visible_survey:!1})},this.confirm=e=>{this.props.deleteResult("interactive",this.props.session._id,e._id),js.message.success("Delete Success")},this.cancel=e=>{console.log(e)},this.handleOk=e=>{console.log(e),this.setState({visible:!1})},this.handleCancel=e=>{console.log(e),this.setState({visible:!1})},this.state={results:[],visible:!1,visible_survey:!1,system_survey:[],overall_survey:[],feedback:[],times:[],results_detail:[]}}componentDidMount(){this.props.getResult("interactive",this.props.session._id),Ps(this),setInterval((()=>Ps(this)),5e3)}render(){const e=[{title:"system",dataIndex:"system",key:"system"},{title:"duration",dataIndex:"duration",key:"duration"}],t=[{title:"user id",dataIndex:"userId",key:"userId"},{title:"total",dataIndex:"total_duration",key:"total_duration"},{title:"average",dataIndex:"average_duration",key:"average_duration"},{title:"std",dataIndex:"std_duration",key:"std_duration"},{title:Object(V.jsxs)(V.Fragment,{children:["outlier",Object(V.jsx)(xe.a,{title:"Whether the time spent on the task is 2 standard deviations above or below the average time taken.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"outlier",key:"outlier"},{title:Object(V.jsxs)(V.Fragment,{children:["abnormal",Object(V.jsx)(xe.a,{title:"Whether some repeating pattern, like answering A, B, A, B ..., or A, A, A is detected.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"abnormal",key:"abnormal"},{title:Object(V.jsxs)(V.Fragment,{children:["inter-user",Object(V.jsx)(xe.a,{title:"The ratio of annotations that agree with the majority.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"agreeMajor",key:"agreeMajor"},{title:"operation",dataIndex:"operation",render:(e,t)=>this.state.results_detail.length>1?Object(V.jsx)(ps.a,{title:"Sure to delete?",onConfirm:()=>this.handleDelete(t.userId),children:Object(V.jsx)("a",{href:"javascript:;",children:"Delete"})}):null}];return Object(V.jsxs)("div",{children:[Object(V.jsxs)("p",{children:["We calculate the worker's time according to how long they interact with each system. Outlier is calculated by any worker who takes more than 2 standard deviations longer or shorter than the mean time taken for the task. This metric can be used to help determine if a worker may be a bot; however, we suggest that you pay the bot, block them from completing future HITs for you, and"," ",Object(V.jsx)("a",{href:"https://support.aws.amazon.com/#/contacts/aws-mechanical-turk",children:"report"})," ",'it to Amazon, which can also be done through "Report this HIT" on the MTurk interface. This is because rejecting the bot may hurt your requester reputation. Be sure to accept and reject your HITs in a timely manner and communicate with the workers if they have any questions. You can monitor your requester reputation on sites such as'," ",Object(V.jsx)("a",{href:"https://turkopticon.ucsd.edu/",children:"Turkopticon"}),"."]}),Object(V.jsx)("h1",{children:"Workers' Timestamps Logs"}),Object(V.jsx)(ge.a,{rowKey:"userId",dataSource:this.state.results_detail,columns:t,size:"small",expandedRowRender:t=>Object(V.jsx)(ge.a,{dataSource:t.detail,columns:e})}),Object(V.jsx)("h1",{children:"Agreements between Workers"}),Object(V.jsx)(Os,{url:I+"/api/task/interactive/"+this.props.session._id,propertyNameQuestions:"questions"}),Object(V.jsx)("h1",{children:"Gaussian of Timestamps"}),Object(V.jsxs)(us.g,{width:300,height:300,children:[Object(V.jsx)(us.e,{}),Object(V.jsx)(us.c,{}),Object(V.jsx)(us.f,{}),Object(V.jsx)(us.h,{}),Object(V.jsx)(us.a,{text:"total time interacted with system",className:"alt-x-label",includeMargin:!1,xPercent:.25,yPercent:1.01}),Object(V.jsx)(us.a,{text:"probability density",className:"alt-y-label",includeMargin:!1,xPercent:.06,yPercent:.06,style:{transform:"rotate(-90)",textAnchor:"end"}}),Object(V.jsx)(us.d,{className:"linemark-series-example-2",curve:"curveMonotoneX",data:Es(this.state.results_detail),onValueMouseOver:e=>this.setState({hoveredCell:!(!e.x||!e.y)&&{v:e,userId:Ds[e.x]}})}),this.state.hoveredCell?Object(V.jsx)(us.b,{value:Fs(this.state.hoveredCell),children:Object(V.jsx)("div",{style:{color:"black"},children:Object(V.jsx)("b",{children:Object(V.jsxs)("strong",{children:[" ","userId: "+this.state.hoveredCell.userId]})})})}):null]})]})}}const Rs={getResult:ve,deleteResult:we};var Ns=Object(o.b)((function(e){return{dialog:e.result.dialog,survey:e.result.survey,session:e.session_interactive}}),Rs)(Ms);let Bs=function(e){return e.reduce((function(e,t){return Number(e)+Number(t)}))/e.length};function Hs(e){fetch(I+"/api/get/result/interactive/"+e.props.session._id).then((function(e){return e.json()})).then((function(t){let s=[],n=[],i=0;if(t.survey.length>0){t.survey.forEach((function(e,t){e.times.length>0&&s.push({userId:e.userID,times:e.times})}));let e=[],a=[];s.forEach((function(t,s){let n=[];t.times.forEach((function(e,t){n.push(e.time/1e3)}));let i=n.reduce(((e,t)=>e+t),0);e.push(i),a[t.userId]=i}));let r=Bs(e);Object.keys(a).forEach((function(e){a[e]>r?n.push({submissionID:e,bonus:"$"+Number(Math.round(15*(a[e]-r)/3600+"e2")+"e-2").toString()}):n.push({submissionID:e,bonus:"$0.00"})})),i=15*Bs(e)/3600}e.setState({cost:i,bonus:n})}))}class Ls extends i.a.Component{constructor(e){super(e),this.state={cost:0}}componentDidMount(){this.props.getResult("interactive",this.props.session._id),Hs(this)}render(){Hs(this);return Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{children:"Recommend Reward per Assignment "}),Object(V.jsx)("p",{children:" = hourly wage ($15.00) * average time (sec) / (60 sec * 60 min)"}),Object(V.jsxs)("div",{style:{"text-align":"center","font-size":"30px"},children:["$",Math.round(100*this.state.cost)/100]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Suggested Bonuses"}),Object(V.jsx)(ge.a,{rowKey:"submissionID",dataSource:this.state.bonus,columns:[{title:"Submission ID",dataIndex:"submissionID",key:"submissionID"},{title:"Suggested Bonus",dataIndex:"bonus",key:"bonus"}],size:"small"})]})}}const Ks={getResult:ve,deleteResult:we};var Us=Object(o.b)((function(e){return{dialog:e.result.dialog,survey:e.result.survey,session:e.session_interactive}}),Ks)(Ls);function zs(e){fetch(I+"/api/result/interactive/"+e.props.session._id+"/flyingbroom").then((function(e){return e.json()})).then((function(t){let s=[];for(const e of t.unit[0].annotations)for(const t of e.survey)"FEEDBACK"===t.Name&&s.push({userID:e.userID,feedback:t.A});e.setState({feedbacks:s})}))}class Ws extends i.a.Component{constructor(e){super(e),this.state={feedbacks:[]}}componentDidMount(){this.props.getResult("interactive",this.props.session._id),zs(this),setInterval((()=>zs(this)),5e3)}render(){return Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{onClick:()=>{var e=new Blob([JSON.stringify(this.state.feedbacks,null,2)],{type:"text/plain;charset=utf-8"});Object(Mt.saveAs)(e,"interactive_feedback.json")},children:[Object(V.jsx)(os.a,{})," Download Feedback"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Feedback "}),Object(V.jsx)(ge.a,{rowKey:"userId",dataSource:this.state.feedbacks,columns:[{title:"user id",dataIndex:"userID",key:"userID"},{title:"feedback",dataIndex:"feedback",key:"feedback"}],size:"small"})]})}}const Qs={getResult:ve,deleteResult:we};var Gs=Object(o.b)((function(e){return{dialog:e.result.dialog,survey:e.result.survey,session:e.session_interactive}}),Qs)(Ws);const Vs=de.a.TabPane;class Ys extends i.a.Component{constructor(e){super(e),this.state={}}componentDidMount(){console.log("interactive open")}render(){return Object(V.jsx)("div",{children:Object(V.jsxs)(de.a,{defaultActiveKey:"1",children:[Object(V.jsx)(Vs,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(X.a,{}),"Configure"]}),children:"text"!==this.props.interactive?Object(V.jsx)(rs,{session:this.props.interactive}):null},"1"),Object(V.jsx)(Vs,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(he.a,{}),"Raw Results"]}),children:Object(V.jsx)(hs,{session:this.props.interactive})},"2"),Object(V.jsx)(Vs,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(ee.a,{}),"Feedback"]}),children:Object(V.jsx)(Gs,{session:this.props.interactive})},"5"),Object(V.jsx)(Vs,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(ue.a,{}),"Quality"]}),children:Object(V.jsx)(Ns,{session:this.props.interactive})},"3"),Object(V.jsx)(Vs,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(pe.a,{}),"Payment"]}),children:Object(V.jsx)(Us,{session:this.props.interactive})},"4")]})})}}const Js={newInteractive:function(e){return{type:"NEW_INTERACTIVE",interactive:e}}};var $s=Object(o.b)((function(e){return{interactive:e.session_interactive}}),Js)(Ys);s(268);const Xs=de.a.TabPane,Zs=je.a.Item;class en extends i.a.Component{constructor(e){super(e),this.showDrawer=()=>{this.setState({visible:!0})},this.onClose=()=>{this.setState({visible:!1})},this.generate=e=>{e.preventDefault(),this.props.form.validateFields(((e,t)=>{e||this.setState({username:t.username,showlink:!0})}))},this.state={visible:!1,username:"",showlink:!1}}componentDidMount(){}render(){const{getFieldDecorator:e}=this.props.form;return Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{type:"primary",style:{float:"left",width:"90%"},onClick:this.showDrawer,children:[Object(V.jsx)(_e.a,{}),"Amazon Mechanical Turk Template"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsxs)(Ie.a,{title:"Template",width:720,placement:"right",onClose:this.onClose,maskClosable:!0,visible:this.state.visible,style:{height:"calc(100% - 55px)",overflow:"auto",paddingBottom:53},children:[Object(V.jsx)(Se.a,{gutter:16,children:Object(V.jsx)("div",{children:Object(V.jsxs)(de.a,{defaultActiveKey:"preview",children:[Object(V.jsx)(Xs,{tab:Object(V.jsx)("span",{children:"Preview"}),children:Object(V.jsxs)("div",{children:[Object(V.jsxs)("div",{style:{"border-style":"solid"},children:[Object(V.jsx)("div",{style:{"text-align":"center"},children:Object(V.jsx)("p",{children:"Preview"})}),Object(V.jsxs)("p",{style:{"padding-left":"2%"},children:["Background: ",this.props.thisstate.generic_introduction," "]}),Object(V.jsxs)("p",{style:{"padding-left":"2%"},children:["Instructions: ",this.props.thisstate.generic_instructions," "]})]}),Object(V.jsx)("br",{}),Object(V.jsx)("p",{children:"Input a username and generate the HIT link"}),Object(V.jsx)(je.a,{onSubmit:this.generate,children:Object(V.jsxs)(Zs,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}},children:[e("username")(Object(V.jsx)(Ce.a.TextArea,{placeholder:"Username",style:{width:"60%",marginRight:8,float:"left"},autoSize:{minRows:1,maxRows:1}})),Object(V.jsx)(ye.a,{type:"primary",htmlType:"submit",style:{float:"left"},children:"Generate Link"})]})}),this.state.showlink?Object(V.jsxs)("p",{children:["Please go to ",S,"/worker_category?MID=",this.state.username,"ID=",this.props.thisstate._id," in a separate window to complete the HIT"]}):null,Object(V.jsx)("br",{}),Object(V.jsxs)("p",{children:["When you are done, input the confirmation code here: ",Object(V.jsx)("input",{type:"text",style:{border:"1px solid gray","padding-left":"5px"}})]})]})},"preview"),Object(V.jsxs)(Xs,{tab:Object(V.jsx)("span",{children:"Code"}),children:[Object(V.jsx)("pre",{children:Object(V.jsxs)("code",{children:["<style>",Object(V.jsx)("br",{}),Object(V.jsxs)("p",{style:{"margin-left":"20px"},children:["table, th, td ","{"]}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"border: 1px solid black;"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"}"}),Object(V.jsxs)("p",{style:{"margin-left":"20px"},children:["th, td ","{"]}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"padding: 15px;"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"}"}),"</style>",Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"\x3c!-- Unique turker script --\x3e ",Object(V.jsx)("br",{}),'<script src="//uniqueturker.myleott.com/lib.js" type="text/javascript"><\/script>',Object(V.jsx)("br",{}),"<script>",Object(V.jsx)("br",{}),"(function() ","{",Object(V.jsxs)("p",{style:{"margin-left":"20px"},children:['var ut_id = "e776c2408d15bc01e2f380e30759f24b";',Object(V.jsx)("br",{}),"if (UTWorkerLimitReached(ut_id)) ","{"]}),Object(V.jsxs)("p",{style:{"margin-left":"40px"},children:["document.getElementById('mturk_form').style.display = 'none';",Object(V.jsx)("br",{}),"document.getElementsByTagName('body')[0].innerHTML = \"You have already completed the maximum number of HITs allowed by this requester. Please click 'Return HIT' to avoid any impact on your approval rating.\";"]}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"}"}),"}",");",Object(V.jsx)("br",{}),"<\/script>",Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"\x3c!-- You must include this Javascript file --\x3e ",Object(V.jsx)("br",{}),'<script src="https://assets.crowd.aws/crowd-html-elements.js"><\/script> ',Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"\x3c!-- For the full list of available Crowd HTML Elements and their input/output documentation, please refer to https://docs.aws.amazon.com/sagemaker/latest/dg/sms-ui-template-reference.html --\x3e ",Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"\x3c!-- You must include crowd-form so that your task submits answers to MTurk --\x3e ",Object(V.jsx)("br",{}),'<crowd-form answer-format="flatten-objects"> ',Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"<div> ",Object(V.jsx)("br",{}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:'<div style="border-style: solid">'}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:'<div style="text-align: center">'}),Object(V.jsx)("p",{style:{"margin-left":"60px"},children:"<p>Preview</p>"}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"</div>"}),Object(V.jsxs)("p",{style:{"margin-left":"40px"},children:['<p style="padding-left: 2%">Background: ',this.props.thisstate.generic_introduction," </p>"]}),Object(V.jsxs)("p",{style:{"margin-left":"40px"},children:['<p style="padding-left: 2%">Instructions: ',this.props.thisstate.generic_instructions," </p>"]}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"</div>"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"<div>"}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"<p>Input a username and generate the HIT link</p>"}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:'<input id="workerid" type="text" name="username" placeholder="Username">'}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:'<button id="submit">Generate Link</button>'}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"</div>"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"<br>"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:'<div><span id="dialcrowd_link"> - </span></div>'}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:'<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"><\/script>'}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"<script>"}),Object(V.jsxs)("p",{style:{"margin-left":"40px"},children:["document.getElementById('submit').onclick = function(event) ","{"]}),Object(V.jsx)("p",{style:{"margin-left":"60px"},children:"event.preventDefault();"}),Object(V.jsxs)("p",{style:{"margin-left":"60px"},children:['document.getElementById("dialcrowd_link").textContent = "Please go to ',S,'/worker_category/?ID=5f0b6fe49878971ce8ab83c9&MID=" + document.getElementById("workerid").value + " in a separate window to complete the HIT"']}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"}"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"<\/script>"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:'<p>When you are done, input the confirmation code here: <input type="text" name="confirmation_code"></p>'}),"</div> ",Object(V.jsx)("br",{}),"</crowd-form> ",Object(V.jsx)("br",{})]})}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{})]},"code")]})})}),Object(V.jsx)("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"},children:Object(V.jsx)(ye.a,{style:{marginRight:8},onClick:this.onClose,children:"Close"})})]})]})}}var tn=je.a.create()(en);const sn=je.a.Item;class nn extends Pt{}nn.questionTypes=[];const an={loadData:Oe,new_project_data:ke};var rn=Object(o.b)((function(e){return{session:e.session_category}}),an)(je.a.create()(class extends es{handleFileInputChange(e,t,s){const[n,i]=t[0];let a=[],r=n.target.result.split("\n");if("category_data"===s)for(let o=0;o<r.length;o++){if(""===r[o])continue;let e={};e.sentence=r[o],e.sentid=o+1,e.category=[],a.push(e)}else for(let o=0;o<r.length;o+=2){if(""===r[o])continue;let e={};e.sentence=r[o],e.sentid=o+1,e.answer=r[o+1],a.push(e)}a.length>0&&be.a.success(a.length+" sentences are loaded!"),this.setState({[s]:a})}constructor(e){super(e),this.handleSubmit=e=>{e.preventDefault(),this.props.form.validateFields(((e,t)=>{e?console.log(e):(t.category_data=this.state.category_data,t.dataGolden=this.state.dataGolden,t.consent=this.state.consent,this.submit(t,this.props.session._id))}))},this.state={...this.state,results_detail:[],hoveredCell:!1,visible:!1,visible_survey:!1,taskid:"",generic_introduction:"",generic_instructions:"",category_data:[],results:[],visible_kappa:!1,questionCategories:[]},this.saveURL="/api/save/task/category/",this.taskName="category"}makeProps(){if(void 0===this.props.session.questionCategories){const e=this.props.session.classLabel||[];let t=_t(e,e.map((e=>"")),e.map((e=>[])),this.props.session.classExample,this.props.session.classCounterexample);this.setState({questionCategories:t})}else this.setState({questionCategories:Tt(this.props.session.questionCategories)});this.setState({category_data:this.props.session.category_data,dataGolden:this.props.session.dataGolden}),super.makeProps()}render(){return Object(V.jsxs)("div",{children:[Object(V.jsx)("h2",{style:{"padding-left":"1%"},children:"Template for an Intent Classification Task "}),Object(V.jsx)("p",{style:{"padding-left":"1%"},children:"This template is used for the creation of tasks that require the workers to label the intent of utterances."}),Object(V.jsxs)("form",{onSubmit:this.handleSubmit,children:[this._showGeneralConfig(),this._showAnnotationConfig("utterance"),this._showDataConfig(),this._showQualityControlConfig("utterance"),this._showConsentConfig(),this._showCategoryConfig(),this._showFeedbackConfig(),this._showAppearanceConfig([{name:"Utterance",fieldName:"utterance",explain:"Set the style of utterance to be annotated."}]),this._showButtons()]})]})}_showDataConfig(){const{getFieldDecorator:e}=this.props.form,{formItemLayout:t,formItemLayoutWithOutLabel:s}=this;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(sn,{...t,label:Object(V.jsxs)("span",{children:["Num of sentences per page\xa0",Object(V.jsx)(xe.a,{title:"Sentences per worker per task",children:Object(V.jsx)(ae.a,{})})]}),children:e("numofsent",{initialValue:this.state.numofsent})(Object(V.jsx)(Re.a,{min:1,max:100,style:{height:"100%"}}))}),this._showDataUpload()]})}_showDataUpload(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{formItemLayout:t,formItemLayoutWithOutLabel:s}=this;let n=[{title:"ID",dataIndex:"sentid",key:"sendid",width:100},{title:"Text",dataIndex:"sentence",key:"sentence"}];e&&n.push({title:"Answer",dataIndex:"answer",key:"answer"});const i=e?Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("div",{children:"Please format your data as below, separated with new lines:"}),Object(V.jsx)("div",{children:"Utterance 1. (Ex. I want to buy a ticket.)"}),Object(V.jsx)("div",{children:"Intent of utterance 1. (Ex. Purchase)"}),Object(V.jsx)("div",{children:"Utterance 2. (Ex. I want to buy a ticket.)"}),Object(V.jsx)("div",{children:"Intent of utterance 2. (Ex. Purchase)"}),Object(V.jsx)("div",{children:"..."})]}):"Please split the utterances by new line.",a=e?"dataGolden":"category_data";return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(sn,{...t,label:Object(V.jsxs)("span",{children:["Upload your data\xa0",Object(V.jsx)(xe.a,{title:i,children:Object(V.jsx)(ae.a,{})})]}),children:Object(V.jsx)(Ee.a,{as:"text",onChange:(e,t)=>this.handleFileInputChange(e,t,a),children:Object(V.jsxs)(ye.a,{style:{width:"90%"},children:[Object(V.jsx)(fe.a,{})," Click to Upload"]})})}),(this.state[a]||[]).length>0?Object(V.jsx)("div",{height:500,children:Object(V.jsx)(ge.a,{rowKey:"sentence",dataSource:this.state[a],columns:n,pagination:{hideOnSinglePage:!0},size:"small"})}):null]})}_showCategoryConfig(){const{getFieldDecorator:e}=this.props.form,{formItemLayout:t,formItemLayoutWithOutLabel:s}=this,n="In this section, you can set up the types of intents the worker can choose from. Remember to include examples and counterexamples. They help the worker get a better idea what should be labeled as what type of intent, so you can collect data of better quality.";return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("h3",{children:"Intent Type Configuration"}),Object(V.jsx)("p",{children:n}),Object(V.jsx)(nn,{form:this.props.form,formItemLayout:t,removeByKey:this.removeByKey,addByKey:this.addByKey,updateByKey:this.updateByKey,questions:this.state.questionCategories,rootKey:["questionCategories"],questionFieldLabel:"Intent type",questionHelpText:"Add an intent type that the worker can select.",textAddQuestion:"Add an Intent Type",textInstruction:n,placeholderQuestion:"order_food",placeholderExample:"I would like to order a pizza from Domino's.",placeholderCounterexample:"What's the temperature now?",noPreview:!0})]})}_showButtons(){const{getFieldDecorator:e}=this.props.form,{formItemLayout:t,formItemLayoutWithOutLabel:s}=this;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("div",{style:{"text-align":"center","padding-left":"10%"},children:Object(V.jsx)("span",{children:"Please save before you preview"})}),Object(V.jsxs)(sn,{...s,children:[Object(V.jsx)(ye.a,{type:"primary",style:{width:"90%"},htmlType:"submit",children:"Save"}),Object(V.jsx)(ye.a,{onClick:()=>window.open(S+"/worker_category?MID=unknown&ID="+this.props.session._id),type:"primary",style:{width:"90%"},children:"Preview"}),Object(V.jsx)("br",{}),Object(V.jsx)(ye.a,{type:"primary",style:{width:"90%"},onClick:()=>this._saveAsJSON(),children:"Save Configuration as JSON"}),Object(V.jsx)("div",{style:{"padding-top":"5px"},children:Object(V.jsx)(tn,{thisstate:this.props.session})})]})]})}}));function on(e){fetch(I+"/api/get/result/category/"+e.props.session._id).then((function(e){return e.json()})).then((function(t){var s={},n=[];t.response.forEach((function(e,t){e.sentid in s||(s[e.sentid]=e)}));var i=Object.keys(s);i.sort();for(var a=0;a<i.length;a++)s[i[a]].result.forEach((function(e,t){delete s[i[a]].result[t].feedback,delete s[i[a]].result[t].feedback_questions})),n.push(s[i[a]]);e.setState({results:n})}))}class cn extends n.Component{constructor(e){super(e),this.state={results:[]}}componentDidMount(){on(this)}render(){on(this);const e=[{title:"Intent",dataIndex:"category",key:"category"},{title:"Annotator",dataIndex:"annotator",key:"annotator"},{title:"Submission ID",dataIndex:"submissionID",key:"submissionID"}];return Object(V.jsx)("div",{children:Object(V.jsxs)("div",{title:"Your Data",height:500,children:[Object(V.jsxs)(ye.a,{onClick:()=>{var e=new Blob([JSON.stringify(this.state.results,null,2)],{type:"text/plain;charset=utf-8"});Object(Mt.saveAs)(e,"result.json")},children:[Object(V.jsx)(os.a,{}),"Download Submissions"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Results"}),Object(V.jsx)(ge.a,{rowKey:"sentid",dataSource:this.state.results,columns:[{title:"SentID",dataIndex:"sentid",key:"sendid",width:100},{title:"Text",dataIndex:"sentence",key:"sentence"},{title:"Num of Submissions",dataIndex:"num",key:"num"}],size:"small",expandedRowRender:t=>Object(V.jsx)(ge.a,{dataSource:t.result,columns:e,pagination:!1})})]})})}}const ln={loadData:Oe,new_project_data:ke};var dn=Object(o.b)((function(e){return{session:e.session_category}}),ln)(cn);function hn(e){fetch(I+"/api/get/detail_result/category/"+e.props.session._id).then((function(e){return e.json()})).then((function(t){let s=[],n=[],i=0;if(t.response.length>0){t.response.forEach((e=>{n.push(e.total_duration)}));let e=(a=n).reduce(((e,t)=>e+t),0)/a.length;t.response.forEach((t=>{t.total_duration>e?s.push({submissionID:t.userId,bonus:"$"+Number(Math.round(15*(t.total_duration-e)/3600+"e2")+"e-2").toString()}):s.push({submissionID:t.userId,bonus:"$0.00"})})),i=15*e/3600}var a;e.setState({cost:i,bonus:s})}))}class un extends n.Component{constructor(e){super(e),this.state={feedback:[]}}componentDidMount(){hn(this)}render(){hn(this);return Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{children:"Recommend Reward per Assignment "}),Object(V.jsx)("p",{children:" = hourly wage ($15.00) * average time (sec) / (60 sec * 60 min)"}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsxs)("div",{style:{"text-align":"center","font-size":"30px"},children:["$",Math.round(100*this.state.cost)/100]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Suggested Bonuses"}),Object(V.jsx)(ge.a,{rowKey:"submissionID",dataSource:this.state.bonus,columns:[{title:"Submission ID",dataIndex:"submissionID",key:"submissionID"},{title:"Suggested Bonus",dataIndex:"bonus",key:"bonus"}],size:"small"})]})}}const pn={loadData:Oe,new_project_data:ke};var jn=Object(o.b)((function(e){return{session:e.session_category}}),pn)(un);function bn(e){fetch(I+"/api/get/result/category/"+e.props.session._id).then((function(e){return e.json()})).then((function(t){let s={};for(const e of t.response)for(const t of e.result)null!==t.feedback&&(s[t.submissionID]=t.feedback);let n=[];for(const[e,i]of Object.entries(s))n.push({userId:e,feedback:i});e.setState({feedbacks:n})}))}class mn extends n.Component{constructor(e){super(e),this.state={feedback:[]}}componentDidMount(){bn(this)}render(){bn(this);return Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{onClick:()=>{var e=new Blob([JSON.stringify(this.state.feedbacks,null,2)],{type:"text/plain;charset=utf-8"});Object(Mt.saveAs)(e,"category_feedback.json")},children:[Object(V.jsx)(os.a,{})," Download Feedback"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Feedback "}),Object(V.jsx)(ge.a,{rowKey:"userId",dataSource:this.state.feedbacks,columns:[{title:"user id",dataIndex:"userId",key:"userId"},{title:"feedback",dataIndex:"feedback",key:"feedback"}],size:"small"})]})}}const xn={loadData:Oe,new_project_data:ke};var yn=Object(o.b)((function(e){return{session:e.session_category}}),xn)(mn);const gn=de.a.TabPane;class fn extends i.a.Component{constructor(e){super(e),this.state={}}componentDidMount(){console.log("Category open")}render(){return Object(V.jsx)("div",{children:Object(V.jsxs)(de.a,{defaultActiveKey:"1",children:[Object(V.jsx)(gn,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(X.a,{}),"Configure"]}),children:this.props.session.hasOwnProperty("classLabel")?Object(V.jsx)(rn,{data:this.props.session}):null},"1"),Object(V.jsx)(gn,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(he.a,{}),"Raw Results"]}),children:Object(V.jsx)(dn,{data:this.props.session})},"2"),Object(V.jsx)(gn,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(ee.a,{}),"Feedback"]}),children:Object(V.jsx)(yn,{data:this.props.session})},"5"),Object(V.jsx)(gn,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(ue.a,{}),"Quality"]}),children:Object(V.jsx)(Ts,{data:this.props.session})},"3"),Object(V.jsx)(gn,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(pe.a,{}),"Payment"]}),children:Object(V.jsx)(jn,{data:this.props.session})},"4")]})})}}var On=Object(o.b)((function(e){return{session:e.session_category}}),{})(fn);const vn=de.a.TabPane,wn=je.a.Item;class kn extends i.a.Component{constructor(e){super(e),this.showDrawer=()=>{this.setState({visible:!0})},this.onClose=()=>{this.setState({visible:!1})},this.generate=e=>{e.preventDefault(),this.props.form.validateFields(((e,t)=>{e||this.setState({username:t.username,showlink:!0})}))},this.state={visible:!1,username:"",showlink:!1}}componentDidMount(){}render(){const{getFieldDecorator:e}=this.props.form;return Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{type:"primary",style:{float:"left",width:"90%"},onClick:this.showDrawer,children:[Object(V.jsx)(_e.a,{}),"Amazon Mechanical Turk Template"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsxs)(Ie.a,{title:"Template",width:720,placement:"right",onClose:this.onClose,maskClosable:!0,visible:this.state.visible,style:{height:"calc(100% - 55px)",overflow:"auto",paddingBottom:53},children:[Object(V.jsx)(Se.a,{gutter:16,children:Object(V.jsx)("div",{children:Object(V.jsxs)(de.a,{defaultActiveKey:"preview",children:[Object(V.jsx)(vn,{tab:Object(V.jsx)("span",{children:"Preview"}),children:Object(V.jsxs)("div",{children:[Object(V.jsxs)("div",{style:{"border-style":"solid"},children:[Object(V.jsx)("div",{style:{"text-align":"center"},children:Object(V.jsx)("p",{children:"Preview"})}),Object(V.jsxs)("p",{style:{"padding-left":"2%"},children:["Background: ",this.props.thisstate.generic_introduction," "]}),Object(V.jsxs)("p",{style:{"padding-left":"2%"},children:["Instructions: ",this.props.thisstate.generic_instructions," "]})]}),Object(V.jsx)("br",{}),Object(V.jsx)("p",{children:"Input a username and generate the HIT link"}),Object(V.jsx)(je.a,{onSubmit:this.generate,children:Object(V.jsxs)(wn,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}},children:[e("username")(Object(V.jsx)(Ce.a.TextArea,{placeholder:"Username",style:{width:"60%",marginRight:8,float:"left"},autoSize:{minRows:1,maxRows:1}})),Object(V.jsx)(ye.a,{type:"primary",htmlType:"submit",style:{float:"left"},children:"Generate Link"})]})}),this.state.showlink?Object(V.jsxs)("p",{children:["Please go to ",S,"/worker_sequence?MID=",this.state.username,"&ID=",this.props.thisstate._id," in a separate window to complete the HIT"]}):null,Object(V.jsx)("br",{}),Object(V.jsxs)("p",{children:["When you are done, input the confirmation code here: ",Object(V.jsx)("input",{type:"text",style:{border:"1px solid gray","padding-left":"5px"}})]})]})},"preview"),Object(V.jsxs)(vn,{tab:Object(V.jsx)("span",{children:"Code"}),children:[Object(V.jsx)("pre",{children:Object(V.jsxs)("code",{children:["<style>",Object(V.jsx)("br",{}),Object(V.jsxs)("p",{style:{"margin-left":"20px"},children:["table, th, td ","{"]}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"border: 1px solid black;"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"}"}),Object(V.jsxs)("p",{style:{"margin-left":"20px"},children:["th, td ","{"]}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"padding: 15px;"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"}"}),"</style>",Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"\x3c!-- Unique turker script --\x3e ",Object(V.jsx)("br",{}),'<script src="//uniqueturker.myleott.com/lib.js" type="text/javascript"><\/script>',Object(V.jsx)("br",{}),"<script>",Object(V.jsx)("br",{}),"(function() ","{",Object(V.jsxs)("p",{style:{"margin-left":"20px"},children:['var ut_id = "e776c2408d15bc01e2f380e30759f24b";',Object(V.jsx)("br",{}),"if (UTWorkerLimitReached(ut_id)) ","{"]}),Object(V.jsxs)("p",{style:{"margin-left":"40px"},children:["document.getElementById('mturk_form').style.display = 'none';",Object(V.jsx)("br",{}),"document.getElementsByTagName('body')[0].innerHTML = \"You have already completed the maximum number of HITs allowed by this requester. Please click 'Return HIT' to avoid any impact on your approval rating.\";"]}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"}"}),"}",");",Object(V.jsx)("br",{}),"<\/script>",Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"\x3c!-- You must include this Javascript file --\x3e ",Object(V.jsx)("br",{}),'<script src="https://assets.crowd.aws/crowd-html-elements.js"><\/script> ',Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"\x3c!-- For the full list of available Crowd HTML Elements and their input/output documentation, please refer to https://docs.aws.amazon.com/sagemaker/latest/dg/sms-ui-template-reference.html --\x3e ",Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"\x3c!-- You must include crowd-form so that your task submits answers to MTurk --\x3e ",Object(V.jsx)("br",{}),'<crowd-form answer-format="flatten-objects"> ',Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"<div> ",Object(V.jsx)("br",{}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:'<div style="border-style: solid">'}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:'<div style="text-align: center">'}),Object(V.jsx)("p",{style:{"margin-left":"60px"},children:"<p>Preview</p>"}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"</div>"}),Object(V.jsxs)("p",{style:{"margin-left":"40px"},children:['<p style="padding-left: 2%">Background: ',this.props.thisstate.generic_introduction," </p>"]}),Object(V.jsxs)("p",{style:{"margin-left":"40px"},children:['<p style="padding-left: 2%">Instructions: ',this.props.thisstate.generic_instructions," </p>"]}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"</div>"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"<div>"}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"<p>Input a username and generate the HIT link</p>"}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:'<input id="workerid" type="text" name="username" placeholder="Username">'}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:'<button id="submit">Generate Link</button>'}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"</div>"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"<br>"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:'<div><span id="dialcrowd_link"> - </span></div>'}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:'<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"><\/script>'}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"<script>"}),Object(V.jsxs)("p",{style:{"margin-left":"40px"},children:["document.getElementById('submit').onclick = function(event) ","{"]}),Object(V.jsx)("p",{style:{"margin-left":"60px"},children:"event.preventDefault();"}),Object(V.jsxs)("p",{style:{"margin-left":"60px"},children:['document.getElementById("dialcrowd_link").textContent = "Please go to ',S,'/worker_sequence/?ID=5f0b6fe49878971ce8ab83c9&MID=" + document.getElementById("workerid").value + " in a separate window to complete the HIT"']}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"}"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"<\/script>"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:'<p>When you are done, input the confirmation code here: <input type="text" name="confirmation_code"></p>'}),"</div> ",Object(V.jsx)("br",{}),"</crowd-form> ",Object(V.jsx)("br",{})]})}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{})]},"code")]})})}),Object(V.jsx)("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"},children:Object(V.jsx)(ye.a,{style:{marginRight:8},onClick:this.onClose,children:"Close"})})]})]})}}var In=je.a.create()(kn);const Sn=je.a.Item;class Cn extends Pt{render(){return Object(V.jsx)(V.Fragment,{children:super.render()})}}Cn.questionTypes=[];const _n={getResult:ve,new_project_data:ke,loadData:Oe};var Tn=Object(o.b)((function(e){return{session:e.session_sequence,result:e.result}}),_n)(je.a.create()(class extends es{handleFileInputChange(e,t,s){if("dataGolden"!==s){const[e,s]=t[0];for(var n=[],i=e.target.result.split("\n"),a=0;a<i.length;a++)if(""!=i[a]){var r={};r.sentence=i[a],r.sentid=a+1,r.entity=[],n.push(r)}n.length>0&&js.message.success(n.length+" sentences are loaded!"),this.setState({sequence_data:n})}else{const[e,s]=t[0];let n=e.target.result.split("\n"),i=[];for(a=0;a<n.length/2;a+=1){if(""==n[2*a])continue;const e=n[2*a];let t=[];for(const s of n[2*a+1].split(";")){if(""===s)continue;const e=s.split(":")[0],[n,i]=s.split(":")[1].split(",");t.push({start:parseInt(n),end:parseInt(i),entity:e})}i.push({sentid:a,sentence:e,answer:t})}this.setState({dataGolden:i})}}constructor(e){super(e),this.handleSubmit=e=>{e.preventDefault(),this.props.form.validateFields(((e,t)=>{e?console.log(e):(t.sequence_data=this.state.sequence_data,t.dataGolden=this.state.dataGolden,t.consent=this.state.consent,this.submit(t,this.props.session._id))}))},this.state={...this.state,sequence_data:[],survey:[],numofhit:10,numoflabel:3,results:[],questionEntities:[]},this.saveURL="/api/save/task/sequence/",this.taskName="sequence"}makeProps(){if(void 0===this.props.session.questionEntities){const e=this.props.session.Label||[];let t=_t(e,e.map((e=>"")),e.map((e=>[])),this.props.session.Example,this.props.session.Counterexample);this.setState({questionEntities:t})}else this.setState({questionEntities:Tt(this.props.session.questionEntities)});this.setState({sequence_data:this.props.session.sequence_data,dataGolden:this.props.session.dataGolden}),super.makeProps()}render(){return Object(V.jsxs)("div",{children:[Object(V.jsx)("h2",{style:{"padding-left":"1%"},children:"Template for an Entity Labeling Task "}),Object(V.jsx)("p",{style:{"padding-left":"1%"},children:"This template is used for the creation of tasks that require the workers to annotate the entities present in an utterance."}),Object(V.jsxs)("form",{onSubmit:this.handleSubmit,children:[this._showGeneralConfig(),this._showAnnotationConfig("sentence"),this._showDataUpload(),this._showQualityControlConfig("sentence"),this._showConsentConfig(),this._showEntityConfig(),this._showFeedbackConfig(),this._showAppearanceConfig([{name:"Utterance",fieldName:"utterance",explain:"Set the style of utterance to be annotated."},{name:"Answer",fieldName:"answer",explain:"Set the text style in workers' answer field."}]),this._showButtons()]})]})}_showEntityConfig(){const{getFieldDecorator:e}=this.props.form,{formItemLayout:t,formItemLayoutWithOutLabel:s}=this,n="In this section, you can set up the types of entities the worker can choose from. Remember to include examples and counterexamples. They help the worker get a better idea what should be labeled as what type of entity, so you can collect data of better quality.";return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("h3",{children:"Entity Types Configuration"}),Object(V.jsx)("p",{children:n}),Object(V.jsx)(Cn,{form:this.props.form,formItemLayout:t,removeByKey:this.removeByKey,addByKey:this.addByKey,updateByKey:this.updateByKey,questions:this.state.questionEntities,rootKey:["questionEntities"],questionFieldLabel:"Entity type",questionHelpText:"Add an entity type that the worker may choose from.",textAddQuestion:"Add an Entity Type",textInstruction:n,placeholderQuestion:"Food",placeholderExample:"Pizza",placeholderCounterexample:"Car",noPreview:!0})]})}_showDataUpload(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{getFieldDecorator:t}=this.props.form,{formItemLayout:s,formItemLayoutWithOutLabel:n}=this;let i=[{title:"ID",dataIndex:"sentid",key:"sendid",width:100},{title:"Text",dataIndex:"sentence",key:"sentence"}];e&&i.push({title:"Answer",dataIndex:"answer",key:"answer",render:e=>e.map((e=>"".concat(e.entity,":").concat(e.start,",").concat(e.end,";"))).join("")});const a=e?Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("div",{children:"Please format your data as below, separated with new lines:"}),Object(V.jsx)("div",{children:"Sentence 1 (Ex. I want to have some thai food at cheap price.)"}),Object(V.jsx)("div",{children:"Starta and end positions of the entities in sentence 1, with format entity_type1:start_pos,end_pos;entity_type2:start_pos,end_pos; (Ex. food_type:20,24;price_range:33:38;)"}),Object(V.jsx)("div",{children:"Sentence 2 (Ex. I want to have some thai food at cheap price.)"}),Object(V.jsx)("div",{children:"Starta and end positions of the entities in sentence 2, with format entity_type1:start_pos,end_pos;entity_type2:start_pos,end_pos;(Ex. food_type:20,24;price_range:33:38;)"})]}):"Sentences should be split by new line. Please check the file format below",r=e?"dataGolden":"sequence_data";return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(Sn,{...s,label:Object(V.jsxs)("span",{children:[e?"Upload your golden data":"Upload your data"," \xa0",Object(V.jsx)(xe.a,{title:a,children:Object(V.jsx)(ae.a,{})})]}),children:Object(V.jsx)(Ee.a,{as:"text",onChange:(e,t)=>this.handleFileInputChange(e,t,r),children:Object(V.jsxs)(ye.a,{style:{width:"90%"},children:[Object(V.jsx)(fe.a,{})," Click to Upload"]})})}),(this.state[r]||[]).length>0?Object(V.jsx)("div",{title:"Your Data",height:500,children:Object(V.jsx)(ge.a,{rowKey:"sentence",dataSource:this.state[r],columns:i,pagination:{hideOnSinglePage:!0},size:"small"})}):null]})}_showButtons(){const{getFieldDecorator:e}=this.props.form,{formItemLayout:t,formItemLayoutWithOutLabel:s}=this;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("div",{style:{"text-align":"center","padding-left":"60px"},children:Object(V.jsx)("span",{children:"Please save before you preview"})}),Object(V.jsxs)(Sn,{...s,children:[Object(V.jsx)(ye.a,{type:"primary",style:{width:"90%"},htmlType:"submit",children:"Save"}),Object(V.jsx)(ye.a,{onClick:()=>window.open(S+"/worker_sequence?MID=unknown&ID="+this.props.session._id),type:"primary",style:{width:"90%"},children:"Preview"}),Object(V.jsx)("br",{}),Object(V.jsx)(ye.a,{type:"primary",style:{width:"90%"},onClick:()=>this._saveAsJSON(),children:"Save Configuration as JSON"}),Object(V.jsx)("div",{style:{"padding-top":"5px"},children:Object(V.jsx)(In,{thisstate:this.props.session})})]})]})}}));class Dn extends n.Component{constructor(e){super(e),this.state={results_detail:[],results:[]}}componentDidMount(){var e;e=this,fetch(I+"/api/get/result/sequence/"+e.props.session._id).then((function(e){return e.json()})).then((function(t){console.log("json",t);let s=[],n=[],i=[],a={},r={},o=[];t.response.forEach((function(e,t){i=[];let s=e.sentence;e.meta.forEach((function(t,c){i.includes(t.submissionID)||(i.push(t.submissionID),n=[],e.entity[c].forEach((function(e,t){n.push({entity:e.type,label:e.value})})),s in a?a[s].push({submissionID:t.submissionID,annotator:t.annotator,detail:n}):(r[e.sentid]=s,o.push(e.sentid),a[s]=[{submissionID:t.submissionID,annotator:t.annotator,detail:n}]))}))})),o.sort(),o.forEach((function(e){s.push({sentence:r[e],sentid:e,num:a[r[e]].length,detail:a[r[e]]})})),e.setState({results:t.response,results_detail:s})}))}render(){const e=[{title:"Annotator",dataIndex:"annotator",key:"annotator"},{title:"Submission ID",dataIndex:"submissionID",key:"submissionID"}],t=[{title:"entity",dataIndex:"entity",key:"entity"},{title:"label",dataIndex:"label",key:"label"}];return Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{onClick:()=>{var e=new Blob([JSON.stringify(this.state.results_detail,null,2)],{type:"text/plain;charset=utf-8"});Object(Mt.saveAs)(e,"result.json")},children:[Object(V.jsx)(os.a,{})," Download Submissions"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Results"}),Object(V.jsx)(ge.a,{rowKey:"userId",dataSource:this.state.results_detail,columns:[{title:"SentID",dataIndex:"sentid",key:"sentid",width:100},{title:"Sentence",dataIndex:"sentence",key:"sentence"},{title:"submissions",dataIndex:"num",key:"num"}],size:"small",expandedRowRender:s=>Object(V.jsx)(ge.a,{dataSource:s.detail,columns:e,expandedRowRender:e=>Object(V.jsx)(ge.a,{dataSource:e.detail,columns:t})})})]})}}const qn={loadData:Oe,new_project_data:ke};var An=Object(o.b)((function(e){return{session:e.session_sequence}}),qn)(Dn);let Pn={},En=function(e){return e.reduce((function(e,t){return Number(e)+Number(t)}))/e.length},Fn=function(e){let t=En(e);return Math.sqrt(e.reduce((function(e,s){return e+Math.pow(s-t,2)}),0)/(e.length-1))};function Mn(e){fetch(I+"/api/get/result/sequence/"+e.props.session._id).then((function(e){return e.json()})).then((function(t){let s=[],n=[],i=[],a={},r=[];if(t.response.length>0){t.response.forEach((function(e,t){i=[];e.sentence;e.meta.forEach((function(e,t){if(!i.includes(e.submissionID)){i.push(e.submissionID);let t=e.time/1e3;n=e.answer.map((e=>({entity:e.type,label:e.value}))),e.submissionID in a?a[e.submissionID].push({sentence:e.sentence,duration:t,detail:n}):a[e.submissionID]=[{sentence:e.sentence,duration:t,detail:n}]}}))})),Object.keys(a).forEach((function(e){let t=[];a[e].forEach((function(e,s){t.push(e.duration)}));let n=t.reduce(((e,t)=>e+t),0),i=En(t),o=Fn(t);r.push(n),s.push({userId:e,total_duration:n.toFixed(3),average_duration:i.toFixed(3),std_duration:o.toFixed(3),detail:a[e],allsame:"no",outlier:"no",num:a[e].length})}));let e=Fn(r),o=En(r);s.forEach((function(t,n){(t.total_duration>o+2*e||t.total_duration<o-2*e)&&(s[n].outlier="yes")}))}return ws(I+"/api/result/sequence/"+e.props.session._id).then((n=>{t.response;s=s.map((e=>({...e,...n[e.userId]}))),e.setState({results:t.response,results_detail:s})}))}))}function Rn(e){let t=[];e.map(((e,s)=>{e.average_duration;let n=e.total_duration,i=e.userId;Pn[n]=i,t.push(n)}));let s=function(e){return e.reduce((function(e,t){return Number(e)+Number(t)}))/e.length};if(t.length>0){let e=s(t),n=function(e){let t=s(e);return Math.sqrt(e.reduce((function(e,s){return e+Math.pow(s-t,2)}),0)/(e.length-1))}(t),i=(Math.sqrt(2*Math.PI),-.5),a=[];return isNaN(n)&&(n=1),t.sort((function(e,t){return e-t})),t.map(((t,s)=>{let r=(t-e)/n;r*=r,i*=r;let o=1/(Math.sqrt(2*Math.PI)*n)*Math.E**(-.5*((t-e)/n)**2);a.push({x:t,y:o})})),a}return[{x:1,y:11}]}function Nn(e){const{v:t,userId:s}=e;return{x:t.x,y:t.y,userId:s}}class Bn extends n.Component{constructor(e){super(e),this.handleDelete=e=>{fetch(I+"/api/delete/result/sequence/"+e).then((function(e){return e.json()}))},this.state={results_detail:[],survey:[],results:[],grid:[],cost:0,visible_kappa:!1}}componentDidMount(){Mn(this),setInterval((()=>{Mn(this)}),5e3)}render(){const e=[{title:"Sentence",dataIndex:"sentence",key:"sentence"},{title:"duration",dataIndex:"duration",key:"duration"}],t=[{title:"entity",dataIndex:"entity",key:"entity"},{title:"label",dataIndex:"label",key:"label"}],s=[{title:"user id",dataIndex:"userId",key:"userId"},{title:"total",dataIndex:"total_duration",key:"total_duration"},{title:"average",dataIndex:"average_duration",key:"average_duration"},{title:"std",dataIndex:"std_duration",key:"std_duration"},{title:Object(V.jsxs)(V.Fragment,{children:["outlier",Object(V.jsx)(xe.a,{title:"Whether the time spent on the task is 2 standard deviations above or below the average time taken.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"outlier",key:"outlier"},{title:Object(V.jsxs)(V.Fragment,{children:["intra-user",Object(V.jsx)(xe.a,{title:"The number of times the worker responded consistently/ the number of duplicated task units given in each HIT.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"agreeSelf",key:"agreeSelf"},{title:Object(V.jsxs)(V.Fragment,{children:["agree-gold",Object(V.jsx)(xe.a,{title:"The number of correctly answered golden task units / the number of golden task units given in each HIT.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"agreeGold",key:"agreeGold"},{title:Object(V.jsxs)(V.Fragment,{children:["inter-user",Object(V.jsx)(xe.a,{title:"The ratio of annotations that agree with the majority.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"agreeMajor",key:"agreeMajor"},{title:"submissions",dataIndex:"num",key:"num"},{title:"operation",dataIndex:"operation",render:(e,t)=>this.state.results_detail.length>1?Object(V.jsx)(ps.a,{title:"Sure to delete?",onConfirm:()=>this.handleDelete(t.userId),children:Object(V.jsx)("a",{href:"javascript:;",children:"Delete"})}):null}];return Object(V.jsxs)("div",{children:[Object(V.jsxs)("p",{children:["We calculate the worker's time according to how long they take in selecting all the categories for the entities in the sentence. Outlier is calculated by any worker who takes more than 2 standard deviations longer or shorter than the mean time taken for the task. This metric can be used to help determine if a worker may be a bot; however, we suggest that you pay the bot, block them from completing future HITs for you, and ",Object(V.jsx)("a",{href:"https://support.aws.amazon.com/#/contacts/aws-mechanical-turk",children:"report"}),' it to Amazon, which can also be done through "Report this HIT" on the MTurk interface. This is because rejecting the bot may hurt your requester reputation. Be sure to accept and reject your HITs in a timely manner and communicate with the workers if they have any questions. You can monitor your requester reputation on sites such as ',Object(V.jsx)("a",{href:"https://turkopticon.ucsd.edu/",children:"Turkopticon"}),"."]}),Object(V.jsx)("h1",{children:"Workers' Timestamps Logs"}),Object(V.jsx)(ge.a,{rowKey:"userId",dataSource:this.state.results_detail,columns:s,size:"small",expandedRowRender:s=>Object(V.jsx)(ge.a,{dataSource:s.detail,columns:e,expandedRowRender:e=>Object(V.jsx)(ge.a,{dataSource:e.detail,columns:t})})}),Object(V.jsx)("h1",{children:"Agreement between Workers"}),Object(V.jsx)(Hn,{url:I+"/api/task/sequence/"+this.props.session._id,propertyNameQuestions:"questionEntities"}),Object(V.jsx)("h1",{children:"Gaussian of Timestamps"}),Object(V.jsxs)(us.g,{width:300,height:300,children:[Object(V.jsx)(us.e,{}),Object(V.jsx)(us.c,{}),Object(V.jsx)(us.f,{}),Object(V.jsx)(us.h,{}),Object(V.jsx)(us.a,{text:"total time to label sequences",className:"alt-x-label",includeMargin:!1,xPercent:.25,yPercent:1.01}),Object(V.jsx)(us.a,{text:"probability density",className:"alt-y-label",includeMargin:!1,xPercent:.06,yPercent:.06,style:{transform:"rotate(-90)",textAnchor:"end"}}),Object(V.jsx)(us.d,{className:"linemark-series-example-2",curve:"curveMonotoneX",data:Rn(this.state.results_detail),onValueMouseOver:e=>this.setState({hoveredCell:!(!e.x||!e.y)&&{v:e,userId:Pn[e.x]}})}),this.state.hoveredCell?Object(V.jsx)(us.b,{value:Nn(this.state.hoveredCell),children:Object(V.jsx)("div",{style:{color:"black"},children:Object(V.jsx)("b",{children:Object(V.jsxs)("strong",{children:[" ","userId: "+this.state.hoveredCell.userId]})})})}):null]})]})}}class Hn extends gs{}Hn.columns=[{title:"Entity Type",dataIndex:"question",key:"question"},{title:"Pairwise F1",dataIndex:"Pairwise F1",key:"Pairwise F1"}];const Ln={loadData:Oe,new_project_data:ke};var Kn=Object(o.b)((function(e){return{session:e.session_sequence}}),Ln)(Bn);let Un=function(e){return e.reduce((function(e,t){return Number(e)+Number(t)}))/e.length};function zn(e){fetch(I+"/api/get/result/sequence/"+e.props.session._id).then((function(e){return e.json()})).then((function(t){let s=[],n=[],i={},a=[],r=0;if(t.response.length>0){t.response.forEach((function(e,t){n=[];let a=e.sentence;e.meta.forEach((function(t,r){if(!n.includes(t.submissionID)){n.push(t.submissionID);let o=t.time/1e3;s=[],e.entity[r].forEach((function(e,t){s.push({entity:e.type,label:e.value})})),t.submissionID in i?i[t.submissionID].push({sentence:a,duration:o,detail:s}):i[t.submissionID]=[{sentence:a,duration:o,detail:s}]}}))}));let e=[],o={};Object.keys(i).forEach((function(t){let s=[];i[t].forEach((function(e,t){s.push(e.duration)}));let n=s.reduce(((e,t)=>e+t),0);e.push(n),o[t]=n}));let c=Un(e);Object.keys(o).forEach((function(e){o[e]>c?a.push({submissionID:e,bonus:"$"+Number(Math.round(15*(o[e]-c)/3600+"e2")+"e-2").toString()}):a.push({submissionID:e,bonus:"$0.00"})})),r=15*Un(e)/3600}e.setState({cost:r,bonus:a})}))}class Wn extends n.Component{constructor(e){super(e),this.state={cost:0}}componentDidMount(){zn(this)}render(){zn(this);return Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{children:"Recommend Reward per Assignment "}),Object(V.jsx)("p",{children:" = hourly wage ($15.00) * average time (sec) / (60 sec * 60 min)"}),Object(V.jsxs)("div",{style:{"text-align":"center","font-size":"30px"},children:["$",Math.round(100*this.state.cost)/100]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Suggested Bonuses"}),Object(V.jsx)(ge.a,{rowKey:"submissionID",dataSource:this.state.bonus,columns:[{title:"Submission ID",dataIndex:"submissionID",key:"submissionID"},{title:"Suggested Bonus",dataIndex:"bonus",key:"bonus"}],size:"small"})]})}}const Qn={loadData:Oe,new_project_data:ke};var Gn=Object(o.b)((function(e){return{session:e.session_sequence}}),Qn)(Wn);function Vn(e){fetch(I+"/api/get/result/sequence/"+e.props.session._id).then((function(e){return e.json()})).then((function(t){let s={};for(const e of t.response)for(const t of e.meta)null!==t.feedback&&(s[t.submissionID]=t.feedback);let n=[];for(const[e,i]of Object.entries(s))n.push({userId:e,feedback:i});e.setState({feedbacks:n})}))}class Yn extends n.Component{constructor(e){super(e),this.state={feedback:[]}}componentDidMount(){Vn(this),setInterval((()=>Vn(this)),5e3)}render(){return Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{onClick:()=>{var e=new Blob([JSON.stringify(this.state.feedbacks,null,2)],{type:"text/plain;charset=utf-8"});Object(Mt.saveAs)(e,"sequence_feedback.json")},children:[Object(V.jsx)(os.a,{})," Download Feedback"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Feedback "}),Object(V.jsx)(ge.a,{rowKey:"userId",dataSource:this.state.feedbacks,columns:[{title:"user id",dataIndex:"userId",key:"userId"},{title:"feedback",dataIndex:"feedback",key:"feedback"}],size:"small"})]})}}const Jn={loadData:Oe,new_project_data:ke};var $n=Object(o.b)((function(e){return{session:e.session_sequence}}),Jn)(Yn);const Xn=de.a.TabPane;class Zn extends i.a.Component{constructor(e){super(e),this.state={}}componentDidMount(){console.log("Sequence open")}render(){return Object(V.jsx)("div",{children:Object(V.jsxs)(de.a,{defaultActiveKey:"1",children:[Object(V.jsx)(Xn,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(X.a,{}),"Configure"]}),children:this.props.session.hasOwnProperty("Label")?Object(V.jsx)(Tn,{data:this.props.session}):null},"1"),Object(V.jsx)(Xn,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(he.a,{}),"Raw Results"]}),children:Object(V.jsx)(An,{data:this.props.session})},"2"),Object(V.jsx)(Xn,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(ee.a,{}),"Feedback"]}),children:Object(V.jsx)($n,{data:this.props.session})},"5"),Object(V.jsx)(Xn,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(ue.a,{}),"Quality"]}),children:Object(V.jsx)(Kn,{data:this.props.session})},"3"),Object(V.jsx)(Xn,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(pe.a,{}),"Payment"]}),children:Object(V.jsx)(Gn,{data:this.props.session})},"4")]})})}}var ei=Object(o.b)((function(e){return{session:e.session_sequence}}),{})(Zn),ti=s(566);const si=de.a.TabPane,ni=je.a.Item;class ii extends i.a.Component{constructor(e){super(e),this.showDrawer=()=>{this.setState({visible:!0})},this.onClose=()=>{this.setState({visible:!1})},this.generate=e=>{e.preventDefault(),this.props.form.validateFields(((e,t)=>{e||this.setState({username:t.username,showlink:!0})}))},this.state={visible:!1,username:"",showlink:!1}}componentDidMount(){}render(){const{getFieldDecorator:e}=this.props.form;return Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{type:"primary",style:{float:"left",width:"90%"},onClick:this.showDrawer,children:[Object(V.jsx)(_e.a,{}),"Amazon Mechanical Turk Template"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsxs)(Ie.a,{title:"Template",width:720,placement:"right",onClose:this.onClose,maskClosable:!0,visible:this.state.visible,style:{height:"calc(100% - 55px)",overflow:"auto",paddingBottom:53},children:[Object(V.jsx)(Se.a,{gutter:16,children:Object(V.jsx)("div",{children:Object(V.jsxs)(de.a,{defaultActiveKey:"preview",children:[Object(V.jsx)(si,{tab:Object(V.jsx)("span",{children:"Preview"}),children:Object(V.jsxs)("div",{children:[Object(V.jsxs)("div",{style:{"border-style":"solid"},children:[Object(V.jsx)("div",{style:{"text-align":"center"},children:Object(V.jsx)("p",{children:"Preview"})}),Object(V.jsxs)("p",{style:{"padding-left":"2%"},children:["Background: ",this.props.thisstate.generic_introduction," "]}),Object(V.jsxs)("p",{style:{"padding-left":"2%"},children:["Instructions: ",this.props.thisstate.generic_instructions," "]})]}),Object(V.jsx)("br",{}),Object(V.jsx)("p",{children:"Input a username and generate the HIT link"}),Object(V.jsx)(je.a,{onSubmit:this.generate,children:Object(V.jsxs)(ni,{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}},children:[e("username")(Object(V.jsx)(Ce.a.TextArea,{placeholder:"Username",style:{width:"60%",marginRight:8,float:"left"},autoSize:{minRows:1,maxRows:1}})),Object(V.jsx)(ye.a,{type:"primary",htmlType:"submit",style:{float:"left"},children:"Generate Link"})]})}),this.state.showlink?Object(V.jsxs)("p",{children:["Please go to ",S,"/worker_quality?MID=",this.state.username,"&ID=",this.props.thisstate._id," in a separate window to complete the HIT"]}):null,Object(V.jsx)("br",{}),Object(V.jsxs)("p",{children:["When you are done, input the confirmation code here: ",Object(V.jsx)("input",{type:"text",style:{border:"1px solid gray","padding-left":"5px"}})]})]})},"preview"),Object(V.jsxs)(si,{tab:Object(V.jsx)("span",{children:"Code"}),children:[Object(V.jsx)("pre",{children:Object(V.jsxs)("code",{children:["<style>",Object(V.jsx)("br",{}),Object(V.jsxs)("p",{style:{"margin-left":"20px"},children:["table, th, td ","{"]}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"border: 1px solid black;"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"}"}),Object(V.jsxs)("p",{style:{"margin-left":"20px"},children:["th, td ","{"]}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"padding: 15px;"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"}"}),"</style>",Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"\x3c!-- Unique turker script --\x3e ",Object(V.jsx)("br",{}),'<script src="//uniqueturker.myleott.com/lib.js" type="text/javascript"><\/script>',Object(V.jsx)("br",{}),"<script>",Object(V.jsx)("br",{}),"(function() ","{",Object(V.jsxs)("p",{style:{"margin-left":"20px"},children:['var ut_id = "e776c2408d15bc01e2f380e30759f24b";',Object(V.jsx)("br",{}),"if (UTWorkerLimitReached(ut_id)) ","{"]}),Object(V.jsxs)("p",{style:{"margin-left":"40px"},children:["document.getElementById('mturk_form').style.display = 'none';",Object(V.jsx)("br",{}),"document.getElementsByTagName('body')[0].innerHTML = \"You have already completed the maximum number of HITs allowed by this requester. Please click 'Return HIT' to avoid any impact on your approval rating.\";"]}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"}"}),"}",");",Object(V.jsx)("br",{}),"<\/script>",Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"\x3c!-- You must include this Javascript file --\x3e ",Object(V.jsx)("br",{}),'<script src="https://assets.crowd.aws/crowd-html-elements.js"><\/script> ',Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"\x3c!-- For the full list of available Crowd HTML Elements and their input/output documentation, please refer to https://docs.aws.amazon.com/sagemaker/latest/dg/sms-ui-template-reference.html --\x3e ",Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"\x3c!-- You must include crowd-form so that your task submits answers to MTurk --\x3e ",Object(V.jsx)("br",{}),'<crowd-form answer-format="flatten-objects"> ',Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),"<div> ",Object(V.jsx)("br",{}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:'<div style="border-style: solid">'}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:'<div style="text-align: center">'}),Object(V.jsx)("p",{style:{"margin-left":"60px"},children:"<p>Preview</p>"}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"</div>"}),Object(V.jsxs)("p",{style:{"margin-left":"40px"},children:['<p style="padding-left: 2%">Background: ',this.props.thisstate.generic_introduction," </p>"]}),Object(V.jsxs)("p",{style:{"margin-left":"40px"},children:['<p style="padding-left: 2%">Instructions: ',this.props.thisstate.generic_instructions," </p>"]}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"</div>"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"<div>"}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"<p>Input a username and generate the HIT link</p>"}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:'<input id="workerid" type="text" name="username" placeholder="Username">'}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:'<button id="submit">Generate Link</button>'}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"</div>"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"<br>"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:'<div><span id="dialcrowd_link"> - </span></div>'}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:'<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"><\/script>'}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"<script>"}),Object(V.jsxs)("p",{style:{"margin-left":"40px"},children:["document.getElementById('submit').onclick = function(event) ","{"]}),Object(V.jsx)("p",{style:{"margin-left":"60px"},children:"event.preventDefault();"}),Object(V.jsxs)("p",{style:{"margin-left":"60px"},children:['document.getElementById("dialcrowd_link").textContent = "Please go to ',S,'/worker_quality/?ID=5f0b6fe49878971ce8ab83c9&MID=" + document.getElementById("workerid").value + " in a separate window to complete the HIT"']}),Object(V.jsx)("p",{style:{"margin-left":"40px"},children:"}"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:"<\/script>"}),Object(V.jsx)("p",{style:{"margin-left":"20px"},children:'<p>When you are done, input the confirmation code here: <input type="text" name="confirmation_code"></p>'}),"</div> ",Object(V.jsx)("br",{}),"</crowd-form> ",Object(V.jsx)("br",{})]})}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{})]},"code")]})})}),Object(V.jsx)("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"},children:Object(V.jsx)(ye.a,{style:{marginRight:8},onClick:this.onClose,children:"Close"})})]})]})}}var ai=je.a.create()(ii);const ri=je.a.Item;class oi extends es{constructor(e){super(e),this.handleSubmit=e=>{e.preventDefault(),this.props.form.validateFields(((e,t)=>{e||(t.quality_data=this.state.quality_data,t.dataGolden=this.state.dataGolden,t.consent=this.state.consent,this.submit(t,this.props.session._id))}))},this.state={...this.state,quality_data:[]},this.saveURL="/api/save/task/quality/",this.taskName="quality"}makeProps(){super.makeProps();for(const e of["quality_data","dataGolden"])this.setState({[e]:this.props.session[e]})}handleFileInputChange(e,t,s){const[n,i]=t[0];let a,r=[];for(const o of n.target.result.replace(/\r/g,"").split("\n"))switch(o){case"Context":a="context",r.push({sentid:r.length});break;case"Response":a="response";break;case"Answer":a="answer";break;default:if(""!==o){let e=r[r.length-1];"response"===a?e.response=o:"context"===a?(e[a]=e[a]||[],e[a].push({utterance:o,turn:e[a].length+1})):"answer"===a&&(e[a]=e[a]||[],e[a].push(o))}}r.length>0&&be.a.success("".concat(r.length," dialogs are loaded!")),this.setState({[s]:r})}render(){return Object(V.jsxs)("div",{children:[Object(V.jsx)("h2",{style:{"padding-left":"1%"},children:"Template for a Quality Task"}),Object(V.jsx)("p",{style:{"padding-left":"1%"},children:"This template is used for the creation of tasks that require the workers to assess the quality of the conversation. You can give the worker one or more conversations, and ask questions about those conversations."}),Object(V.jsxs)(je.a,{onSubmit:this.handleSubmit,children:[this._showGeneralConfig(),this._showConsentConfig(),this._showDataConfig(),this._showQualityControlConfig("conversation"),this._showSurveyConfig(),this._showFeedbackConfig(),this._showAppearanceConfig([{name:"Context",fieldName:"context",explain:"Set the style of the dialogue context shown to workers."},{name:"Response",fieldName:"response",explain:"Set the style of the dialogue response shown to workers."},{name:"Questions",fieldName:"question",explain:"Set the style of the text in each question."}]),this._showButtons()]})]})}_showDataUpload(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{formItemLayout:t}=this;let s=[{title:"ID",dataIndex:"sentid",key:"sendid",width:100},{title:"Response",dataIndex:"response",key:"response"}];e&&s.push({title:"Answer",dataIndex:"answer",key:"answer",render:e=>e.join("; ")});const n=[{title:"Turn",dataIndex:"turn",key:"turn"},{title:"Context Utterance",dataIndex:"utterance",key:"utterance"}],i=e?"dataGolden":"quality_data";let a;return a=e?Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("div",{children:"Context"}),Object(V.jsx)("div",{children:"System: How are you doing today?"}),Object(V.jsx)("div",{children:"User: I'm doing great; how about you?"}),Object(V.jsx)("div",{children:"Response"}),Object(V.jsx)("div",{children:"System: I'm also doing well."}),Object(V.jsx)("div",{children:"Answer"}),Object(V.jsx)("div",{children:"Answer to the 1st question for a dialog."}),Object(V.jsx)("div",{children:"Answer to the 2st question for a dialog."})]}):Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("div",{children:"Context"}),Object(V.jsx)("div",{children:"System: How are you doing today?"}),Object(V.jsx)("div",{children:"User: I'm doing great; how about you?"}),Object(V.jsx)("div",{children:"Response"}),Object(V.jsx)("div",{children:"System: I'm also doing well."})]}),Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)(ri,{...t,label:Object(V.jsxs)("span",{children:[e?"Upload data with answer":"Upload your data"," \xa0",Object(V.jsx)(xe.a,{title:Object(V.jsxs)("div",{children:[Object(V.jsx)("div",{children:"Please format your data as below, separated with new lines:"}),a,e?Object(V.jsx)("div",{children:Object(V.jsx)("b",{children:"It's is recommended that the number of golden is 10% of the number of the data to be annotated."})}):null]}),children:Object(V.jsx)(ae.a,{})})]}),children:[Object(V.jsx)(Ee.a,{as:"text",onChange:(e,t)=>this.handleFileInputChange(e,t,i),children:Object(V.jsxs)(ye.a,{style:{width:"90%"},children:[Object(V.jsx)(fe.a,{})," Click to Upload"]})}),Object(V.jsx)("div",{children:(this.state.quality_data||[]).length>0&&e?Object(V.jsxs)("b",{children:["It is recommended to have at least ",Math.ceil(this.state.quality_data.length/10)," golden data."]}):null})]}),(this.state[i]||[]).length>0?Object(V.jsx)("div",{children:Object(V.jsx)("div",{title:"Your Data",height:500,children:Object(V.jsx)(ge.a,{rowKey:"sentence",dataSource:this.state[i],columns:s,pagination:{hideOnSinglePage:!0},size:"small",expandedRowRender:e=>Object(V.jsx)(ge.a,{dataSource:e.context,pagination:{hideOnSinglePage:!0},columns:n})})})}):null,Object(V.jsx)("br",{})]})}_showDataConfig(){const{formItemLayout:e}=this;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("h3",{style:{"padding-left":"1%"},children:"Data"}),Object(V.jsx)("p",{style:{"padding-left":"1%"},children:"The data you want the workers to annotate."}),Object(V.jsxs)("div",{style:{border:"2px solid black",margin:"10px",padding:24},children:[this._showDataUpload(!1),this._showAnnotationConfig("conversation",(this.state.quality_data||[]).length)]})]})}_showButtons(){const{getFieldDecorator:e}=this.props.form,{formItemLayout:t,formItemLayoutWithOutLabel:s}=this;return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("div",{style:{"text-align":"center","padding-left":"60px","padding-top":"2%"},children:Object(V.jsx)("span",{style:{"margin-left":"-13%"},children:"Please save before you preview"})}),Object(V.jsxs)(ri,{...s,children:[Object(V.jsx)(ye.a,{type:"primary",style:{width:"71.5%"},htmlType:"submit",children:"Save"})," "," ",Object(V.jsxs)(ye.a,{onClick:()=>window.open(S+"/worker_quality?MID=dialcrowd&ID="+this.props.session._id),style:{width:"18%"},children:[Object(V.jsx)(ti.a,{})," Preview"]}),Object(V.jsx)("br",{}),Object(V.jsx)(ye.a,{type:"primary",style:{width:"90%"},onClick:()=>this._saveAsJSON(),children:"Save Configuration as JSON"}),Object(V.jsx)("div",{style:{"padding-top":"2%"},children:Object(V.jsx)(ai,{thisstate:this.props.session})})]})]})}_showTemplate(){}}oi.instructionSurvey="In this section, you can add, remove and edit questions regarding the the conversations presented. The worker will need to answer these questions for each conversation you uploaded. For example, you can ask the worker to assess the fluency of the conversation.",oi.helpTextSurveyQuestion="Add a question that is to be answered for each conversation you uploaded. You can, for example, ask the worker to assess the fluency of the conversation.";const ci={loadData:Oe,new_project_data:ke};var li=Object(o.b)((function(e){return{session:e.session_quality}}),ci)(je.a.create()(oi));class di extends n.Component{constructor(e){super(e),this.state={results_detail:[],results:[]}}componentDidMount(){var e;e=this,fetch(I+"/api/get/result/quality/"+e.props.session._id).then((function(e){return e.json()})).then((function(t){console.log("json",t);let s=[],n=[],i=[],a={},r={},o=[];t.response.forEach((function(e,t){i=[],e.meta.forEach((function(t,s){i.includes(t.submissionID)||(i.push(t.submissionID),n=[],Object.keys(t.responses).forEach((function(e){n.push({question:e.split("|||")[1],response:t.responses[e]})})),e.sentid in a?a[e.sentid].push({submissionID:t.submissionID,annotator:t.annotator,detail:n}):(r[e.sentid]=t.response,o.push(e.sentid),a[e.sentid]=[{submissionID:t.submissionID,annotator:t.annotator,detail:n}]))}))})),o.sort(),o.forEach((function(e){s.push({response:r[e],sentid:e,num:a[e].length,detail:a[e]})})),e.setState({results:t.response,results_detail:s})}))}render(){const e=[{title:"Annotator",dataIndex:"annotator",key:"annotator"},{title:"Submission ID",dataIndex:"submissionID",key:"submissionID"}],t=[{title:"question",dataIndex:"question",key:"question"},{title:"response",dataIndex:"response",key:"response"}];return Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{onClick:()=>{var e=new Blob([JSON.stringify(this.state.results_detail,null,2)],{type:"text/plain;charset=utf-8"});Object(Mt.saveAs)(e,"result.json")},children:[Object(V.jsx)(os.a,{})," Download Submissions"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Results"}),Object(V.jsx)(ge.a,{rowKey:"userId",dataSource:this.state.results_detail,pagination:{hideOnSinglePage:!0},columns:[{title:"Sentence",dataIndex:"sentid",key:"sentid"},{title:"Response",dataIndex:"response",key:"response"},{title:"submissions",dataIndex:"num",key:"num"}],size:"small",expandedRowRender:s=>Object(V.jsx)(ge.a,{dataSource:s.detail,pagination:{hideOnSinglePage:!0},columns:e,expandedRowRender:e=>Object(V.jsx)(ge.a,{dataSource:e.detail,pagination:{hideOnSinglePage:!0},columns:t})})})]})}}const hi={loadData:Oe,new_project_data:ke};var ui=Object(o.b)((function(e){return{session:e.session_quality}}),hi)(di);let pi={},ji=function(e){return e.reduce((function(e,t){return Number(e)+Number(t)}))/e.length},bi=function(e){let t=ji(e);return Math.sqrt(e.reduce((function(e,s){return e+Math.pow(s-t,2)}),0)/(e.length-1))};function mi(e){fetch(I+"/api/get/result/quality/"+e.props.session._id).then((function(e){return e.json()})).then((function(t){let s=[],n=[],i=[],a={},r=[],o={},c={};if(t.response.length>0){let e={};t.response.forEach((function(e,t){i=[],e.meta.forEach((function(e,t){if(!i.includes(e.submissionID)){i.push(e.submissionID);let t=e.time/1e3;n=[],Object.keys(e.responses).forEach((function(t){t.split("|||")[0].includes("Likert")?(e.submissionID in o?o[e.submissionID].push(e.responses[t]):o[e.submissionID]=[e.responses[t]],n.push({question:t.split("|||")[1],response:e.responses[t]})):t.split("|||")[0].includes("Radio")&&(e.submissionID in c?c[e.submissionID].push(e.responses[t]):c[e.submissionID]=[e.responses[t]],n.push({question:t.split("|||")[1],response:e.responses[t]}))}));const s={response:e.response,duration:t,detail:n,patternPeriod:e.patternPeriod,agreeSelf:e.agreeSelf,agreeGold:e.agreeGold,agreeMajor:e.agreeMajor};e.submissionID in a?a[e.submissionID].push(s):a[e.submissionID]=[s]}}))})),Object.keys(a).forEach((function(e){let t=[];a[e].forEach((function(e,s){t.push(e.duration)}));let n=t.reduce(((e,t)=>e+t),0),i=ji(t),o=bi(t);r.push(n);let c="no",l={agreeSelf:0,agreeGold:0},d={agreeSelf:0,agreeGold:0},h=a[e].map((e=>e.agreeMajor)).filter((e=>void 0!==e)),u=h.reduce(((e,t)=>e+t),0)/h.length;for(const s of a[e]){s.patternPeriod>0&&(c="yes");for(const e of Object.keys(d))!1===s[e]?d[e]+=1:!0===s[e]&&(l[e]+=1)}let p="".concat(l.agreeSelf)+"/ ".concat(d.agreeSelf+l.agreeSelf),j="".concat(l.agreeGold)+"/ ".concat(d.agreeGold+l.agreeGold);d.agreeSelf+l.agreeSelf===0&&(p="--"),d.agreeGold+l.agreeGold===0&&(j="--"),isNaN(u)&&(u="--"),s.push({userId:e,total_duration:n.toFixed(3),average_duration:i.toFixed(3),std_duration:o.toFixed(3),detail:a[e],abnormal:c,agreeSelf:p,agreeGold:j,agreeMajor:u,outlier:"no",num:a[e].length})}));let l=bi(r),d=ji(r);s.forEach((function(t,n){(t.total_duration>d+2*l||t.total_duration<d-2*l)&&(s[n].outlier="yes"),e[t.userId]&&(s[n].allsame="yes")}))}e.setState({results:t.response,results_detail:s})}))}function xi(e){let t=[];e.map(((e,s)=>{e.average_duration;let n=e.total_duration,i=e.userId;pi[n]=i,t.push(n)}));let s=function(e){return e.reduce((function(e,t){return Number(e)+Number(t)}))/e.length};if(t.length>0){let e=s(t),n=function(e){let t=s(e);return Math.sqrt(e.reduce((function(e,s){return e+Math.pow(s-t,2)}),0)/(e.length-1))}(t),i=(Math.sqrt(2*Math.PI),-.5),a=[];return isNaN(n)&&(n=1),t.sort((function(e,t){return e-t})),t.map(((t,s)=>{let r=(t-e)/n;r*=r,i*=r;let o=1/(Math.sqrt(2*Math.PI)*n)*Math.E**(-.5*((t-e)/n)**2);a.push({x:t,y:o})})),a}return[{x:1,y:11}]}function yi(e){const{v:t,userId:s}=e;return{x:t.x,y:t.y,userId:s}}class gi extends n.Component{constructor(e){super(e),this.handleDelete=e=>{const t=[...this.state.results_detail],s=[...this.state.results];if(this.state.feedback&&this.state.feedback.length>0){const t=[...this.state.feedback];t.forEach((function(s,n){let i=[];s.detail.forEach((function(t,s){t.userId!==e&&i.push(t)})),t[n].detail=i})),this.setState({feedback:t.filter((t=>t.userId!==e))})}this.setState({results_detail:t.filter((t=>t.userId!==e))}),this.setState({results:s.filter((t=>t.userId!==e))}),fetch(I+"/api/delete/result/quality/"+e).then((function(e){return e.json()}))},this.state={results_detail:[],survey:[],results:[],grid:[],cost:0,visible_kappa:!1}}componentDidMount(){mi(this),setInterval((()=>mi(this)),2e3)}render(){const e=[{title:"Response",dataIndex:"response",key:"response"},{title:"duration",dataIndex:"duration",key:"duration"}],t=[{title:"question",dataIndex:"question",key:"question"},{title:"response",dataIndex:"response",key:"response"}],s=[{title:"user id",dataIndex:"userId",key:"userId"},{title:"total",dataIndex:"total_duration",key:"total_duration"},{title:"average",dataIndex:"average_duration",key:"average_duration"},{title:"std",dataIndex:"std_duration",key:"std_duration"},{title:Object(V.jsxs)(V.Fragment,{children:["outlier",Object(V.jsx)(xe.a,{title:"Whether the time spent on the task is 2 standard deviations above or below the average time taken.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"outlier",key:"outlier"},{title:Object(V.jsxs)(V.Fragment,{children:["abnormal",Object(V.jsx)(xe.a,{title:"Whether some repeating pattern, like answering A, B, A, B ..., or A, A, A is detected.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"abnormal",key:"abnormal"},{title:Object(V.jsxs)(V.Fragment,{children:["intra-user",Object(V.jsx)(xe.a,{title:"The number of times the worker responded consistently/ the number of duplicated task units given in each HIT.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"agreeSelf",key:"agreeSelf"},{title:Object(V.jsxs)(V.Fragment,{children:["agree-gold",Object(V.jsx)(xe.a,{title:"The number of correctly answered golden task units / the number of golden task units given in each HIT.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"agreeGold",key:"agreeGold"},{title:Object(V.jsxs)(V.Fragment,{children:["inter-user",Object(V.jsx)(xe.a,{title:"The ratio of annotations that agree with the majority.",children:Object(V.jsx)("a",{children:Object(V.jsx)("sub",{children:"?"})})})]}),dataIndex:"agreeMajor",key:"agreeMajor"},{title:"submissions",dataIndex:"num",key:"num"},{title:"operation",dataIndex:"operation",render:(e,t)=>this.state.results_detail.length>1?Object(V.jsx)(ps.a,{title:"Sure to delete?",onConfirm:()=>this.handleDelete(t.userId),children:Object(V.jsx)("a",{href:"javascript:;",children:"Delete"})}):null}];return Object(V.jsxs)("div",{children:[Object(V.jsxs)("p",{children:["We calculate the worker's time according to how long they take in selecting all the categories for the entities in the sentence. Outlier is calculated by any worker who takes more than 2 standard deviations longer or shorter than the mean time taken for the task. This metric can be used to help determine if a worker may be a bot; however, we suggest that you pay the bot, block them from completing future HITs for you, and ",Object(V.jsx)("a",{href:"https://support.aws.amazon.com/#/contacts/aws-mechanical-turk",children:"report"}),' it to Amazon, which can also be done through "Report this HIT" on the MTurk interface. This is because rejecting the bot may hurt your requester reputation. Be sure to accept and reject your HITs in a timely manner and communicate with the workers if they have any questions. You can monitor your requester reputation on sites such as ',Object(V.jsx)("a",{href:"https://turkopticon.ucsd.edu/",children:"Turkopticon"}),"."]}),Object(V.jsx)("h1",{children:"Workers' Timestamps Logs"}),Object(V.jsx)(ge.a,{rowKey:"userId",dataSource:this.state.results_detail,columns:s,pagination:{hideOnSinglePage:!0},size:"small",expandedRowRender:s=>Object(V.jsx)(ge.a,{dataSource:s.detail,pagination:{hideOnSinglePage:!0},columns:e,expandedRowRender:e=>Object(V.jsx)(ge.a,{dataSource:e.detail,pagination:{hideOnSinglePage:!0},columns:t})})}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Agreements between Workers"}),Object(V.jsx)(gs,{url:I+"/api/task/quality/"+this.props.session._id,urlResult:I+"/api/result/quality/"+this.props.session._id,propertyNameQuestions:"questionSurveys"}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Gaussian of Timestamps"}),Object(V.jsxs)(us.g,{width:300,height:300,children:[Object(V.jsx)(us.e,{}),Object(V.jsx)(us.c,{}),Object(V.jsx)(us.f,{}),Object(V.jsx)(us.h,{}),Object(V.jsx)(us.a,{text:"total time to label sequences",className:"alt-x-label",includeMargin:!1,xPercent:.25,yPercent:1.01}),Object(V.jsx)(us.a,{text:"probability density",className:"alt-y-label",includeMargin:!1,xPercent:.06,yPercent:.06,style:{transform:"rotate(-90)",textAnchor:"end"}}),Object(V.jsx)(us.d,{className:"linemark-series-example-2",curve:"curveMonotoneX",data:xi(this.state.results_detail),onValueMouseOver:e=>this.setState({hoveredCell:!(!e.x||!e.y)&&{v:e,userId:pi[e.x]}})}),this.state.hoveredCell?Object(V.jsx)(us.b,{value:yi(this.state.hoveredCell),children:Object(V.jsx)("div",{style:{color:"black"},children:Object(V.jsx)("b",{children:Object(V.jsxs)("strong",{children:[" ","userId: "+this.state.hoveredCell.userId]})})})}):null]})]})}}const fi={loadData:Oe,new_project_data:ke};var Oi=Object(o.b)((function(e){return{session:e.session_quality}}),fi)(gi);let vi=function(e){return e.reduce((function(e,t){return Number(e)+Number(t)}))/e.length};function wi(e){fetch(I+"/api/get/result/quality/"+e.props.session._id).then((function(e){return e.json()})).then((function(t){let s=[],n=[],i={},a=[],r=0;if(t.response.length>0){t.response.forEach((function(e,t){n=[];let a=e.response;e.meta.forEach((function(e,t){if(!n.includes(e.submissionID)){n.push(e.submissionID);let t=e.time/1e3;s=[],Object.keys(e.responses).forEach((function(t){s.push({question:t.split("|||")[1],response:e.responses[t]})})),e.submissionID in i?i[e.submissionID].push({response:a,duration:t,detail:s}):i[e.submissionID]=[{response:a,duration:t,detail:s}]}}))}));let e=[],o={};Object.keys(i).forEach((function(t){let s=[];i[t].forEach((function(e,t){s.push(e.duration)}));let n=s.reduce(((e,t)=>e+t),0);e.push(n),o[t]=n}));let c=vi(e);Object.keys(o).forEach((function(e){o[e]>c?a.push({submissionID:e,bonus:"$"+Number(Math.round(15*(o[e]-c)/3600+"e2")+"e-2").toString()}):a.push({submissionID:e,bonus:"$0.00"})})),r=15*vi(e)/3600}e.setState({cost:r,bonus:a})}))}class ki extends n.Component{constructor(e){super(e),this.state={cost:0}}componentDidMount(){wi(this)}render(){wi(this);return Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{children:"Recommend Reward per Assignment "}),Object(V.jsx)("p",{children:" = hourly wage ($15.00) * average time (sec) / (60 sec * 60 min)"}),Object(V.jsxs)("div",{style:{"text-align":"center","font-size":"30px"},children:["$",Math.round(100*this.state.cost)/100]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Suggested Bonuses"}),Object(V.jsx)(ge.a,{rowKey:"submissionID",dataSource:this.state.bonus,pagination:{hideOnSinglePage:!0},columns:[{title:"Submission ID",dataIndex:"submissionID",key:"submissionID"},{title:"Suggested Bonus",dataIndex:"bonus",key:"bonus"}],size:"small"})]})}}const Ii={loadData:Oe,new_project_data:ke};var Si=Object(o.b)((function(e){return{session:e.session_quality}}),Ii)(ki);function Ci(e){fetch(I+"/api/get/result/quality/"+e.props.session._id).then((function(e){return e.json()})).then((function(t){let s=[];if(t.response.length>0)for(const e of t.response[0].meta)s=s.concat(Object.values(e.feedback).map((t=>({userId:e.submissionID,feedback:t}))));e.setState({feedback:s})}))}class _i extends n.Component{constructor(e){super(e),this.state={feedback:[]}}componentDidMount(){Ci(this),setInterval((()=>Ci(this)),5e3)}render(){return Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{onClick:()=>{var e=new Blob([JSON.stringify(this.state.feedback,null,2)],{type:"text/plain;charset=utf-8"});Object(Mt.saveAs)(e,"quality_feedback.json")},children:[Object(V.jsx)(os.a,{})," Download Feedback"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Feedback "}),Object(V.jsx)(ge.a,{rowKey:"userId",dataSource:this.state.feedback,columns:[{title:"user id",dataIndex:"userId",key:"userId"},{title:"feedback",dataIndex:"feedback",key:"feedback"}],pagination:{hideOnSinglePage:!0},size:"small"})]})}}const Ti={loadData:Oe,new_project_data:ke};var Di=Object(o.b)((function(e){return{session:e.session_quality}}),Ti)(_i);const qi=de.a.TabPane;class Ai extends i.a.Component{constructor(e){super(e),this.state={}}componentDidMount(){console.log("Quality open")}render(){return Object(V.jsx)("div",{children:Object(V.jsxs)(de.a,{defaultActiveKey:"1",children:[Object(V.jsx)(qi,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(X.a,{}),"Configure"]}),children:Object(V.jsx)(li,{data:this.props.session})},"1"),Object(V.jsx)(qi,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(he.a,{}),"Raw Results"]}),children:Object(V.jsx)(ui,{data:this.props.session})},"2"),Object(V.jsx)(qi,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(ee.a,{}),"Feedback"]}),children:Object(V.jsx)(Di,{data:this.props.session})},"5"),Object(V.jsx)(qi,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(ue.a,{}),"Quality"]}),children:Object(V.jsx)(Oi,{data:this.props.session})},"3"),Object(V.jsx)(qi,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(pe.a,{}),"Payment"]}),children:Object(V.jsx)(Si,{data:this.props.session})},"4")]})})}}var Pi=Object(o.b)((function(e){return{session:e.session_quality}}),{})(Ai),Ei=s(567);const Fi=je.a.Item;class Mi extends i.a.Component{constructor(e){super(e),this.handleConfirmBlur=e=>{const t=e.target.value;this.setState({confirmDirty:this.state.confirmDirty||!!t})},this.checkPassword=(e,t,s)=>{const n=this.props.form;t&&t!==n.getFieldValue("password")?s("Two passwords that you enter is inconsistent!"):s()},this.checkConfirm=(e,t,s)=>{const n=this.props.form;t&&this.state.confirmDirty&&n.validateFields(["confirm"],{force:!0}),s()},this.showModal=()=>{this.setState({visible:!0})},this.cancelModal=()=>{this.setState({visible:!1})},this.hideModal=()=>{this.props.form.validateFields(((e,t)=>{var s,n,i;e||(console.log("Received values of form: ",t),s=this,n=t,i="new",fetch(I+"/api/save/task/"+s.props.project+"/"+i,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(e){"success"===e.message?(js.message.success("Success"),s.props.new_project_data(s.props.project)):js.message.success("Fail")})),this.props.form.resetFields())})),this.setState({visible:!1})},this.handleSubmit=e=>{e.preventDefault(),this.props.form.validateFields(((e,t)=>{e||console.log("Received values of form: ",t)}))},this.state={filename:"",visible:!1,utterance:"",intent:null,user_id:"",files:[],confirmDirty:!1,entities:[]}}render(){const{getFieldDecorator:e}=this.props.form,t={labelCol:{span:8},wrapperCol:{span:14}};return Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{onClick:this.showModal,children:[Object(V.jsx)(Ei.a,{})," New Project"]}),Object(V.jsx)(Ke.a,{title:"New Project",visible:this.state.visible,onOk:this.hideModal,onCancel:this.cancelModal,okText:"New Project",cancelText:"Cancel",children:Object(V.jsxs)(je.a,{onSubmit:this.handleSubmit,children:[Object(V.jsx)(Fi,{...t,label:Object(V.jsxs)("span",{children:["Project name\xa0",Object(V.jsx)(xe.a,{title:"Please input the project. ",children:Object(V.jsx)(ae.a,{})})]}),hasFeedback:!0,children:e("project",{rules:[{required:!0,message:"Please input the project!",whitespace:!0}]})(Object(V.jsx)(Ce.a,{}))}),Object(V.jsx)(Fi,{...t,label:Object(V.jsxs)("span",{children:["Creator\xa0",Object(V.jsx)(xe.a,{title:"You can find your project by your creator name",children:Object(V.jsx)(ae.a,{})})]}),children:e("nickname",{rules:[{required:!0,message:"Please input your creator name!",whitespace:!0}]})(Object(V.jsx)(Ce.a,{}))}),Object(V.jsx)(Fi,{...t,label:"Password",children:e("password",{rules:[{required:!0,message:"Please input your password!"},{validator:this.checkConfirm}]})(Object(V.jsx)(Ce.a,{type:"password"}))}),Object(V.jsx)(Fi,{...t,label:"Confirm Password",children:e("confirm",{rules:[{required:!0,message:"Please confirm your password!"},{validator:this.checkPassword}]})(Object(V.jsx)(Ce.a,{type:"password",onBlur:this.handleConfirmBlur}))})]})})]})}}const Ri={new_project_data:ke};var Ni=Object(o.b)((function(e,t){return{}}),Ri)(je.a.create()(Mi)),Bi=s(193),Hi=s.n(Bi),Li=s(573),Ki=s(564);class Ui extends i.a.Component{constructor(e){super(e),this.handleOk=()=>{this.visit()},this.handleCancel=()=>{this.setState({visible:!1})},this.onChangePassword=e=>{this.setState({password:e.target.value})},this.confirm=e=>{e.password,this.state.inputText,be.a.success("Delete Success"),this.props.deleteProject(this.props.url,e._id,this.state.inputText),this.setState({inputText:""})},this.cancel=e=>{this.setState({inputText:""})},this.onChangeInput=e=>{this.setState({inputText:e.target.value})},this.getColumnSearchProps=e=>({filterDropdown:t=>{let{setSelectedKeys:s,selectedKeys:n,confirm:i,clearFilters:a}=t;return Object(V.jsxs)("div",{style:{padding:8},children:[Object(V.jsx)(Ce.a,{ref:e=>{this.searchInput=e},placeholder:"nickname"!==e?"Search project":"Search creator",value:n[0],onChange:e=>s(e.target.value?[e.target.value]:[]),onPressEnter:()=>this.handleSearch(n,i,e),style:{width:188,marginBottom:8,display:"block"}}),Object(V.jsx)(ye.a,{type:"primary",onClick:()=>this.handleSearch(n,i,e),icon:Object(V.jsx)(Li.a,{}),size:"small",style:{width:90,marginRight:8},children:"Search"}),Object(V.jsx)(ye.a,{onClick:()=>this.handleReset(a),size:"small",style:{width:90},children:"Reset"})]})},filterIcon:e=>Object(V.jsx)(Li.a,{style:{color:e?"#1890ff":void 0}}),onFilter:(t,s)=>s[e].toString().toLowerCase().includes(t.toLowerCase()),onFilterDropdownVisibleChange:e=>{e&&setTimeout((()=>this.searchInput.select()))},render:t=>this.state.searchedColumn===e?Object(V.jsx)(Hi.a,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[this.state.searchText],autoEscape:!0,textToHighlight:t.toString()}):t}),this.handleSearch=(e,t,s)=>{t(),this.setState({searchText:e[0],searchedColumn:s})},this.handleReset=e=>{e(),this.setState({searchText:""})},this.state={Status:"None",isload:!1,loading:!1,visible:!1,background:"",instruction:"",password:"",createdAt:"",sysA:"",inputText:""}}async visit(){const e=I+"/api/"+this.props.url+"/"+this.state.createdAt,t=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:this.state.password})}),s=await t.json();null!==s?(s.password=this.state.password,await this.props.dispatchUpdate(this.props.url,s),this.setState({loading:!1,visible:!1,password:""}),this.props.history.replace("/"+this.props.url)):be.a.error("Please check the password!")}async go(e){this.setState({visible:!0,createdAt:e})}render(){const{data:e}=this.props,{visible:t,loading:s}=this.state;e.length>0&&e.sort((function(e,t){return e.name.localeCompare(t.name)}));const n=[{title:"ID",dataIndex:"createdAt",key:"createdAt"},{title:"Project Name",dataIndex:"name",key:"name",sorter:(e,t)=>e.name.localeCompare(t.name),...this.getColumnSearchProps("name")},{title:"Creator",dataIndex:"nickname",key:"nickname",sorter:(e,t)=>e.nickname.localeCompare(t.nickname),...this.getColumnSearchProps("nickname")},{title:"Menu",dataIndex:"operation",key:"operation",render:(e,t)=>Object(V.jsx)("span",{className:"table-operation",children:Object(V.jsxs)("span",{children:[Object(V.jsx)("a",{onClick:()=>this.go(t.createdAt),children:Object(V.jsx)(_e.a,{})}),Object(V.jsx)(Ne.a,{type:"vertical"}),Object(V.jsx)(ps.a,{title:Object(V.jsxs)("span",{children:[Object(V.jsx)("h1",{children:"Are you abolutely sure?"}),Object(V.jsx)("p",{children:'"Please type in the password of this task to confirm."'}),Object(V.jsx)(Ce.a,{placeholder:"Password",value:this.state.inputText,onChange:this.onChangeInput})]}),onConfirm:()=>this.confirm(t),onCancel:this.cancel,okText:"Yes",cancelText:"No",children:Object(V.jsx)("a",{children:Object(V.jsx)(Ki.a,{})})})]})})}];return this.state.isload?Object(V.jsx)(me.a,{tip:"Loading...",children:Object(V.jsx)(ge.a,{columns:n,rowKey:"createdAt",dataSource:e})}):Object(V.jsxs)("div",{children:[Object(V.jsx)(ge.a,{columns:n,rowKey:"createdAt",bordered:!0,dataSource:e,size:"small"}),Object(V.jsx)(Ke.a,{visible:t,title:"Enter Password",onOk:this.handleOk,onCancel:this.handleCancel,footer:[Object(V.jsx)(ye.a,{onClick:this.handleCancel,children:"Return"},"back"),Object(V.jsx)(ye.a,{type:"primary",loading:s,onClick:this.handleOk,children:" Submit"},"submit")],children:Object(V.jsx)(Ce.a,{type:"password",placeholder:"Enter the password",onChange:this.onChangePassword})})]})}}const zi={loadData:Oe,deleteProject:function(e,t,s){return{type:"DELETE_PROJECT",task_type:e,task_id:t,password:s}},dispatchUpdate:function(e,t){return{type:"SESSION_".concat(e.toUpperCase(),"_UPDATE"),[e]:t}}};var Wi=Object(o.b)((function(e){return{session_interactive:e.session_interactive,session_category:e.session_category,session_sequence:e.session_sequence,session_quality:e.session_quality}}),zi)(js.Form.create()(Ui));const Qi=de.a.TabPane;class Gi extends i.a.Component{constructor(e){super(e),this.showDrawer=()=>{this.setState({visible:!0})},this.onClose=()=>{this.setState({visible:!1})},this.state={visible:!1}}componentDidMount(){}render(){return console.log("HELP",this.state),Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{type:"primary",style:{float:"right",marginLeft:"10px"},onClick:this.showDrawer,children:[Object(V.jsx)(ae.a,{}),"Help"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsxs)(Ie.a,{title:"Interactive Tests",width:720,placement:"right",onClose:this.onClose,maskClosable:!0,visible:this.state.visible,style:{height:"calc(100% - 55px)",overflow:"auto",paddingBottom:53},children:[Object(V.jsx)(Se.a,{gutter:16,children:Object(V.jsx)("div",{children:Object(V.jsxs)(de.a,{defaultActiveKey:"intro",children:[Object(V.jsx)(Qi,{tab:Object(V.jsx)("span",{children:"Introduction"}),children:Object(V.jsx)("p",{children:'Here, you can create an interactive experience for the worker to directly speak to your dialog system. After the conversation, you can present the worker with a survey about their experience, for example, on a Likert scale. In addition, you can create an A/B test where the worker speaks with two dialog systems and can rate on the survey which system they preferred based on your specifications. You can click the "New Project" button to create a new project. If it us successfully created, you will see your project in the table. Please click the enter (edit) icon to start. We will provide an example for you to follow.'})},"intro"),Object(V.jsx)(Qi,{tab:Object(V.jsx)("span",{children:"Create"}),children:Object(V.jsx)(Qe.a,{source:'### 1) Project setting \nAfter creating a project, you need to design the experiment in detail, including a generic introduction, specific instructions, and exit polls. The exit polls can be one of three types: Likert scale, open-ended, and A/B testing which are presented in random order to the worker. DialCrowd allows you to either evaluate one system or more than one system in an A/B test by adding the systems during task creation. These will be shown to the worker also in random order. For non-interactive testing, JSON data, such as dialog logs, need to be added.\n\n\n### 2) Connect your spoken dialog systems\nIf you have not already done so, connect your dialog system in the "Add System" tab. After you have done so, input the name of the dialog system into the "Agent" slot during the system add. Create a name for the dialog system that will be shown to the worker in the "Name of Dialog System" slot. Add any specific instructions or questions for the worker in the following slots. \n### 3) Testing and Deploying\nAfter running the backend RESTful APIs, please input the backend API URL and check the connection in DialCrowd. If you have successfully connected to your dialog systems to DialCrowd you can preview the website that DialCrowd has automatically generated.'})},"create"),Object(V.jsx)("br",{}),Object(V.jsx)("br",{})]})})}),Object(V.jsx)("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"},children:Object(V.jsx)(ye.a,{style:{marginRight:8},onClick:this.onClose,children:"Close"})})]})]})}}var Vi=Gi;class Yi extends i.a.Component{constructor(e){super(e),this.state={dialogs:[]}}componentDidMount(){}render(){return Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{children:" Interactive Dialog Tasks "}),Object(V.jsxs)("div",{style:{display:"flex"},children:[Object(V.jsx)(Ni,{project:"interactive"}),Object(V.jsx)(Vi,{})]}),Object(V.jsx)(Wi,{data:this.props.data,history:this.props.history,url:"interactive"})]})}}var Ji=Object(o.b)((function(e){return{data:e.interactive}}),{})(Yi);const $i=de.a.TabPane;class Xi extends i.a.Component{constructor(e){super(e),this.showDrawer=()=>{this.setState({visible:!0})},this.onClose=()=>{this.setState({visible:!1})},this.state={visible:!1}}componentDidMount(){}render(){return Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{type:"primary",style:{float:"right",marginLeft:"10px"},onClick:this.showDrawer,children:[Object(V.jsx)(ae.a,{}),"Help"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsxs)(Ie.a,{title:"Category Classification",width:720,placement:"right",onClose:this.onClose,maskClosable:!0,visible:this.state.visible,style:{height:"calc(100% - 55px)",overflow:"auto",paddingBottom:53},children:[Object(V.jsx)(Se.a,{gutter:16,children:Object(V.jsx)("div",{children:Object(V.jsxs)(de.a,{defaultActiveKey:"intro",children:[Object(V.jsx)($i,{tab:Object(V.jsx)("span",{children:"Introduction"}),children:Object(V.jsx)("p",{children:'This tab is used for intent classification. During the task, the worker will be asked to choose an intent for the given dialog. You can click "New Project" to create a project. If it is successfully created, you will see your project in the table. Then, click the enter (edit) icon to start. We have provided an example that you can follow.'})},"intro"),Object(V.jsxs)($i,{tab:Object(V.jsx)("span",{children:"Create"}),children:[Object(V.jsx)(Qe.a,{source:"## 1) Basic Information \nIn order to setup the category classification, requesters fill out the background, generic insturctions, and number of sentences shown to each worker \n\n## 2) Upload your data\nFormat of Category Classification\nThe format of category classification is just sentences split by newline (\\n)\n```\nHas onihime vs been made into an anime\nWhat percent of 25 is 23\nWhat does C K mean\nHow do you say eggs with bacon and toast in spanish\nIs cat litter safe for concrete to melt ice\nU-235 and Pu-239 are both what\nDid Hannibal Lecter kill Allegra Pazzi\n```\n\n## 3) Add Class\nYou need to define class categories (e.g., inform, request, confirm, etc) and example sentences for workers.  \nThese exmaples will be shown in DialCrowd Workers. \n\n## 4) Save your project\n## 5) Test and deploy\nYou can download the format for uploading your data. You can preview the DialCrowd Worker's website. \n"}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{})]},"create")]})})}),Object(V.jsx)("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"},children:Object(V.jsx)(ye.a,{style:{marginRight:8},onClick:this.onClose,children:"Close"})})]})]})}}var Zi=Xi;class ea extends i.a.Component{constructor(e){super(e),this.state={dialogs:[]}}componentDidMount(){}render(){return console.log(this.props.data),console.log(this.props.history),Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{children:" Intent Classification Tasks"}),Object(V.jsxs)("div",{style:{display:"flex"},children:[Object(V.jsx)(Ni,{project:"category"}),Object(V.jsx)(Zi,{})]}),Object(V.jsx)(Wi,{data:this.props.data,history:this.props.history,url:"category"})]})}}var ta=Object(o.b)((function(e){return{data:e.category}}),{})(ea);const sa=de.a.TabPane;class na extends i.a.Component{constructor(e){super(e),this.showDrawer=()=>{this.setState({visible:!0})},this.onClose=()=>{this.setState({visible:!1})},this.state={visible:!1}}componentDidMount(){}render(){return Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{type:"primary",style:{float:"right",marginLeft:"10px"},onClick:this.showDrawer,children:[Object(V.jsx)(ae.a,{}),"Help"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsxs)(Ie.a,{title:"Sequence Labeling",width:720,placement:"right",onClose:this.onClose,maskClosable:!0,visible:this.state.visible,style:{height:"calc(100% - 55px)",overflow:"auto",paddingBottom:53},children:[Object(V.jsx)(Se.a,{gutter:16,children:Object(V.jsx)("div",{children:Object(V.jsxs)(de.a,{defaultActiveKey:"intro",children:[Object(V.jsx)(sa,{tab:Object(V.jsx)("span",{children:"Introduction"}),children:'The goal of this crowdsourcing feature is to categorize different types of entities. After entering the sequence labeing task, the worker will be asked to select specific words or a phrase in a sentence. Then, they will choose the corresponding type of entity that that phrase can be categorized into using the buttons below the sentence. If the worker is not sure which type of entity it belongs to, they will choose "other". You can click on the "New Project" button to create a new project with a name and password.  Once it is successfully created, you will see the new project in a table. Then, please click the enter (edit) icon to start, and we have provided a guide that you can follow.'},"intro"),Object(V.jsxs)(sa,{tab:Object(V.jsx)("span",{children:"Create"}),children:[Object(V.jsx)(Qe.a,{source:'## 1) Basic information \nIn order to setup a new sequence labeling project, requesters need to fill out the background and generic instructions. \n## (2) Upload your data\nThe data can be uploaded by uploading a .txt file that contains the sentences for the workers to analyze using sequence labeling. Separate the sentences with a newline in the txt file. \n## (3) Add Type of Entities\nBy clicking the "Add One More Category" button, the requester can add an entity type that workers will be able to select.\nThe requester will need to specify both the type and an example of the entity during creation.\n## (4) Save your Project\n## (5) Test and Deploy\nYou can preview your project with the "Preview" button to see what the workers will.\nAfter finishing the sequence labeling, workers will receive a code for the payment.\n'}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{})]},"create")]})})}),Object(V.jsx)("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"},children:Object(V.jsx)(ye.a,{style:{marginRight:8},onClick:this.onClose,children:"Close"})})]})]})}}var ia=na;class aa extends i.a.Component{constructor(e){super(e),this.state={dialogs:[]}}componentDidMount(){}render(){return Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{children:" Entity Classification Tasks"}),Object(V.jsxs)("div",{style:{display:"flex"},children:[Object(V.jsx)(Ni,{project:"sequence"}),Object(V.jsx)(ia,{})]}),Object(V.jsx)(Wi,{data:this.props.data,history:this.props.history,url:"sequence"})]})}}var ra=Object(o.b)((function(e){return{data:e.sequence}}),{})(aa);const oa=de.a.TabPane;class ca extends i.a.Component{constructor(e){super(e),this.showDrawer=()=>{this.setState({visible:!0})},this.onClose=()=>{this.setState({visible:!1})},this.state={visible:!1}}componentDidMount(){}render(){return Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{type:"primary",style:{float:"right",marginLeft:"10px"},onClick:this.showDrawer,children:[Object(V.jsx)(ae.a,{}),"Help"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsxs)(Ie.a,{title:"Category Classification",width:720,placement:"right",onClose:this.onClose,maskClosable:!0,visible:this.state.visible,style:{height:"calc(100% - 55px)",overflow:"auto",paddingBottom:53},children:[Object(V.jsx)(Se.a,{gutter:16,children:Object(V.jsx)("div",{children:Object(V.jsxs)(de.a,{defaultActiveKey:"intro",children:[Object(V.jsx)(oa,{tab:Object(V.jsx)("span",{children:"Introduction"}),children:Object(V.jsx)("p",{children:'This tab is used for intent classification. During the task, the worker will be asked to choose an intent for the given dialog. You can click "New Project" to create a project. If it is successfully created, you will see your project in the table. Then, click the enter (edit) icon to start. We have provided an example that you can follow.'})},"intro"),Object(V.jsxs)(oa,{tab:Object(V.jsx)("span",{children:"Create"}),children:[Object(V.jsx)(Qe.a,{source:"## 1) Basic Information \nIn order to setup the category classification, requesters fill out the background, generic insturctions, and number of sentences shown to each worker \n\n## 2) Upload your data\nFormat of Category Classification\nThe format of category classification is just sentences split by newline (\\n)\n```\nHas onihime vs been made into an anime\nWhat percent of 25 is 23\nWhat does C K mean\nHow do you say eggs with bacon and toast in spanish\nIs cat litter safe for concrete to melt ice\nU-235 and Pu-239 are both what\nDid Hannibal Lecter kill Allegra Pazzi\n```\n\n## 3) Add Class\nYou need to define class categories (e.g., inform, request, confirm, etc) and example sentences for workers.  \nThese exmaples will be shown in DialCrowd Workers. \n\n## 4) Save your project\n## 5) Test and deploy\nYou can download the format for uploading your data. You can preview the DialCrowd Worker's website. \n"}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{})]},"create")]})})}),Object(V.jsx)("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"},children:Object(V.jsx)(ye.a,{style:{marginRight:8},onClick:this.onClose,children:"Close"})})]})]})}}var la=ca;class da extends i.a.Component{constructor(e){super(e),this.state={dialogs:[]}}componentDidMount(){}render(){return Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{children:" Quality Check Tasks "}),Object(V.jsxs)("div",{style:{display:"flex"},children:[Object(V.jsx)(Ni,{project:"quality"}),Object(V.jsx)(la,{})]}),Object(V.jsx)(Wi,{data:this.props.data,history:this.props.history,url:"quality"})]})}}var ha=Object(o.b)((function(e){return{data:e.quality}}),{})(da);const ua=Ke.a.confirm;class pa extends i.a.Component{constructor(e){super(e),this.init=()=>{this.props.combine_data(this.props.interactive,this.props.category,this.props.sequence,this.props.quality)},this.onClose=()=>{this.setState({visible:!1})},this.onChangeInput=e=>{this.setState({inputText:e.target.value})},this.confirm=e=>{if(console.log(e),this.setState({MID:this.state.inputText,ID:e._id,type:e.type,visible:!0}),""!==this.state.inputText){let t=S+"/worker_"+e.type+"/?ID="+e._id+"&MID="+this.state.inputText;window.open(t)}else ua({title:"Error!",content:"Please Input your name",onOk(){},onCancel(){}})},this.getColumnSearchProps=e=>({filterDropdown:t=>{let{setSelectedKeys:s,selectedKeys:n,confirm:i,clearFilters:a}=t;return Object(V.jsxs)("div",{style:{padding:8},children:[Object(V.jsx)(Ce.a,{ref:e=>{this.searchInput=e},placeholder:"nickname"!==e?"Search project":"Search creator",value:n[0],onChange:e=>s(e.target.value?[e.target.value]:[]),onPressEnter:()=>this.handleSearch(n,i,e),style:{width:188,marginBottom:8,display:"block"}}),Object(V.jsx)(ye.a,{type:"primary",onClick:()=>this.handleSearch(n,i,e),icon:Object(V.jsx)(Li.a,{}),size:"small",style:{width:90,marginRight:8},children:"Search"}),Object(V.jsx)(ye.a,{onClick:()=>this.handleReset(a),size:"small",style:{width:90},children:"Reset"})]})},filterIcon:e=>Object(V.jsx)(Li.a,{style:{color:e?"#1890ff":void 0}}),onFilter:(t,s)=>s[e].toString().toLowerCase().includes(t.toLowerCase()),onFilterDropdownVisibleChange:e=>{e&&setTimeout((()=>this.searchInput.select()))},render:t=>this.state.searchedColumn===e?Object(V.jsx)(Hi.a,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[this.state.searchText],autoEscape:!0,textToHighlight:t.toString()}):t}),this.handleSearch=(e,t,s)=>{t(),this.setState({searchText:e[0],searchedColumn:s})},this.handleReset=e=>{e(),this.setState({searchText:""})},this.state={data:[],inputText:"",visible:!1,ID:"",MID:"",type:""}}componentDidMount(){this.init()}render(){this.props.all.length>0&&this.props.all.sort((function(e,t){return e.project.localeCompare(t.project)}));const e=[{title:"Title",dataIndex:"project",key:"project",sorter:(e,t)=>e.name.localeCompare(t.name),...this.getColumnSearchProps("name")},{title:"Requester",dataIndex:"user",key:"user",sorter:(e,t)=>e.name.localeCompare(t.name),...this.getColumnSearchProps("name")},{title:"Type",dataIndex:"type",key:"type"},{title:"Action",dataIndex:"",key:"x",render:e=>Object(V.jsx)(ps.a,{title:Object(V.jsxs)("span",{children:[Object(V.jsx)("h1",{children:"Do you want to work on this HIT?"}),Object(V.jsx)("p",{children:'"Please type the user name"'}),Object(V.jsx)(Ce.a,{placeholder:"User Name",value:this.state.inputText,onChange:this.onChangeInput})]}),onConfirm:()=>this.confirm(e),onCancel:this.cancel,okText:"Yes",cancelText:"No",children:Object(V.jsx)("a",{children:"Accept & Work"})})}];return Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{children:" All Public HITs "}),Object(V.jsx)(ye.a,{onClick:this.init,children:" Refresh"}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)(ge.a,{rowKey:"_id",columns:e,bordered:!0,expandedRowRender:e=>Object(V.jsxs)("div",{children:[Object(V.jsx)("h4",{children:"Background"}),Object(V.jsx)("p",{style:{margin:0},children:e.generic_introduction}),Object(V.jsx)("p",{}),Object(V.jsx)("h4",{children:"Instructions"}),Object(V.jsx)("p",{style:{margin:0},children:e.generic_instructions})]}),dataSource:this.props.all})]})}}const ja={combine_data:function(e,t,s,n){let i=[];return e.forEach(((e,t)=>{e.deploy&&i.push({type:"interactive",_id:e._id,generic_instructions:e.generic_instructions,generic_introduction:e.generic_introduction,project:e.name,user:e.nickname})})),t.forEach(((e,t)=>{e.deploy&&i.push({type:"category",_id:e._id,generic_instructions:e.generic_instructions,generic_introduction:e.generic_introduction,project:e.name,user:e.nickname})})),s.forEach(((e,t)=>{e.deploy&&i.push({type:"sequence",_id:e._id,generic_instructions:e.generic_instructions,generic_introduction:e.generic_introduction,project:e.name,user:e.nickname})})),n.forEach(((e,t)=>{e.deploy&&i.push({type:"quality",_id:e._id,generic_instructions:e.generic_instructions,generic_introduction:e.generic_introduction,project:e.name,user:e.nickname})})),{type:"COM_ALL",List:i}}};var ba=Object(o.b)((function(e){return{interactive:e.interactive,sequence:e.sequence,category:e.category,quality:e.quality,all:e.all}}),ja)(pa),ma=s(568);const{Option:xa}=Ue.a;class ya extends i.a.Component{constructor(e){super(e),this.showDrawer=()=>{this.setState({visible:!0})},this.handleSubmit=e=>{e.preventDefault(),this.props.form.validateFields(((e,t)=>{e||console.log("Received values of form: ",t)}))},this.handleConfirmBlur=e=>{const t=e.target.value;this.setState({confirmDirty:this.state.confirmDirty||!!t})},this.compareToFirstPassword=(e,t,s)=>{const n=this.props.form;t&&t!==n.getFieldValue("password")?s("Two passwords that you enter is inconsistent!"):s()},this.validateToNextPassword=(e,t,s)=>{const n=this.props.form;t&&this.state.confirmDirty&&n.validateFields(["confirm"],{force:!0}),s()},this.state={visible:!1}}componentDidMount(){}render(){const{getFieldDecorator:e}=this.props.form;return Object(V.jsx)("div",{children:Object(V.jsxs)(Ie.a,{title:"Create",width:720,placement:"right",onClose:this.props.onClose,maskClosable:!0,visible:this.props.visible,style:{height:"calc(100% - 55px)",overflow:"auto",paddingBottom:53},children:[Object(V.jsxs)(je.a,{layout:"vertical",hideRequiredMark:!0,children:[Object(V.jsxs)(Se.a,{gutter:16,children:[Object(V.jsx)(st.a,{span:12,children:Object(V.jsx)(je.a.Item,{label:"System Name",children:e("name",{initialValue:this.props.data.name,rules:[{required:!0,message:"please enter user name"}]})(Object(V.jsx)(Ce.a,{placeholder:"please enter user name"}))})}),Object(V.jsx)(st.a,{span:12,children:Object(V.jsx)(je.a.Item,{label:"Url",children:e("url",{initialValue:this.props.data.url,rules:[{required:!0,message:"please enter url"}]})(Object(V.jsx)(Ce.a,{style:{width:"100%"},addonBefore:"http://",placeholder:"please enter url"}))})})]}),Object(V.jsxs)(Se.a,{gutter:16,children:[Object(V.jsx)(st.a,{span:12,children:Object(V.jsx)(je.a.Item,{label:"User",children:e("user",{initialValue:this.props.data.user,rules:[{required:!0,message:"Please select an owner"}]})(Object(V.jsx)(Ce.a,{style:{width:"100%"},placeholder:"please enter user name"}))})}),Object(V.jsx)(st.a,{span:12,children:Object(V.jsx)(je.a.Item,{label:Object(V.jsxs)("span",{children:["Type\xa0",Object(V.jsx)(xe.a,{title:"Only public systems will be able to be selected for Interaction tasks.",children:Object(V.jsx)(ae.a,{})})]}),children:e("type",{initialValue:this.props.data.type,rules:[{required:!0,message:"Please choose the type"}]})(Object(V.jsxs)(Ue.a,{placeholder:"Please choose the type",children:[Object(V.jsx)(xa,{value:"private",children:"Private"}),Object(V.jsx)(xa,{value:"public",children:"Public"})]}))})})]}),Object(V.jsx)(Se.a,{gutter:16,children:Object(V.jsx)(st.a,{span:12,children:Object(V.jsx)(je.a.Item,{label:"Organization",children:e("org",{initialValue:this.props.data.org,rules:[{required:!0,message:"Please choose the organization"}]})(Object(V.jsx)(Ce.a,{style:{width:"100%"},placeholder:"please enter your organization"}))})})}),Object(V.jsx)(Se.a,{gutter:16,children:Object(V.jsx)(st.a,{span:12,children:Object(V.jsx)(je.a.Item,{label:"Github page",children:e("github",{initialValue:this.props.data.github,rules:[{required:!0,message:"Please enter the github"}]})(Object(V.jsx)(Ce.a,{style:{width:"100%"},placeholder:"http://github.com/<organization_id>"}))})})}),Object(V.jsx)(Se.a,{gutter:16,children:Object(V.jsx)(st.a,{span:24,children:Object(V.jsx)(je.a.Item,{label:"Description",children:e("desc",{initialValue:this.props.data.desc,rules:[{required:!0,message:"please enter url description"}]})(Object(V.jsx)(Ce.a.TextArea,{rows:4,placeholder:"please enter description"}))})})}),Object(V.jsxs)(Se.a,{gutter:16,children:[Object(V.jsx)(st.a,{span:12,children:Object(V.jsx)(je.a.Item,{label:"Password",children:e("password",{rules:[{required:!0,message:"Please input your password!"},{validator:this.validateToNextPassword}]})(Object(V.jsx)(Ce.a,{type:"password"}))})}),Object(V.jsx)(st.a,{span:12,children:Object(V.jsx)(je.a.Item,{label:"Confirm Password",children:e("confirm",{rules:[{required:!0,message:"Please confirm your password!"},{validator:this.compareToFirstPassword}]})(Object(V.jsx)(Ce.a,{type:"password",onBlur:this.handleConfirmBlur}))})})]})]}),Object(V.jsxs)("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"},children:[Object(V.jsx)(ye.a,{style:{marginRight:8},onClick:this.props.onClose,children:"Close"}),Object(V.jsx)(ye.a,{onClick:this.props.submit,type:"primary",children:"Submit"})]})]})})}}var ga=ya;const fa=de.a.TabPane;class Oa extends i.a.Component{constructor(e){super(e),this.showDrawer=()=>{this.setState({visible:!0})},this.onClose=()=>{this.setState({visible:!1})},this.state={visible:!1}}componentDidMount(){}render(){return Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{type:"primary",style:{float:"right",marginLeft:"10px"},onClick:this.showDrawer,children:[Object(V.jsx)(ae.a,{}),"Help"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsxs)(Ie.a,{title:"How to create and connect a system",width:720,placement:"right",onClose:this.onClose,maskClosable:!0,visible:this.state.visible,style:{height:"calc(100% - 55px)",overflow:"auto",paddingBottom:53},children:[Object(V.jsx)(Se.a,{gutter:16,children:Object(V.jsx)("div",{children:Object(V.jsxs)(de.a,{defaultActiveKey:"intro",children:[Object(V.jsxs)(fa,{tab:Object(V.jsx)("span",{children:"Introduction"}),children:[Object(V.jsx)("p",{children:"In order to connect to DialCrowd, a dialog system needs to have an HTTP server waiting for utterances directed from DialCrowd through specific protocols. We have made connecting to DialCrowd extremely easy for anyone with basic programming knowledge by providing them with off-the-shelf server wrapper templates in three mainstream programming languages: Java, Python, and JavaScript. This HTTP API communication protocol is the same as DialPort. Thus, if your dialog system is already used for evaluation in DialCrowd, it is also ready for collection in DialPort. "}),Object(V.jsx)("p",{children:"Following the DialCrowd communication protocols, the Java, Python, and JavaScript server wrappers are implemented with the Spark, Flask, and Node.js frameworks respectively. In this way, we completely hide the implementation of RESTful APIs from the users. As a result, users only need to implement an HTTP API server that supports three RESTful APIs: /init, /next, and /end."})]},"intro"),Object(V.jsxs)(fa,{tab:Object(V.jsx)("span",{children:"Create"}),children:[Object(V.jsx)("h4",{children:"Create A Remote Dialog System"}),Object(V.jsxs)("p",{children:["To start, you can download a ",Object(V.jsx)("a",{href:"https://github.com/DialRC/PortalAPI/tree/master/PortalAPIforPythonFlask",target:"_blank",children:"dialog system skeleton "}),"in the language of your choice. There are three APIs you can edit:"]}),Object(V.jsx)("p",{children:"1. Start a new session with your dialog system. If successful, the server will return a JSON containing the sessionID."}),Object(V.jsx)("p",{children:"URL"}),Object(V.jsx)(Qe.a,{source:"```\n/init\n```"}),Object(V.jsx)("p",{children:"Method:"}),Object(V.jsx)(Qe.a,{source:"```\n/POST\n```"}),Object(V.jsx)("p",{children:"Body Data"}),Object(V.jsx)(Qe.a,{source:'```json\n{"sessionID":"USR_1234", "timeStamp": "yyyy-MM-dd\'T\'HH-mm-ss.SSS" }\n```'}),Object(V.jsx)("p",{children:"Success Response (200)"}),Object(V.jsx)(Qe.a,{source:'{\n  "sessionID": "USR_1234",\n  "sys": "This word starts with A",\n  "version": "1.0-xxx",\n  "timeStamp": "yyyy-MM-dd\'T\'HH-mm-ss.SSS",\n  "terminal": false\n}'}),Object(V.jsx)("p",{children:"2. For an ongoing session, the portal will use this API to obtain the next system response from your dialog system."}),Object(V.jsx)("p",{children:"URL"}),Object(V.jsx)(Qe.a,{source:"```\n/next\n```"}),Object(V.jsx)("p",{children:"Method:"}),Object(V.jsx)(Qe.a,{source:"```\n/POST\n```"}),Object(V.jsx)("p",{children:"Body Data"}),Object(V.jsx)(Qe.a,{source:'```json\n{\n    "sessionID": "USR_1234",\n    "text": "I guess the answer is APPLE", \n    "asrConf": 0.9,\n    "timeStamp": "yyyy-MM-dd\'T\'HH-mm-ss.SSS"\n}\n```'}),Object(V.jsx)("p",{children:"Success Response (200)"}),Object(V.jsx)(Qe.a,{source:'```json\n{\n  "sessionID": "USR_1234",\n  "sys": "This word starts with A",\n  "version": "1.0-xxx",\n  "timeStamp": "yyyy-MM-dd\'T\'HH-mm-ss.SSS",\n  "terminal": false\n}\n```'}),Object(V.jsx)("p",{children:"3. The portal sometimes (very rarely) wants to terminate an ongoing session with your dialog system (e.g. due to a lost connection, conversation failure, etc.)."}),Object(V.jsx)("p",{children:"URL"}),Object(V.jsx)(Qe.a,{source:"```\n/end\n```"}),Object(V.jsx)("p",{children:"Method:"}),Object(V.jsx)(Qe.a,{source:"```\n/POST\n```"}),Object(V.jsx)("p",{children:"Body Data"}),Object(V.jsx)(Qe.a,{source:'```json\n{\n    "sessionID": "USR_1234",\n    "timeStamp": "yyyy-MM-dd\'T\'HH-mm-ss.SSS"\n}\n```'}),Object(V.jsx)("p",{children:"Success Response (200)"}),Object(V.jsx)(Qe.a,{source:'```json\n{\n  "sessionID": "USR_1234",\n  "sys": "Goodbye",\n  "version": "1.0-xxx",\n  "timeStamp": "yyyy-MM-dd\'T\'HH-mm-ss.SSS",\n  "terminal": true\n}\n```'}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{})]},"create"),Object(V.jsxs)(fa,{tab:Object(V.jsx)("span",{children:"Connect"}),children:[Object(V.jsx)("h4",{children:"Connect A Remote Dialog System"}),Object(V.jsx)("p",{children:"The main piece of information you will need from your remote server is the URL address for DialCrowd to send POST requests to. Fill out this information when you are creating the dialog system connection on DialCrowd with the Create button and you will be all set!"}),Object(V.jsx)("p",{children:"To test your system connection, you can click the speech bubble with three dots in the right side of your system's entry in the table and proceed to chat with it if the connection has been made."})]},"connect")]})})}),Object(V.jsx)("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"},children:Object(V.jsx)(ye.a,{style:{marginRight:8},onClick:this.onClose,children:"Close"})})]})]})}}var va=Oa;function wa(e,t,s){console.log(I),fetch(I+"/api/save/system/"+s,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(t){"success"===t.message?(be.a.success("Success"),e.props.newSystem()):be.a.success("Fail")}))}class ka extends i.a.Component{constructor(e){super(e),this.showbotconfigure=()=>{this.setState({data:{},configure_visible:!0}),this.props.form.resetFields()},this.showDrawer=e=>{console.log(e);let t=S+"/chat?userID=dialCrowd_Testing&subId=DialCrowd_subjectId&option=both&ip="+e;this.setState({visible:!0,url:t})},this.onClose=()=>{this.setState({visible:!1})},this.onConfigureClose=()=>{this.setState({configure_visible:!1})},this.editConfig=e=>{console.log(e),this.props.form.resetFields(),this.setState({data:e,configure_visible:!0})},this.onChangeInput=e=>{this.setState({inputText:e.target.value})},this.confirm=e=>{console.log(e),e.password===this.state.inputText?(this.setState({inputText:""}),this.props.form.resetFields(),this.setState({data:e,configure_visible:!0})):(be.a.error("Please check your password or contact: linh@hhu.de"),this.setState({inputText:""}))},this.cancel=e=>{console.log(e),this.setState({inputText:""})},this.submit=e=>{e.preventDefault(),this.props.form.validateFields(((e,t)=>{e||(console.log("Received values of form: ",t),this.state.data._id?wa(this,t,this.state.data._id):wa(this,t,"new"),this.onConfigureClose())}))},this.getColumnSearchProps=e=>({filterDropdown:t=>{let{setSelectedKeys:s,selectedKeys:n,confirm:i,clearFilters:a}=t;return Object(V.jsxs)("div",{style:{padding:8},children:[Object(V.jsx)(Ce.a,{ref:e=>{this.searchInput=e},placeholder:"nickname"!==e?"Search project":"Search creator",value:n[0],onChange:e=>s(e.target.value?[e.target.value]:[]),onPressEnter:()=>this.handleSearch(n,i,e),style:{width:188,marginBottom:8,display:"block"}}),Object(V.jsx)(ye.a,{type:"primary",onClick:()=>this.handleSearch(n,i,e),icon:Object(V.jsx)(Li.a,{}),size:"small",style:{width:90,marginRight:8},children:"Search"}),Object(V.jsx)(ye.a,{onClick:()=>this.handleReset(a),size:"small",style:{width:90},children:"Reset"})]})},filterIcon:e=>Object(V.jsx)(Li.a,{style:{color:e?"#1890ff":void 0}}),onFilter:(t,s)=>s[e].toString().toLowerCase().includes(t.toLowerCase()),onFilterDropdownVisibleChange:e=>{e&&setTimeout((()=>this.searchInput.select()))},render:t=>this.state.searchedColumn===e?Object(V.jsx)(Hi.a,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[this.state.searchText],autoEscape:!0,textToHighlight:t.toString()}):t}),this.handleSearch=(e,t,s)=>{t(),this.setState({searchText:e[0],searchedColumn:s})},this.handleReset=e=>{e(),this.setState({searchText:""})},this.state={visible:!1,configure_visible:!1,url:"",data:{},inputText:""}}render(){this.props.system.length>0&&this.props.system.sort((function(e,t){return e.name.localeCompare(t.name)}));const e=[{title:"System Name",dataIndex:"name",key:"name",width:"20%",sorter:(e,t)=>e.name.localeCompare(t.name),...this.getColumnSearchProps("name")},{title:"Organization",dataIndex:"org",key:"org",width:"20%",sorter:(e,t)=>e.name.localeCompare(t.name),...this.getColumnSearchProps("name")},{title:"Description",dataIndex:"desc",key:"desc"},{title:"Type",dataIndex:"type",key:"type",width:"15%"},{title:"",key:"action",width:"15%",render:(e,t)=>Object(V.jsxs)("span",{children:[Object(V.jsx)(ye.a,{shape:"circle",disabled:!t.github,children:Object(V.jsx)("a",{href:t.github,target:"_blank",children:Object(V.jsx)(ma.a,{})})}),Object(V.jsx)(Ne.a,{type:"vertical"}),Object(V.jsx)(ps.a,{title:Object(V.jsxs)("span",{children:[Object(V.jsx)("h3",{children:"Password"}),Object(V.jsx)("p",{children:'"Please type in the password of this system"'}),Object(V.jsx)(Ce.a,{placeholder:"Password",value:this.state.inputText,onChange:this.onChangeInput})]}),onConfirm:()=>this.confirm(t),onCancel:this.cancel,okText:"Yes",cancelText:"No",children:Object(V.jsx)(ye.a,{shape:"circle",children:Object(V.jsx)(_e.a,{})})}),Object(V.jsx)(Ne.a,{type:"vertical"}),Object(V.jsx)(ye.a,{shape:"circle",onClick:()=>this.showDrawer(t.url),children:Object(V.jsx)(ee.a,{})})]})}];return Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{children:" Dialog Systems for Testing"}),Object(V.jsx)(Ie.a,{placement:"right",width:720,closable:!1,onClose:this.onClose,visible:this.state.visible,children:Object(V.jsx)(rt.a,{style:{"margin-right":"10px"},url:this.state.url,width:"90%",height:"700px",display:"initial",position:"relative",allowFullScreen:!0})}),Object(V.jsxs)("div",{style:{display:"flex"},children:[Object(V.jsxs)(ye.a,{onClick:this.showbotconfigure,children:[Object(V.jsx)(Ei.a,{}),"Create"]}),Object(V.jsx)(va,{})]}),Object(V.jsx)(ga,{visible:this.state.configure_visible,onClose:this.onConfigureClose,data:this.state.data,submit:this.submit,form:this.props.form}),Object(V.jsx)(ge.a,{rowKey:"_id",columns:e,bordered:!0,dataSource:this.props.system})]})}}const Ia={newSystem:function(){return{type:"NEW_SYSTEM"}}};var Sa=Object(o.b)((function(e){return{system:e.system}}),Ia)(js.Form.create()(ka));class Ca extends i.a.Component{constructor(e){super(e),this.state={dialogs:[]}}render(){return Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{children:" People "}),Object(V.jsx)("p",{children:"Jessica Huynh, Carnegie Mellon University"}),Object(V.jsx)("p",{children:"Ting-Rui Chiang, Carnegie Mellon University"}),Object(V.jsxs)("p",{children:[Object(V.jsx)("a",{href:"http://www.cs.cmu.edu/~kyusongl/",target:"_blank",rel:"noopener noreferrer",children:"Kyusong Lee"}),", Carnegie Mellon University"]}),Object(V.jsxs)("p",{children:[Object(V.jsx)("a",{href:"http://www.cs.cmu.edu/~awb/",target:"_blank",rel:"noopener noreferrer",children:"Maxine Eskenazi"}),", Carnegie Mellon University "]}),Object(V.jsxs)("p",{children:[Object(V.jsx)("a",{href:"https://www.cs.cmu.edu/~jbigham/",target:"_blank",rel:"noopener noreferrer",children:"Jeffrey Bigham"}),", Carnegie Mellon University "]}),Object(V.jsx)("h1",{children:" Publications "}),Object(V.jsxs)("p",{children:["Kyusong Lee, Tiancheng Zhao, Alan W Black and Maxine Eskenazi ",Object(V.jsx)("a",{href:"http://aclweb.org/anthology/W18-5028",target:"_blank",rel:"noopener noreferrer",children:"DialCrowd: A toolkit for easy dialog system assessment"}),". Proceedings of the International Conference on Spoken Dialogue Systems Technology (SIGDIAL 2018) [DEMO PAPER], July 2018, Melbourne"]}),Object(V.jsx)("p",{children:Object(V.jsx)("a",{href:"https://scholar.googleusercontent.com/scholar.bib?q=info:G7D4V4hp5xkJ:scholar.google.com/&output=citation&scisig=AAGBfm0AAAAAW2aMLYe-N7TdJioOXsEjSn0HCTsTlM8Y&scisf=4&ct=citation&cd=-1&hl=en",target:"_blank",rel:"noopener noreferrer",children:"[BibTeX]"})}),Object(V.jsx)("h1",{children:" Questions "}),Object(V.jsx)("p",{children:" Contact at kyusonglee@gmail.com "})]})}}var _a=Ca,Ta=s(1267);const Da=je.a.Item;let qa=0;class Aa extends i.a.Component{constructor(e){super(e),this.remove=e=>{const{form:t}=this.props,s=t.getFieldValue("keys");1!==s.length&&t.setFieldsValue({keys:s.filter((t=>t!==e))})},this.add=()=>{const{form:e}=this.props,t=e.getFieldValue("keys").concat(qa);qa++,e.setFieldsValue({keys:t})},this.handleSubmit=e=>{e.preventDefault(),this.props.form.validateFields(((e,t)=>{e||(!function(e,t){console.log(t);let s=t.sents,n={};s.forEach(((e,t)=>{n[t]=[],s[t].split("\n").forEach((e=>{n[t].push(e)}))}));let i=t.unlabeled.split("\n");fetch("http://128.2.211.58:4455/v1/cluster",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",authorization:"api_key"},body:JSON.stringify({clusters:n,unlabeled:i,model:"inferSent"})}).then((function(e){return e.json()})).then((function(t){console.log(t),e.setState({result:t})}))}(this,t),console.log("Received values of form: ",t))}))},this.state={result:{}}}componentDidMount(){console.log("intractive open")}render(){const{getFieldDecorator:e,getFieldValue:t}=this.props.form,s={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},i={wrapperCol:{xs:{span:24,offset:0},sm:{span:20,offset:4}}};e("keys",{initialValue:[]});const a=t("keys"),r=a.map(((t,i)=>Object(n.createElement)(Da,{...s,label:"Cluster "+i.toString(),required:!1,key:t},e("sents[".concat(t,"]"),{validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please input sentences"}]})(Object(V.jsx)(Ce.a.TextArea,{placeholder:"Input sentences",style:{width:"80%",marginRight:8},autosize:{minRows:4,maxRows:10}})),a.length>1?Object(V.jsx)(He.a,{className:"dynamic-delete-button",disabled:1===a.length,onClick:()=>this.remove(t)}):null)));return Object(V.jsxs)("div",{children:[Object(V.jsxs)(je.a,{onSubmit:this.handleSubmit,children:[Object(V.jsx)(Da,{...s,label:"Unlabeled Data",children:e("unlabeled",{validateTrigger:["onChange","onBlur"],rules:[{required:!0,whitespace:!0,message:"Please input sentences"}]})(Object(V.jsx)(Ce.a.TextArea,{placeholder:"Input sentences",style:{width:"80%",marginRight:8},autosize:{minRows:4,maxRows:10}}))}),r,Object(V.jsx)(Da,{...i,children:Object(V.jsxs)(ye.a,{type:"dashed",onClick:this.add,style:{width:"80%"},children:[Object(V.jsx)(Be.a,{}),"Add field"]})}),Object(V.jsx)(Da,{...i,children:Object(V.jsx)(ye.a,{type:"primary",htmlType:"submit",children:"Clustering"})})]}),Object.keys(this.state.result).length>0?Object(V.jsx)(et.a,{children:Object.keys(this.state.result).map(((e,t)=>Object(V.jsx)(et.a.Panel,{header:"cluster "+e,children:this.state.result[e].map((e=>Object(V.jsxs)("div",{children:[Object(V.jsx)(Ta.a,{color:"orange",children:Math.round(100*e.score)/100}),Object(V.jsx)($e.a,{children:e.sent})]})))},t)))}):null]})}}var Pa=Object(o.b)((function(e){return{session:e.session_category}}),{})(je.a.create()(Aa));const Ea=js.Form.Item;class Fa extends i.a.Component{constructor(e){super(e),this.showDrawer=()=>{this.setState({visible:!0})},this.onClose=()=>{this.setState({visible:!1})},this.handleSubmit=e=>{e.preventDefault(),this.props.form.validateFields(((e,t)=>{e?console.log(e):(console.log("values",t),this.setState({final:!0,reason:t.instruction}))}))},this.return=e=>{this.setState({final:!1,reason:""})},this.state={visible:!1,final:!1,reason:""}}componentDidMount(){}render(){const{getFieldDecorator:e}=this.props.form,t=this.state.reason;return Object(V.jsxs)("div",{children:[Object(V.jsxs)(ye.a,{type:"primary",style:{float:"left"},onClick:this.showDrawer,children:[Object(V.jsx)(_e.a,{}),"Template"]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsxs)(Ie.a,{title:"Template",width:720,placement:"right",onClose:this.onClose,maskClosable:!0,visible:this.state.visible,style:{height:"calc(100% - 55px)",overflow:"auto",paddingBottom:53},children:[Object(V.jsx)(Se.a,{gutter:16,children:Object(V.jsx)("div",{children:this.state.final?Object(V.jsxs)("div",{children:[Object(V.jsxs)("span",{children:[" Dear Worker, ",Object(V.jsx)("br",{}),"Unfortunately, we have decided to reject your HIT for the following reason: ",Object(V.jsx)("br",{}),t," ",Object(V.jsx)("br",{}),"Please reach out to us if you would like to redo the HIT after fixing this error.  Thank you."]}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)(ye.a,{type:"primary",onClick:this.return,children:"Return"})]}):Object(V.jsxs)(js.Form,{onSubmit:this.handleSubmit,children:[Object(V.jsx)(Ea,{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}},label:Object(V.jsxs)("span",{children:["Reason\xa0",Object(V.jsx)(xe.a,{title:"Please write the specific instruction stated that the worker did not follow, or the specific evaluation metric stated that was failed",children:Object(V.jsx)(ae.a,{})})]}),required:!0,children:e("instruction",{validateTrigger:["onChange","onBlur"]})(Object(V.jsx)(Ce.a,{placeholder:"specific instruction not followed/specific metric not passed",style:{width:"90%",marginRight:8}}))}),Object(V.jsx)(ye.a,{type:"primary",htmlType:"submit",children:"Submit"})]})})}),Object(V.jsx)("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"},children:Object(V.jsx)(ye.a,{style:{marginRight:8},onClick:this.onClose,children:"Close"})})]})]})}}var Ma=js.Form.create()(Fa);class Ra extends i.a.Component{constructor(e){super(e),this.state={dialogs:[]}}render(){return Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{children:"Qualification Tests and Worker Requirements"}),Object(V.jsxs)("u1",{children:[Object(V.jsxs)("li",{children:[Object(V.jsx)("a",{href:"https://blog.mturk.com/tutorial-understanding-requirements-and-qualifications-99a26069fba2",children:"Worker requirements"})," allow you to filter workers by HIT approval rate, number of HITs approved, etc., which can help you select more experienced workers"]}),Object(V.jsxs)("li",{children:[Object(V.jsx)("a",{href:"https://docs.aws.amazon.com/AWSMechTurk/latest/AWSMechanicalTurkRequester/Concepts_QualificationsArticle.html#qualification-tests",children:"Qualification Tests"})," allow you to ask the worker a set of questions and depending on their answers, will assign a certain qualification type to them, which may allow or exclude them from doing the HIT"]}),Object(V.jsx)("li",{children:"If you have a prior relationship with the worker, you can automatically assign qualification types beforehand as well"})]}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Rejecting a HIT vs. Blocking a Worker"}),Object(V.jsxs)("u1",{children:[Object(V.jsx)("li",{children:"Both actions can negatively impact both your and the worker's reputation, so use them with caution"}),Object(V.jsxs)("li",{children:[Object(V.jsx)("b",{children:"Rejecting"})," a HIT means that the worker will not be paid, but they could potentially work on your future HITs"]}),Object(V.jsxs)("li",{children:[Object(V.jsx)("b",{children:"Blocking"})," a worker excludes them from all of your future HITs"]}),Object(V.jsxs)("li",{children:["Both ",Object(V.jsx)("a",{href:"https://docs.aws.amazon.com/AWSMechTurk/latest/RequesterUI/ReversingRejectedAssignment.html",children:"rejecting "}),"and ",Object(V.jsx)("a",{href:"https://docs.aws.amazon.com/AWSMechTurk/latest/RequesterUI/UnblockingaWorker.html",children:"blocking"})," can be reversed"]})]}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Informing workers why a HIT was rejected"}),Object(V.jsxs)("u1",{children:[Object(V.jsxs)("li",{children:["When you reject a HIT, you should provide ",Object(V.jsx)("b",{children:"sufficient reason why"})]}),Object(V.jsx)("li",{children:"We provide a template which can generate sample responses below"})]}),Object(V.jsx)("br",{}),Object(V.jsx)(Ma,{}),Object(V.jsx)("h1",{children:"Addressing Appeals"}),Object(V.jsxs)("u1",{children:[Object(V.jsxs)("li",{children:["When you receive an appeal from a worker about a rejected HIT, it is important to address their email in a ",Object(V.jsx)("b",{children:"timely manner"})]}),Object(V.jsx)("li",{children:"If your initial response when rejecting the HIT was not clear, clarify which instruction or evaluation metric was not followed"}),Object(V.jsx)("li",{children:"If you have made a mistake, be sure to overturn the rejection once you have confirmed that"})]}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Contacting Amazon about bots"}),Object(V.jsxs)("u1",{children:[Object(V.jsxs)("li",{children:["When you discover a bot, you can contact Amazon Mechanical Turk through this ",Object(V.jsx)("a",{href:"https://support.aws.amazon.com/#/contacts/aws-mechanical-turk",children:"form"})]}),Object(V.jsx)("li",{children:'You can also click on "Report this HIT" in the Mechanical Turk interface'})]}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Turker Forums"}),Object(V.jsxs)("u1",{children:[Object(V.jsxs)("li",{children:[Object(V.jsx)("a",{href:"https://turkopticon.ucsd.edu",children:"Turkopticon"}),", which allows you review requesters based on communicativity, generosity, fairness, and promptness"]}),Object(V.jsxs)("li",{children:[Object(V.jsx)("a",{href:"https://forum.turkerview.com",children:"TurkerView"}),", where workers can review specific tasks from requesters"]}),Object(V.jsx)("li",{children:"These forums are important for a requester's reputation, so responding to workers' feedback and engaging with them to improve your HIT should be remembered"})]}),Object(V.jsx)("br",{}),Object(V.jsx)("h1",{children:"Best Practices"}),Object(V.jsxs)("u1",{children:[Object(V.jsx)("li",{children:"For the first 20 or so minutes after you have released your HIT, monitor your email for any questions from workers"}),Object(V.jsxs)("li",{children:["Be sure to check your ",Object(V.jsx)("b",{children:"AMT email"})," regularly in order to keep lines of communication open with the workers"]}),Object(V.jsx)("li",{children:"Incorporate any feedback you receive as needed to ensure workers can complete your HIT to the best they can"}),Object(V.jsxs)("li",{children:["Approve or reject HITs in a ",Object(V.jsx)("b",{children:"timely manner"})]}),Object(V.jsx)("li",{children:"If your HIT involves a long open response question, be sure to state that in the title of your HIT, or in the general instructions on AMT"})]})]})}}var Na=Ra,Ba=s(563);const Ha=de.a.TabPane;class La extends n.Component{constructor(e){super(e)}render(){return Object(V.jsxs)("div",{children:[Object(V.jsx)("div",{children:"We provide an in depth walkthrough of a generic task in DialCrowd. This includes the intent and entity classifications as well as the quality annotation. The wording may be slightly different across tasks, but the general functionality remains the same. Screenshots are taken from the quality annotation task."}),Object(V.jsxs)(de.a,{defaultActiveKey:"1",children:[Object(V.jsx)(Ha,{tab:"General Configuration",children:Object(V.jsxs)("div",{children:[Object(V.jsx)("img",{src:"/img/config.png",style:{border:"1px solid black"}}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"Load configuration from file"}),Object(V.jsx)("div",{children:"After you finish configuring any task, you are able to save its configuration in JSON format (button located at the bottom of the configure page). To start a new task with a similar configuration, you can upload that JSON file here and the task will automatically populate with your original fields. You can then make small changes wherever needed."}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"Background"}),Object(V.jsx)("div",{children:"In order to give your workers some knowledge about your task, you can fill out a short background on why you are doing this task, the objective you aim to fulfill, etc."}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"General Instructions"}),Object(V.jsx)("div",{children:"This is where you will put any instructions you wish to provide to the workers. For example, the overall steps you wish the worker to complete the task in, what to label, etc. Instructions should be specific, easy to read, and address any specific actions workers should do wheh completing your HIT. Stating any evaluation criteria that you are looking for in each HIT may also prevent the need for HIT rejections and attract workers who will complete the HIT accordingly. We also provide a link to a guide given by Amazon Mechanical Turk about best practices in creating clear and concise instructions."}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"Time (minutes/HIT)"}),Object(V.jsx)("div",{children:"Here, you can fill out how many minutes you expect each HIT to take. We suggest that before making your HIT available to workers, you should test your HIT with your colleagues in order to obtain a more accurate time estimate."}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"Payment (USD/HIT)"}),Object(V.jsx)("div",{children:"Based on the time you estimate, you will want to put in the payment for the workers per HIT. We suggest an hourly wage of $15 so that workers can earn a fair wage, and there will be a popup that automatically calculates this for you if needed. There is by no means a requirement to use our suggested hourly wage, but we strongly suggest this to be fair to the workers and their time."})]})},"1"),Object(V.jsx)(Ha,{tab:"Consent Form",children:Object(V.jsxs)("div",{children:[Object(V.jsx)("img",{src:"/img/consent.png",style:{border:"1px solid black"}}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"Consent form"}),Object(V.jsx)("div",{children:'You can upload your consent form here as a PDF. The button for "Preview Consent Form" will show you how the consent form will look to the workers.'}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"Consent Checkboxes"}),Object(V.jsx)("div",{children:'Here, you can specify checkboxes which the workers must check in order to do your HIT. For example, "I am over 18 years old", or "I understand my answer will be published". You can add as many checkboxes as you need. The "Preview the Above Consent Questions in Worker View" button will show you the consent form PDF as well as the checkboxes after it.'})]})},"2"),Object(V.jsx)(Ha,{tab:"Data",children:Object(V.jsxs)("div",{children:[Object(V.jsx)("img",{src:"/img/data.png",style:{border:"1px solid black"}}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"Upload your data"}),Object(V.jsxs)("div",{children:[Object(V.jsx)("div",{children:"You should upload your data needed in your task here. For the quality annotation task, we want the format to be:"}),Object(V.jsx)("div",{children:"Context"}),Object(V.jsx)("div",{children:"System: system utterance"}),Object(V.jsx)("div",{children:"User: user utterance"}),Object(V.jsx)("div",{children:"Response"}),Object(V.jsx)("div",{children:"System: system utterance"}),Object(V.jsx)("br",{}),Object(V.jsx)("div",{children:"For the intent and sequence classification tasks, we want each of the sentences separated by a new line. In order to check if your data is been correctly uploaded, you can check the table that pops up. Each context/response pair will be its own entry in the table with a unique ID, and the dropdown of that entry will show the context system/user utterances in order."})]}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"# of conversations/HIT"}),Object(V.jsx)("div",{children:"Here, you can specify the number of conversations the worker needs to annotate in each HIT. For example, if we type 1, the worker will only need to annotate 1 context/response pair before they can submit. We suggest keeping this number low if you ask a lot of questions about the pair so the worker does not tire out."}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"# of annotations/conversation"}),Object(V.jsx)("div",{children:"This is where you specify how many annotations you want per conversation. If you type 2 here, each context/response pair will be shown to 2 different workers and annotated twice."}),Object(V.jsx)("br",{}),"We calculate the total number of HITs you should deploy on Amazon Mechanical Turk. This is calculated by # conversations * # of annotations/conversation / # conversations/HIT."]})},"3"),Object(V.jsx)(Ha,{tab:"Tasks Units for Quality Control",children:Object(V.jsxs)("div",{children:[Object(V.jsx)("img",{src:"/img/qualitycontrol.png",style:{border:"1px solid black"}}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"# of duplicated task units"}),Object(V.jsx)("div",{children:"To reiterate, duplicated task units are shown again to the worker in the same HIT to test the worker's consistency."}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"# of golden task units"}),Object(V.jsx)("div",{children:"Golden task units are used to compare a worker against an expert on the same question."}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"Upload data with answer"}),Object(V.jsxs)("div",{children:["You will upload the data with the golden answers here. The format is the same as the data you uploaded before, but under the context/response pairs, we add:",Object(V.jsx)("div",{children:"Answer"}),Object(V.jsx)("div",{children:"Answer to the 1st question"})]})]})},"4"),Object(V.jsx)(Ha,{tab:"General Questions",children:Object(V.jsxs)("div",{children:[Object(V.jsx)("img",{src:"/img/generalquestion.png",style:{border:"1px solid black"}}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"Type of Question"}),Object(V.jsx)("div",{children:'We provide three types of possible questions: likert scale, open ended, and multiple choice. The likert scale has 3, 5, or 7 stars. The open ended task provides one text field for the workers to input text. Lastly, the multiple choice option gives you the chance to add options for the choices. The "Preview this Question in Worker View" will show the question as it is shown to the workers.'}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"Example and Explanation"}),Object(V.jsx)("div",{children:"You can provide example responses to the questions you ask above. This is to help the worker understand what is an acceptable answer, and thus ensures better quality of your collected data. The box on the left is for the example, and the box on the right is the reasoning why the example is a good response."}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"Counterexample and Explanation"}),Object(V.jsx)("div",{children:"Same as above, you can provide counterexamples and reasoning so that workers won't provide answers similar to those that you do not want."}),Object(V.jsx)("br",{}),'The "Preview the Examples and Counterexamples in Worker View" button will show a table with the questions, and their respective examples and counterexamples. We suggest at least adding one example and counterexample for each question.']})},"5"),Object(V.jsx)(Ha,{tab:"Feedback",children:Object(V.jsxs)("div",{children:[Object(V.jsx)("img",{src:"/img/feedback.png",style:{border:"1px solid black"}}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("div",{children:"When you turn on this option, the workers will be provided with a feedback text box below the HIT."})]})},"6"),Object(V.jsx)(Ha,{tab:"Options",children:Object(V.jsxs)("div",{children:[Object(V.jsx)("img",{src:"/img/options.png",style:{border:"1px solid black"}}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsxs)("div",{children:["There are four options here:",Object(V.jsx)("br",{}),Object(V.jsxs)("div",{children:[Object(V.jsx)("b",{children:"Save"})," saves your HIT."]}),Object(V.jsx)("br",{}),Object(V.jsxs)("div",{children:[Object(V.jsx)("b",{children:"Preview"})," allows you to see the HIT from the worker's perspective. Remember to save before you preview."]}),Object(V.jsx)("br",{}),Object(V.jsxs)("div",{children:[Object(V.jsx)("b",{children:"Save Configuration as JSON"})," downloads the JSON configuration of the task so you are able to upload that configuration in a new task if you want to slightly edit it."]}),Object(V.jsx)("br",{}),Object(V.jsxs)("div",{children:[Object(V.jsx)("b",{children:"Amazon Mechanical Turk Template"})," provides code for the interface on Mechanical Turk. You can copy and paste this code so that workers can generate a link to DialCrowd then submit the confirmation code we provide after they completed the HIT so they are linked to their Mechanical Turk ID. It is also important to mention that DialCrowd is ",Object(V.jsx)("b",{children:"NOT"})," exclusively made to connect to Mechanical Turk; you are free to use other crowdsourcing platforms."]})]})]})},"7")]})]})}}var Ka=La;class Ua extends n.Component{constructor(e){super(e)}render(){return Object(V.jsxs)("div",{children:[Object(V.jsxs)("div",{children:[Object(V.jsx)("img",{src:"/img/addsystem.png",style:{border:"1px solid black"}}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("div",{children:"After filling out the other fields for adding a dialogue system, there are 2 fields that require additional explanation. First, the Url field is the url that your dialogue system is hosted on. Secondly, there are two types: public and private. The public option will make the dialogue system available to be added into an interactive task, while private will not make the system available."})]}),Object(V.jsx)("br",{}),Object(V.jsxs)("div",{children:[Object(V.jsx)("img",{src:"/img/system.png",style:{border:"1px solid black"}}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsx)("div",{children:"The three options here, in order, are: the link to the GitHub, the option to edit any of the fields you just filled out, and the option to speak with your bot to ensure that it has been connected properly."})]})]})}}var za=Ua;class Wa extends n.Component{constructor(e){super(e)}render(){return Object(V.jsx)("div",{children:Object(V.jsxs)("div",{children:[Object(V.jsx)("div",{children:"The interactive task follows the general configuration, consent form, general questions (with an additional A/B test option), and feedback. The only addition is the system add below."}),Object(V.jsx)("br",{}),Object(V.jsx)("img",{src:"/img/interactive.png",style:{border:"1px solid black"}}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsxs)("div",{children:[Object(V.jsx)("h4",{children:"System Display Name"}),Object(V.jsxs)("div",{children:["This is the name that will be displayed to the workers for the dialogue system. You ",Object(V.jsx)("b",{children:"DO NOT"}),' want to write "baseline" or anything similar, but instead write something like "System A".']}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"System"}),Object(V.jsx)("div",{children:'You will select your system here. Be sure that you have set the system to public in the "Add System" tab or else it will not show up here.'}),Object(V.jsx)("br",{}),Object(V.jsx)("h4",{children:"Specific Instructions"}),Object(V.jsx)("div",{children:"If you have any specific instructions for this dialogue system compared with any other dialogue systems you may add below, you can write the instructions here. You can also reiterate the instructions you put in the instructions tab above if they have not changed."})]})]})})}}var Qa=Wa;class Ga extends n.Component{constructor(e){super(e)}render(){return Object(V.jsx)("div",{children:Object(V.jsxs)("div",{children:[Object(V.jsx)("img",{src:"/img/quality.png",style:{border:"1px solid black"}}),Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsxs)("div",{children:["In addition to calculating the total, average, and standard deviation of time for the questions, we provide additional bot detection:",Object(V.jsx)("br",{}),Object(V.jsx)("br",{}),Object(V.jsxs)("div",{children:[Object(V.jsx)("b",{children:"Outlier"})," is set to yes if the total time spent on the task is two standard deviations more or less than the average time taken by all workers."]}),Object(V.jsx)("br",{}),Object(V.jsxs)("div",{children:[Object(V.jsx)("b",{children:"Abnormal"})," is set to yes if the worker chose answers in some sort of pattern (A, A, A, or A, B, A, B, etc.)."]}),Object(V.jsx)("br",{}),Object(V.jsxs)("div",{children:[Object(V.jsx)("b",{children:"Intra-User"})," is set if you used duplicate task units. It is the number of consistent answers over the total number of questions."]}),Object(V.jsx)("br",{}),Object(V.jsxs)("div",{children:[Object(V.jsx)("b",{children:"Agree-gold"})," is set if you used golden task units. It is the number of answers consistent with the expert over the total number of questions."]}),Object(V.jsx)("br",{}),Object(V.jsxs)("div",{children:[Object(V.jsx)("b",{children:"Inter-user"})," is the ratio of annotations that agreed with the majority of the other workers."]})]}),Object(V.jsx)("br",{}),Object(V.jsx)("div",{children:"Below this is a table with pairwise Cohen's Kappa for each question, and overall, color-coded by the amount of agreement. We also provide a Gaussian graph of timestamps so that you may also check visually the time it took workers to complete the tasks. If any of the options above (outlier, abnormal) are set to yes, or if the ratios of intra-user and agree-gold are not equivalent to 1, or if inter-user agreement is very low, then you may want to check the quality of the workers data."})]})})}}var Va=Ga;const Ya=de.a.TabPane;class Ja extends i.a.Component{constructor(e){super(e)}render(){return Object(V.jsx)("div",{children:Object(V.jsxs)(de.a,{defaultActiveKey:"1",children:[Object(V.jsx)(Ya,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(Ba.a,{}),"Generic Task"]}),children:Object(V.jsx)(Ka,{})},"1"),Object(V.jsx)(Ya,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(Z.a,{}),"Add System"]}),children:Object(V.jsx)(za,{})},"2"),Object(V.jsx)(Ya,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(ee.a,{}),"Interactive Task"]}),children:Object(V.jsx)(Qa,{})},"5"),Object(V.jsx)(Ya,{tab:Object(V.jsxs)("span",{children:[Object(V.jsx)(ne.a,{}),"Quality Tab"]}),children:Object(V.jsx)(Va,{})},"3")]})})}}var $a=Ja;class Xa extends i.a.Component{constructor(){super(...arguments),this.state={collapsed:!1},this.toggle=()=>{this.setState({collapsed:!this.state.collapsed})}}render(){return Object(V.jsxs)(U.a,{style:{height:"100%",minHeight:"100vh"},children:[Object(V.jsx)(le,{collapsed:this.state.collapsed}),Object(V.jsxs)(U.a,{children:[Object(V.jsxs)(U.a.Header,{style:{background:"#f0f2f5",padding:0},children:[i.a.createElement(this.state.collapsed?z.a:W.a,{className:"trigger",style:{marginLeft:"10px",fontSize:20},onClick:this.toggle}),Object(V.jsx)("div",{style:{float:"right",marginRight:"20px"},children:Object(V.jsx)(K.a,{to:"/",children:Object(V.jsx)("img",{width:"100px",src:"http://dialrc.org/img/site-logo.png",alt:"logo"})})},"logo")]}),Object(V.jsx)(U.a.Content,{style:{flex:1,flexDirection:"column",overflow:"scroll",background:"#fff",padding:24},children:Object(V.jsxs)(h.a,{children:[Object(V.jsx)(u.a,{path:"/interactive",component:$s}),Object(V.jsx)(u.a,{path:"/category",component:On}),Object(V.jsx)(u.a,{path:"/sequence",component:ei}),Object(V.jsx)(u.a,{path:"/quality",component:Pi}),Object(V.jsx)(u.a,{path:"/interactive_project",component:Ji}),Object(V.jsx)(u.a,{path:"/category_project",component:ta}),Object(V.jsx)(u.a,{path:"/sequence_project",component:ra}),Object(V.jsx)(u.a,{path:"/quality_project",component:ha}),Object(V.jsx)(u.a,{path:"/system",component:Sa}),Object(V.jsx)(u.a,{path:"/people",component:_a}),Object(V.jsx)(u.a,{path:"/crowd",component:ba}),Object(V.jsx)(u.a,{path:"/cluster",component:Pa}),Object(V.jsx)(u.a,{path:"/resources",component:Na}),Object(V.jsx)(u.a,{path:"/walkthrough",component:$a}),Object(V.jsx)(u.a,{path:"/",component:J})]})}),Object(V.jsxs)(U.a.Footer,{style:{},children:[Object(V.jsx)("strong",{children:"Copyright \xa9 2020, DialRC, Carnegie Mellon University"}),Object(V.jsxs)("div",{style:{float:"right",marginRight:"10px"},children:[Object(V.jsx)("a",{href:"mailto:dialog-evaluation@hhu.de",children:Object(V.jsx)(Q.a,{style:{fontSize:20}})}),Object(V.jsx)("a",{href:"https://gitlab.cs.uni-duesseldorf.de/dsml/project/dialogevaluation/dialcrowdv2",children:Object(V.jsx)(G.a,{style:{fontSize:20}})})]})]})]})]})}}var Za=Xa;s(1219);const er=Ke.a.confirm,tr=je.a.Item,sr=Ue.a.Option,nr=Me.default.Group,ir=et.a.Panel;class ar extends i.a.Component{constructor(e){super(e),this.retrieveQuestion=e=>{for(const[n,i]of Object.entries(e))if("FeedbackOpen|||1"===n)this.feedback=i;else{let e=(this.state.current-1)*this.state.numofsent+parseInt(n),t=this.state.data[e].sentid;this.annotations.push({sentid:t,...i})}var t,s;this.state.current==this.state.numofhit&&(t=this,s=this.annotations,fetch(I+"/api/save/worker/category/"+t.state.userID,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({data:t.state.data,userID:t.state.userID,submissiontime:Date.now(),Result:s,mid:t.state.MID,ID:t.state.ID,feedback:t.feedback})}).then((function(e){return e.json()})).then((function(e){t.state.current>t.state.numofhit&&er({title:"Thank you for submission. ",content:"Your survey code: "+t.state.userID+". Please copy this code in AMT and refresh the page to restart.",onOk(){},onCancel(){}})}))),this.props.form.resetFields()},this.stateSet=(e,t,s)=>{let n={},i=Date.now();if(n.timestamp=i,n.label=e,n.sentence=t,n.userId=this.state.userID,n.taskId=this.state.ID,n.sentId=s,this.state.sent.some((e=>e.sentId==s)))for(var a=0;a<this.state.sent.length;a++)this.state.sent[a].sentId==s&&(this.state.sent[a].duration=this.state.sent[a].duration+i-this.state.prev);else n.duration=n.timestamp-this.state.prev,t?this.state.sent.push(n):this.setState({sent:[n]});this.setState({prev:i})},this.handleSubmit=e=>{e.preventDefault();for(var t=0;t<this.state.sent.length;t++)s=this.state.sent[t],fetch(I+"/api/save/worker/detail/category/"+s.userId,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({data:s})}).then((function(e){return e.json()})).then((function(e){}));var s;this.setState({prev:Date.now()}),this.props.form.validateFields(((e,t)=>{e?(console.log("err"),this.state.current>this.state.numofhit&&er({title:"Thank you for submission",content:"Your survey code: "+this.state.userID,onOk(){},onCancel(){}})):(this.retrieveQuestion(t),console.log("Received values of form: ",t),this.state.current<this.state.numofhit?this.setState({current:this.state.current+1}):er({title:"Thank you for submission",content:"Your survey code: "+this.state.userID,onOk(){},onCancel(){}}))}))},this.changeTab=e=>{e.includes("3")&&this.setState({prev:Date.now(),activeKey:e})},this.openInstructions=()=>{if(!this.state.activeKey.includes("2")){let e=this.state.activeKey;e.push("2"),this.setState({activeKey:e})}},this.state={prev:0,isSubmit:!1,isdone:!1,userID:"",visible:!1,current:1,data:{},order:[],flag:!1,isShow:!1,MID:"",ID:"",sent:[],consent:"",activeKey:["1","2"],questionCategories:[],questionFeedbacks:[]},this.annotations=[]}componentDidMount(){const e=y.a.parse(window.location.search);let t="MID",s=Date.now(),n="5aa2cc392972997dd9099c48";var i;e.MID&&(t=e.MID),e.ID&&(n=e.ID),this.setState({userID:s}),this.setState({prev:s}),this.setState({MID:t}),this.setState({ID:n}),i=this,fetch(I+"/api/worker/category/"+n).then((function(e){return e.json()})).then((function(e){if(void 0!==e.err)return void Ke.a.error({content:e.err});let t,s,n=e.category_data.length/e.numofsent;if(e.category_data.length%e.numofsent>0&&(n=parseInt(n)+1),t=void 0===e.questionFeedbacks?_t(e.feedback||[],e.feedbackType||[],e.feedbackradio||[]):Tt(e.questionFeedbacks),void 0===e.questionCategories){const t=e.classLabel||[];s=_t(t,t.map((e=>"")),t.map((e=>[])),e.classExample,e.classCounterexample)}else s=Tt(e.questionCategories);i.setState({data:e.category_data,flag:e.flag,numofhit:n,numofsent:e.numofsent,exampleTable:e.exampleTable,generic_introduction:e.generic_introduction,generic_instructions:e.generic_instructions,time:e.time,payment:e.payment,consent:e.consent[1],requirements:Tt(e.requirements||[]),questionFeedbacks:t,questionCategories:s,hasFeedbackQuestion:e.hasFeedbackQuestion,style:e.style,enableMarkdown:e.enableMarkdown})}))}render(){const e=[{title:"Category",dataIndex:"title",key:"title"},{title:"An Example",dataIndex:"examples",key:"examples",render:vt},{title:"A Counterexample",dataIndex:"counterexamples",key:"counterexamples",render:vt}],{getFieldDecorator:t}=this.props.form,{current:s}=this.state,n={labelCol:{span:14},wrapperCol:{span:10},colon:!1},i=this.state.questionCategories.map((e=>e.title));let a=ot(this.state.style);return Object(V.jsxs)("div",{style:a.global,children:[Object(V.jsx)("div",{id:"surveyContainer"}),Object(V.jsxs)(je.a,{onSubmit:this.handleSubmit,style:{marginBottom:.6},children:[Object(V.jsxs)(et.a,{defaultActiveKey:["1","2"],onChange:this.changeTab,activeKey:this.state.activeKey,children:[Object(V.jsxs)(ir,{header:"Background",style:a.tabTitle,children:[Object(V.jsx)("p",{style:a.background,children:Object(V.jsx)(Ye,{enableMarkdown:this.state.enableMarkdown,children:this.state.generic_introduction})}),Object(V.jsx)(Ze,{consent:this.state.consent,checkboxes:this.state.requirements})]},"1"),Object(V.jsxs)(ir,{header:"Instructions",style:a.tabTitle,children:[Object(V.jsx)("div",{style:a.instruction,children:this.state.enableMarkdown?Object(V.jsx)(Ye,{enableMarkdown:this.state.enableMarkdown,children:this.state.generic_instructions}):Object(V.jsx)("b",{children:this.state.generic_instructions})}),Object(V.jsxs)("p",{style:{...a.instruction,marginTop:"0px",marginBottom:"0px",fontSize:a.instruction.fontSize-2},children:["We expect this HIT will take ",Object(V.jsxs)("b",{children:[this.state.timepay," minute(s)"]})," and we will pay ",Object(V.jsxs)("b",{children:["$",this.state.payment]}),"."]}),Object(V.jsx)("div",{style:{...a.example,fontSize:a.example.fontSize+4},children:Object(V.jsx)("p",{children:Object(V.jsx)("b",{children:"Examples"})})}),Object(V.jsx)(ge.a,{rowKey:"sentid",dataSource:this.state.questionEntities,columns:e,size:"small",style:{...a.example,marginTop:"".concat(a.global.spacing,"px"),marginBottom:"".concat(a.global.spacing,"px")}})]},"2"),Object(V.jsxs)(ir,{header:"Category classification",style:a.tabTitle,children:[this.state.activeKey.includes("2")?null:Object(V.jsx)("div",{style:{textAlign:"center"},children:Object(V.jsx)(ye.a,{type:"default",onClick:this.openInstructions,children:"Example Responses"})}),Object(V.jsxs)("div",{title:"category classification",children:[Object(V.jsx)("div",{style:{textAlign:"center"},children:Object(V.jsx)("p",{style:{textAlign:"center",fontSize:18,marginTop:a.global.spacing,marginBottom:0},children:Object(V.jsx)("b",{children:'"Select a category for the given text"'})})}),Object(V.jsx)("div",{style:{textAlign:"center",marginBottom:"".concat(a.global.spacing+22.5,"px")},children:Object(V.jsx)(ye.a,{type:"default",onClick:this.openInstructions,children:"Example Responses"})}),this.state.flag?this.state.data.slice((this.state.current-1)*this.state.numofsent,this.state.current*this.state.numofsent).map(((e,s)=>Object(V.jsxs)("div",{style:{backgroundColor:"#f7f7f7",marginBottom:"".concat(a.global.spacing,"px")},children:[Object(V.jsx)(tr,{className:"two-rows-label",...n,label:Object(V.jsx)("div",{style:{display:"inline-block",float:"left",whiteSpace:"normal",marginRight:"12px","text-align":"left",lineHeight:"15px"},children:e.sentence.split("|||").map((e=>Object(V.jsx)("p",{style:a.utterance,children:e})))}),hasFeedback:!0,children:t("[".concat(s,']["answer"]'),{rules:[{required:!0,message:"Please select a category"}]})(Object(V.jsx)(Ue.a,{onSelect:t=>this.stateSet(t,e.sentence,s),placeholder:"Please select a category",children:i.map(((e,t)=>Object(V.jsx)(sr,{value:e,children:e})))}))}),Object(V.jsx)(tr,{...n,label:Object(V.jsx)("div",{style:{color:"forestgreen",display:"inline-flex"},children:"Confidence of your answer? (1: Not confident, 3: Very confident) "}),children:t("[".concat(s,']["confidence"]'),{rules:[{required:!0,message:"Please select a confidence level"}]})(Object(V.jsxs)(nr,{children:[Object(V.jsx)(Me.default,{value:"1",children:"1"}),Object(V.jsx)(Me.default,{value:"2",children:"2"}),Object(V.jsx)(Me.default,{value:"3",children:"3"})]}))})]}))):null]})]},"3")]}),Object(V.jsx)("div",{style:{backgroundColor:"#C1E7F8"},children:Object(V.jsxs)(tr,{style:{textAlign:"center"},wrapperCol:{span:12,offset:6},children:[Object(V.jsx)("p",{style:{textAlign:"center",fontSize:15,color:"black"},children:"You will get the code after you complete the HIT."}),s<this.state.numofhit?Object(V.jsxs)(ye.a,{type:"primary",htmlType:"submit",children:["Next ",s,"/",this.state.numofhit]}):Object(V.jsxs)("div",{title:"Feedback",style:{margin:"10px",padding:24},children:[Ve(this.state.hasFeedbackQuestion,t),Object(V.jsx)(ye.a,{type:"primary",htmlType:"submit",children:"Submit"})]})]})})]})]})}}var rr=je.a.create()(ar),or=s(585);const cr={color:"transparent",pointerEvents:"none",padding:"5px 8px"},lr={position:"absolute",top:0,left:0};class dr extends n.Component{componentDidMount(){console.log(this.props),document.addEventListener("selectionchange",(()=>{const e=window.getSelection();e.anchorNode&&(e.anchorNode,this.selectionAnchorNode)}),!1)}handleTextChange(e){const{example:t,edit:s}=this.props,{text:n,entities:i}=t,a=e.target.value,r=[];i.forEach((e=>{const t=n.substr(e.start,e.end-e.start);const s=function s(n){if(n){const i=n+t.length,r=a.indexOf(t,i);if(-1===r)return n;return Math.abs(e.start-n)<Math.abs(e.start-r)?n:s(r)}{const e=a.indexOf(t);return-1===e?e:s(e)}}();-1!==s&&r.push({...e,start:s,end:s+t.length})})),s(t.id,{text:a,entities:r})}renderEntityHighlight(e,t,s){const{entityNames:n}=this.props,i=e.substr(0,t.start),a=e.substr(t.start,t.end-t.start),r=e.substr(t.end);return console.log(a),Object(V.jsxs)("div",{style:{...lr,...cr,marginLeft:"5px"},children:[Object(V.jsx)("span",{children:i}),Object(V.jsx)("span",{style:{...Object(or.a)(n.indexOf(t.entity))},children:a}),Object(V.jsx)("span",{children:r})]},s)}render(){const{example:e,style:t}=this.props,{text:s,entities:n=[]}=e;return Object(V.jsx)("div",{style:{width:"100%",...t},children:Object(V.jsxs)("div",{style:{position:"relative"},ref:e=>this.selectionAnchorNode=e,children:[Object(V.jsx)(Ce.a.TextArea,{ref:e=>this.inputNode=e&&Object(a.findDOMNode)(e),value:s,placeholder:"text"}),n.map(((e,t)=>this.renderEntityHighlight(s,e,t)))]})})}}var hr=Object(o.b)(null,null)(dr);const ur=Ke.a.confirm,pr=je.a.Item;Me.default.Group;function jr(e,t){fetch(I+"/api/save/worker/sequence/"+e.state.userID,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({data:e.state.data,userID:e.state.userID,submissiontime:Date.now(),Result:t,mid:e.state.MID,ID:e.state.ID})}).then((function(e){return e.json()})).then((function(t){console.log(t),e.state.current>e.state.numofhit&&ur({title:"Thank you for submission. ",content:"Your survey code: "+e.state.userID+". Please copy this code in AMT and refresh the page to restart.",onOk(){},onCancel(){}})}))}class br extends i.a.Component{constructor(e){super(e),this.handleSubmit=e=>{e.preventDefault();let t=[];this.props.form.validateFields(((e,s)=>{e||(t=s)}));var s={sentence:this.state.data[this.state.current-1].sentence,entity:this.state.Orgs,sentid:this.state.data[this.state.current-1].sentid,time:Date.now()-this.state.time,feedback:t};this.annotations.push(s),this.state.current<this.state.numofhit?this.setState({current:this.state.current+1,Orgs:[]}):(jr(this,this.annotations),ur({title:"Thank you for submission",content:"Your survey code: "+this.state.userID,onOk(){},onCancel(){}})),this.setState({isFirst:!1})},this.openInstructions=()=>{if(!this.state.activeKey.includes("2")){let e=this.state.activeKey;e.push("2"),this.setState({activeKey:e})}},this.changeTab=e=>{this.setState({activeKey:e})},this.deleteEnt=e=>{for(var t=-1,s=0;s<this.state.Orgs.length;s++)this.state.Orgs[s].Id===e&&(t=s);console.log(t),console.log(e);var n=this.state.Orgs;t>-1&&n.splice(t,1),this.setState({Orgs:n})},this.state={current:1,Label:[],MID:"",Orgs:[],Names:[],Locs:[],selectorStart:0,selectorEnd:0,oStart:0,oEnd:0,nStart:0,nENd:0,lStart:0,lEnd:0,selecttext:"",orgset:"",org:"",lastOrg:"",name:"",lastName:"",loc:"",losLoc:"",output:{sentence:"",entities:[]},feedback:[],feedbackType:[],time:"",isFirst:!0,timepay:"",payment:"",consent:"",feedbackradio:[],activeKey:["1","2"],questionEntities:[],questionFeedbacks:[]},this.annotations=[],this.SelectText=this.SelectText.bind(this),this.clickEntity=this.clickEntity.bind(this)}componentDidMount(){const e=y.a.parse(window.location.search);let t="MID",s="5ab1e12c9c1ad4743a3fb1d6";e.MID&&(t=e.MID),e.ID&&(s=e.ID);var n,i=Date.now();this.setState({userID:i}),this.setState({MID:t}),this.setState({ID:s}),n=this,fetch(I+"/api/worker/sequence/"+s).then((function(e){return e.json()})).then((function(e){if(void 0!==e.err)return void Ke.a.error({content:e.err});let t;if(void 0===e.questionEntities){const s=e.Label||[];t=_t(s,s.map((e=>"")),s.map((e=>[])),e.Example,e.Counterexample)}else t=Tt(e.questionEntities);n.setState({data:e.sequence_data,flag:e.flag,Label:e.Label,numofhit:e.sequence_data.length,exampleTable:e.exampleTable,generic_introduction:e.generic_introduction,generic_instructions:e.generic_instructions,timepay:e.time,payment:e.payment,consent:e.consent,requirements:Tt(e.requirements||[]),questionEntities:t,hasFeedbackQuestion:e.hasFeedbackQuestion,style:e.style,enableMarkdown:e.enableMarkdown})}))}async retrieveQuestion(e){await jr(this,e),this.setState({Orgs:[]})}SelectText(){try{null!==(e=window.getSelection())&&""!==e&&(console.log(e),this.setState({selecttext:e.toString()}),console.log("demo: "+e))}catch(s){var e,t=(e=document.getSelection()).text;null!==t&&console.log(t)}if(window.getSelection)window.getSelection();this.setState({selectorStart:e.anchorOffset}),this.setState({selectorEnd:e.focusOffset}),(this.state.isFirst||isNaN(parseInt(this.state.time)))&&this.setState({time:Date.now()})}clickEntity(e){var t={type:e,value:this.state.selecttext.toString().trim(),start:this.state.selectorStart,end:this.state.selectorEnd,Id:Date.now(),text:this.state.data[this.state.current-1].sentence,entities:[{start:this.state.selectorStart,end:this.state.selectorEnd,entity:e}]},s=this.state.Orgs;if(s.push(t),this.setState({Orgs:s}),console.log(this.state.Orgs),document.all){document.selection.createRange().execCommand("ForeColor",!1,"#FF0000")}else{window.getSelection().getRangeAt(0);document.createElement("span").style.cssText="color:orange"}}render(){const{current:e}=this.state,t=[{title:"Type",dataIndex:"title",key:"title"},{title:"Example",dataIndex:"examples",key:"examples",render:vt},{title:"Counterexample",dataIndex:"counterexamples",key:"counterexamples",render:vt}],s=this.state.questionEntities.map((e=>e.title)),n=[{title:"Entity Type",dataIndex:"type",key:"type"},{title:"Entity Value",dataIndex:"value",key:"value"},{title:"Example",dataIndex:"example",key:"example",render:(e,t)=>Object(V.jsx)(hr,{example:t,entityNames:s})},{title:"Edit",dataIndex:"operation",key:"operation",render:(e,t)=>Object(V.jsx)("span",{className:"table-operation",children:Object(V.jsx)("span",{children:Object(V.jsxs)("a",{onClick:()=>this.deleteEnt(t.Id),children:[Object(V.jsx)(Ki.a,{})," delete"]})})})}],{getFieldDecorator:i}=this.props.form,a=ot(this.state.style,{utterance:{fontSize:20,textAlign:"center"}});return Object(V.jsx)("div",{style:a.global,children:Object(V.jsx)(je.a,{onSubmit:this.handleSubmit,style:{marginBottom:.6},children:Object(V.jsxs)(et.a,{defaultActiveKey:["1","2"],activeKey:this.state.activeKey,onChange:this.changeTab,children:[Object(V.jsxs)(et.a.Panel,{header:"Background",style:a.tabTitle,children:[Object(V.jsx)("p",{style:a.background,children:Object(V.jsx)(Ye,{enableMarkdown:this.state.enableMarkdown,children:this.state.generic_introduction})}),Object(V.jsx)(Ze,{consent:this.state.consent,checkboxes:this.state.requirements})]},"1"),Object(V.jsxs)(et.a.Panel,{header:"Instructions",style:a.tabTitle,children:[Object(V.jsx)("div",{style:a.instruction,children:this.state.enableMarkdown?Object(V.jsx)(Ye,{enableMarkdown:this.state.enableMarkdown,children:this.state.generic_instructions}):Object(V.jsx)("b",{children:this.state.generic_instructions})}),Object(V.jsxs)("p",{style:{...a.instruction,marginTop:"0px",marginBottom:"0px",fontSize:a.instruction.fontSize-2},children:["We expect this HIT will take ",Object(V.jsxs)("b",{children:[this.state.timepay," minute(s)"]})," and we will pay ",Object(V.jsxs)("b",{children:["$",this.state.payment]}),"."]}),Object(V.jsx)("div",{style:{...a.example,fontSize:a.example.fontSize+4},children:Object(V.jsx)("p",{children:Object(V.jsx)("b",{children:"Examples"})})}),Object(V.jsx)(ge.a,{rowKey:"sentid",dataSource:this.state.questionEntities,columns:t,size:"small",style:{...a.example,marginBottom:"".concat(a.global.spacing,"px")}})]},"2"),Object(V.jsxs)(et.a.Panel,{header:"Sequence Labeling",style:a.tabTitle,children:[Object(V.jsxs)("div",{title:"Select the text that you recognize as an entity and choose the corresponding type of entity using the buttons below.",children:[Object(V.jsx)("div",{children:Object(V.jsx)("p",{style:{textAlign:"center",fontSize:18,marginTop:"".concat(a.global.spacing,"px")},children:Object(V.jsx)("b",{children:"Select the text that you recognize as an entity and choose the corresponding type of entity using the buttons below."})})}),Object(V.jsx)("div",{style:{textAlign:"center",marginTop:"".concat(a.global.spacing,"px"),marginBottom:"".concat(10+a.global.spacing,"px")},children:Object(V.jsx)(ye.a,{type:"default",onClick:this.openInstructions,children:"Example Responses"})}),this.state.flag?this.state.data.slice(this.state.current-1,this.state.current).map(((e,t)=>Object(V.jsxs)("div",{children:[Object(V.jsx)("p",{style:a.utterance,onClick:this.SelectText,children:e.sentence}),s.map(((e,t)=>Object(V.jsxs)(ye.a,{type:"primary",style:{marginLeft:"10px"},onClick:()=>this.clickEntity(e),children:[Object(V.jsx)(te.a,{}),e]})))]}))):null]}),Object(V.jsx)("div",{title:"Annotations",style:{marginTop:"".concat(20+a.global.spacing,"px")},children:Object(V.jsx)(ge.a,{dataSource:this.state.Orgs,columns:n,size:"small",pagination:!1,style:a.answer})}),Object(V.jsx)("div",{style:{backgroundColor:"#C1E7F8"},children:Object(V.jsxs)(pr,{style:{textAlign:"center"},wrapperCol:{span:12,offset:6},children:[Object(V.jsx)("p",{style:{textAlign:"center",fontSize:15,color:"black"},children:"You will get the code after you finish everything"}),e<this.state.numofhit?Object(V.jsxs)(ye.a,{type:"primary",htmlType:"submit",children:["Next ",e,"/",this.state.numofhit]}):Object(V.jsxs)(V.Fragment,{children:[Ve(this.state.hasFeedbackQuestion,i),Object(V.jsx)("div",{style:{"margin-top":"".concat(-20+a.global.spacing,"px")},children:Object(V.jsx)(ye.a,{type:"primary",htmlType:"submit",children:"Submit"})})]})]})})]},"3")]})})})}}var mr=je.a.create()(br);const xr=Ke.a.confirm,yr=je.a.Item;Ue.a.Option,Me.default.Group;class gr extends i.a.Component{constructor(e){super(e),this.handleSubmit=e=>{e.preventDefault();let t=Date.now(),s={},n={};this.props.form.validateFields(((e,i)=>{var a,r;e?xr({content:"Please answer all the questions",onOk(){},onCancel(){}}):(Object.keys(i).forEach((function(e){e.includes("FeedbackOpen|||")?n[e]=i[e]:s[e]=i[e]})),this.state.times.push(t-this.state.prev),this.state.responses.push(s),this.state.current<this.state.numofhit?(this.props.form.resetFields(),this.setState({current:this.state.current+1})):(a=this,r={responses:this.state.responses,feedback:n,times:this.state.times},fetch(I+"/api/save/worker/quality/"+a.state.userID,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({data:a.state.data,userID:a.state.userID,submissiontime:Date.now(),Result:r,mid:a.state.MID,ID:a.state.ID,times:r.times})}).then((function(e){return e.json()})),xr({title:"Thank you for submission",content:"Your survey code: "+this.state.userID,onOk(){},onCancel(){}})))}))},this.changeTab=e=>{this.setState({activeKey:e})},this.openInstructions=()=>{if(!this.state.activeKey.includes("2")){let e=this.state.activeKey;e.push("2"),this.setState({activeKey:e})}},this.state={prev:0,isSubmit:!1,isdone:!1,userID:"",visible:!1,current:1,context:[],response:[],order:[],flag:!1,isShow:!1,MID:"",ID:"",sent:[],feedback:[],questions:[],times:[],responses:[],consent:"",radios:[],feedbackradio:[],activeKey:["1","2"]}}componentDidMount(){const e=y.a.parse(window.location.search);let t="MID",s="5ab1e12c9c1ad4743a3fb1d6",n=Date.now();var i,a;e.MID&&(t=e.MID),e.ID&&(s=e.ID),this.setState({userID:n}),this.setState({MID:t}),this.setState({ID:s}),this.setState({prev:n}),i=this,a=s,console.log(I),fetch(I+"/api/worker/quality/"+a).then((function(e){return e.json()})).then((function(e){if(void 0!==e.err)return void Ke.a.error({content:e.err});let t,s,n=[],a=[];e.quality_data.forEach((function(e,t){n.push(e.context),a.push(e.response)})),t=void 0===e.questionSurveys?_t(e.pollquestion,e.typeofpoll,e.radio,e.example,e.counterexample):Tt(e.questionSurveys),s=void 0===e.questionFeedbacks?_t(e.feedback||[],e.feedbackType||[],e.feedbackradio||[]):Tt(e.questionFeedbacks),console.log(e.quality_data),i.setState({data:e.quality_data,context:n,response:a,flag:e.flag,numofhit:e.quality_data.length,generic_introduction:e.generic_introduction,generic_instructions:e.generic_instructions,time:e.time,payment:e.payment,consent:e.consent[1],questionSurveys:t,questionFeedbacks:s,questionSystems:void 0,requirements:Tt(e.requirements||[]),hasFeedbackQuestion:e.hasFeedbackQuestion,style:e.style,enableMarkdown:e.enableMarkdown})}))}render(){const{current:e}=this.state,{getFieldDecorator:t}=this.props.form;let s=ot(this.state.style);return Object(V.jsx)("div",{style:s.global,children:Object(V.jsx)(je.a,{onSubmit:this.handleSubmit,style:{marginBottom:.6},children:Object(V.jsxs)(et.a,{defaultActiveKey:["1","2"],activeKey:this.state.activeKey,onChange:this.changeTab,children:[Object(V.jsxs)(et.a.Panel,{header:"Background",style:s.tabTitle,children:[Object(V.jsx)("p",{style:s.background,children:Object(V.jsx)(Ye,{enableMarkdown:this.state.enableMarkdown,children:this.state.generic_introduction})}),Object(V.jsx)(Ze,{consent:this.state.consent,checkboxes:this.state.requirements})]},"1"),Object(V.jsxs)(et.a.Panel,{header:"Instructions",style:s.tabTitle,children:[Object(V.jsx)("div",{style:s.instruction,children:this.state.enableMarkdown?Object(V.jsx)(Ye,{enableMarkdown:this.state.enableMarkdown,children:this.state.generic_instructions}):Object(V.jsx)("b",{children:this.state.generic_instructions})}),Object(V.jsxs)("span",{style:{...s.instruction,"margin-top":"".concat(-8+s.global.spacing,"px"),"margin-bottom":"".concat(s.global.spacing,"px"),fontSize:s.instruction.fontSize-2},children:["We expect this HIT will take ",Object(V.jsxs)("b",{children:[this.state.time," minute(s)"]})," and we will pay ",Object(V.jsxs)("b",{children:["$",this.state.payment]}),"."]}),fr(this.state.questionSurveys,s,{...s.example,fontSize:s.example.fontSize+4})]},"2"),Object(V.jsxs)(et.a.Panel,{header:"Quality Questions",style:s.tabTitle,children:[this.state.activeKey.includes("2")?null:Object(V.jsx)("div",{style:{textAlign:"center"},children:Object(V.jsx)(ye.a,{type:"default",onClick:this.openInstructions,children:"Example Responses"})}),Object(V.jsxs)("div",{title:"quality questions",children:[Object(V.jsx)("p",{style:{textAlign:"center","margin-top":"".concat(s.global.spacing,"px")},children:Object(V.jsx)("div",{style:{textAlign:"center",fontSize:18},children:Object(V.jsx)("b",{children:'"Answer the questions on the right about the context and response on the left."'})})}),Object(V.jsxs)("div",{style:{display:"inline-block",width:"50%","padding-left":"40px","padding-right":"10px","vertical-align":"top","margin-top":"".concat(-15+s.global.spacing,"px")},children:[Object(V.jsx)("div",{children:Object(V.jsx)("p",{style:{fontSize:s.context.fontSize+6,textAlign:s.context.textAlign,fontWeight:"bold","margin-bottom":"0px"},children:"Context"})}),Object(V.jsx)("div",{children:this.state.flag&&this.state.context[this.state.current-1]?this.state.context[this.state.current-1].map(((e,t)=>Object(V.jsxs)("p",{style:s.context,children:[e.turn,". ",e.utterance]}))):null}),Object(V.jsx)("div",{children:Object(V.jsx)("span",{style:{fontSize:s.response.fontSize+6,textAlign:s.response.textAlign,fontWeight:"bold","margin-bottom":"".concat(s.global.spacing,"px")},children:"Response"})}),Object(V.jsx)("div",{children:this.state.flag&&this.state.response[this.state.current-1]?Object(V.jsx)("div",{children:Object(V.jsx)("p",{style:s.response,children:this.state.response[this.state.current-1]})}):null})]}),Object(V.jsx)("div",{style:{display:"inline-block",width:"50%","padding-right":"40px","padding-left":"10px","vertical-align":"top","margin-top":"".concat(-15+s.global.spacing,"px"),...s.question},children:Object(V.jsx)(Je,{getFieldDecorator:t,questions:this.state.questionSurveys,title:"Questions"})})]}),Object(V.jsx)("div",{style:{backgroundColor:"#C1E7F8"},children:Object(V.jsx)(yr,{style:{textAlign:"center"},wrapperCol:{span:12,offset:6},children:e<this.state.numofhit?Object(V.jsxs)(ye.a,{type:"primary",htmlType:"submit",children:["Next ",e,"/",this.state.numofhit]}):Ve(this.state.hasFeedbackQuestion,t)})}),e>=this.state.numofhit?Object(V.jsx)("div",{style:{"text-align":"center","margin-top":"".concat(-20+s.global.spacing,"px"),"margin-bottom":"-10px"},children:Object(V.jsx)(ye.a,{type:"primary",htmlType:"submit",children:"Submit"})}):null]},"3")]})})})}}function fr(e,t,s){const n=[{title:"Question",dataIndex:"title"},{title:"An Example Response",dataIndex:"examples",key:"examples",render:vt},{title:"A Counterexample Response",dataIndex:"counterexamples",key:"counterexamples",render:vt}],i=(e||[]).filter((e=>(e.examples||[]).length>0||(e.counterexamples||[]).length>0));return 0===i.length?null:Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("div",{style:s,children:Object(V.jsx)("b",{children:"Examples"})}),Object(V.jsx)(ge.a,{rowKey:"sentid",dataSource:i,columns:n,size:"small",pagination:{hideOnSinglePage:!0},style:t.example})]})}var Or=je.a.create()(gr),vr=s(565),wr=s(74);class kr extends i.a.Component{constructor(e){super(e),this.state={open:!1}}render(){return Object(V.jsx)(wr.Motion,{style:{height:Object(wr.spring)(this.state.open?200:0)},children:e=>{let{height:t}=e;return Object(V.jsxs)("div",{className:"help",style:{height:t+54},children:[t>0?Object(V.jsx)("div",{className:"helpText",children:this.props.text}):null,Object(V.jsxs)("div",{className:"helpHeader",onClick:this.toggleOpen.bind(this),children:[Object(V.jsx)("span",{className:"helpTitle",children:"Help Page"}),Object(V.jsx)("div",{className:"helpIcon",style:{transform:"rotate(".concat(t/2,"deg)")},children:Object(V.jsx)(vr.a,{})})]})]})}})}toggleOpen(){this.setState({open:!this.state.open})}}Object(o.b)((function(e){return{text:e.help}}))(kr);var Ir=s(587),Sr=s.n(Ir),Cr=s(588),_r=s.n(Cr);class Tr extends i.a.Component{constructor(e){super(e),this.state={up:!1,down:!1}}render(){return Object(V.jsxs)("div",{className:"review",children:[Object(V.jsx)("div",{className:"reviewButton",onClick:this.thumbUp.bind(this),children:Object(V.jsx)(Sr.a,{color:this.state.up?"#0097e6":"#353b48"})}),Object(V.jsx)("div",{className:"reviewButton",onClick:this.thumbDown.bind(this),children:Object(V.jsx)(_r.a,{color:this.state.down?"#0097e6":"#353b48"})})]})}thumbUp(){this.state.up?this.props.sendFeedback(this.props.text,Date.now(),"none"):this.props.sendFeedback(this.props.text,Date.now(),"thumbs_up"),this.setState({up:!this.state.up,down:!1})}thumbDown(){this.state.down?this.props.sendFeedback(this.props.text,Date.now(),"none"):this.props.sendFeedback(this.props.text,Date.now(),"thumbs_down"),this.setState({up:!1,down:!this.state.down})}}const Dr={sendFeedback:function(e,t,s){return{type:"FEEDBACK_SEND",text:e,time:t,feedback:s}}};Object(o.b)((function(e,t){return e.messages[t.index]}),Dr)(Tr);class qr extends i.a.Component{render(){return Object(V.jsx)("div",{className:"messageContainer",style:{...this.props.style},children:Object(V.jsx)("div",{className:(this.props.received?"received":"sent")+" message",children:this.props.text.split("<p>").map((e=>Object(V.jsx)("span",{className:"messageText",children:Object(V.jsx)("p",{children:e})})))})})}}var Ar=Object(o.b)((function(e,t){return e.messages[t.index]}),{})(qr);class Pr extends i.a.Component{constructor(e){super(e),this.state={height:0}}render(){return Object(V.jsx)(wr.TransitionMotion,{willEnter:this.willEnter,styles:this.props.messages.map((e=>({key:e,data:e,style:{y:Object(wr.spring)(0)}}))),children:e=>Object(V.jsxs)("div",{className:"messages",children:[e.map((e=>Object(V.jsx)(Ar,{index:e.data,style:{transform:"translate(0px, ".concat(e.style.y,"px)")}},e.key))),Object(V.jsx)("div",{style:{minHeight:9}})]})})}willEnter(){return{y:72}}componentDidMount(){this.updateScroll()}componentDidUpdate(){this.updateScroll()}updateScroll(){window.requestAnimationFrame((()=>{const e=this.scroll;void 0!==e&&(e.scrollTop=e.scrollHeight)}))}}var Er=Object(o.b)((function(e){return{messages:e.messages.map(((e,t)=>t)).reverse()}}),{})(Pr);class Fr extends i.a.Component{render(){return Object(V.jsx)("div",{className:"textInput",children:Object(V.jsx)("input",{style:{height:"40px",marginLeft:"20px"},type:"text",placeholder:"Type message here",onKeyPress:this.handleKeyPress.bind(this)})})}handleKeyPress(e){"Enter"===e.key&&""!==e.target.value&&(this.props.onEnter(e.target.value,Date.now()),e.target.value="")}}const Mr={onEnter:g};var Rr=Object(o.b)((function(e){return{}}),Mr)(Fr),Nr=s(589),Br=s.n(Nr);class Hr extends i.a.Component{render(){return Object(V.jsx)("div",{style:"speech"===this.props.mode?{width:72,height:72,borderRadius:36}:null,className:"microphone"+(this.props.listening?" listening":""),onClick:this.onClick.bind(this),children:Object(V.jsx)(Br.a,{size:"speech"===this.props.mode?"medium":"small",color:this.props.listening?"#e84118":"white"})})}onClick(){this.props.listening?this.props.cancelMicrophone():this.props.startMicrophone()}}const Lr={startMicrophone:function(){return{type:"MICROPHONE_START"}},cancelMicrophone:function(){return{type:"MICROPHONE_CANCEL"}}};var Kr=Object(o.b)((function(e){return{listening:e.listening,mode:e.mode}}),Lr)(Hr);class Ur extends n.Component{render(){return Object(V.jsxs)("div",{className:"app",children:[Object(V.jsx)(Er,{}),Object(V.jsxs)("div",{className:"bottom",children:["text"!==this.props.mode?Object(V.jsx)(Kr,{}):null,"speech"!==this.props.mode?Object(V.jsx)(Rr,{}):null]})]})}}var zr=Object(o.b)((function(e){return{mode:e.mode}}))(Ur),Wr=s(396);Wr.a.initialize("UA-63929316-3"),Wr.a.pageview(window.location.pathname+window.location.search);const Qr=function(){const e=Object(j.a)(),t=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||p.d,s=Object(p.e)(b,L,t(Object(p.a)(e)));return s.subscribe((()=>{(e=>{try{const t=JSON.stringify(e);localStorage.setItem("state",t)}catch(t){console.log(t)}})({task:s.getState().task,crowd:s.getState().crowd})}),1e3),{...s,runSaga:()=>e.run(A)}}();Qr.runSaga(),r.a.render(Object(V.jsx)(o.a,{store:Qr,children:Object(V.jsx)(d.a,{getUserConfirmation:(e,t)=>{t(window.confirm(e))},children:Object(V.jsxs)(h.a,{children:[Object(V.jsx)(u.a,{path:"/worker_interactive",component:wt}),Object(V.jsx)(u.a,{path:"/worker_category",component:rr}),Object(V.jsx)(u.a,{path:"/worker_sequence",component:mr}),Object(V.jsx)(u.a,{path:"/worker_quality",component:Or}),Object(V.jsx)(u.a,{path:"/chat",component:zr}),Object(V.jsx)(u.a,{path:"/",component:Za})]})})}),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const e="".concat("","/service-worker.js");c?(!function(e){fetch(e).then((t=>{404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):l(e)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):l(e)}))}}()},585:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return c}));var n=s(586),i=s.n(n);const a=(new Date).toDateString(),r=[{name:"blue",bg:"#0074d9"},{name:"navy",bg:"#001f3f"},{name:"lime",bg:"#01ff70"},{name:"teal",bg:"#39cccc"},{name:"olive",bg:"#3d9970"},{name:"fuchsia",bg:"#f012be"},{name:"red",bg:"#ff4136"},{name:"green",bg:"#2ecc40"},{name:"orange",bg:"#ff851b"},{name:"maroon",bg:"#85144b"},{name:"purple",bg:"#b10dc9"},{name:"yellow",bg:"#ffdc00"},{name:"aqua",bg:"#7fdbff"}],o={name:"grey",bg:"#aaaaaa"};function c(e){const t=i.a.create(a)(r.length);return{backgroundColor:(e<0?o:r[(t+e)%r.length]).bg,opacity:.3}}e.getColor=c}).call(this,s(124))},606:function(e,t,s){}},[[1221,1,2]]]);
//# sourceMappingURL=main.9823db51.chunk.js.map